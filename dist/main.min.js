(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"C:\\HACKUCSC\\src\\js\\entities\\ProgressBar.js":[function(require,module,exports){
//NOTE: DON'T USE this code to create a ProgressBar. Instead, use the UIBuilder object and call buildProgressBar

var ProgressBar = function(setType, setMaxValue, setGraphics, setRenderables) {
	this.type = setType; //Two types, "growing" (starts at 0, triggers event when full) 
						 //and "shrinking" (starts full, triggers at 0)
	this.bgBorderSize = 2;			//default size of background border
	this.bgBorderColor = 0xAAAAAA;	//default color of background border
	this.bgColor = 0x888888;		//default color of background
	this.paddingHoriz = 5;			//default sum of padding on left and right side inner value bar
	this.paddingVert = 5;			//default sum (i.e. half on each side) of vertical padding of inner value bar
	this.valueBorderSize = 1;		//default size of value border
	this.valueBorderColor = 0x8888FF; //default color of value border
	this.valueColor = 0x000099;		//default color of inner value bar
	this.x = null;
	this.y = null;
	this.width = null;
	this.height = null;
	this.maxValue = setMaxValue;
	this.graphics = setGraphics; //store graphics class (used to draw bar)
	this.renderables = setRenderables;
	
	this.onEvent = function() {}; //overwrite this function to make whatever you want happen when progressBar reaches limit
	
	//switch(this.type) {
	//case 'growing' : 
	if(setType === 'growing') {
		this.value = 0;
		//tryTrigger is called automatically when you add/subtract value, and will trigger the onEvent() function
		this.tryTrigger = function() {
			if(this.value >= this.maxValue) {
				this.onEvent();
			}
		};
		//break;
	}
	else if(setType === 'shrinking') {
	//case 'shrinking' :
		this.value = this.maxValue;
		this.tryTrigger = function() {
			if(this.value <= 0) {
				this.onEvent();
			}
		};
	}
};

ProgressBar.prototype.constructor = ProgressBar;

ProgressBar.prototype.destroy = function() {
	this.graphics.clear();
	this.renderables.unsubscribe(this);
};

//To subtract value, just use negative numbers as argument i.e. foo.addValue(-5);
ProgressBar.prototype.addValue = function (addThis) {
	this.value += addThis;
	if(this.value > this.maxValue) {
		this.value = this.maxValue;
	}
	if(this.value < 0) {
		this.value = 0;
	}
	this.tryTrigger();
};

//Sets the location where progress bar is rendered
ProgressBar.prototype.setLocation = function(setX, setY) {
	this.x = setX;
	this.y = setY;
};

//Sets the size of the progress bar
ProgressBar.prototype.setSize = function(setWidth, setHeight) {
	this.width = setWidth;
	this.height = setHeight;
};

ProgressBar.prototype.setStyle = function(bgBorderSize, bgBorderColor, bgColor, paddingHoriz, paddingVert, valueBorderSize, valueBorderColor, valueColor) {
	this.bgBorderSize = bgBorderSize;
	this.bgBorderColor = bgBorderColor;
	this.bgColor = bgColor;
	this.paddingHoriz = paddingHoriz;
	this.paddingVert = paddingVert;
	this.valueBorderSize = valueBorderSize;
	this.valueBorderColor = valueBorderColor;
	this.valueColor = valueColor;
};

//update for progress bar, called just before drawing progress bar
//Overwrite this function if desired
ProgressBar.prototype.update = function() {};

//Renders progressBar
ProgressBar.prototype.render = function() {
	this.update();
	this.graphics.clear();
	//Draw background of bar
	this.graphics.lineStyle(this.bgBorderSize, this.bgBorderColor, 1); //sets border color and size
	this.graphics.beginFill(this.bgColor); //sets color of background fill
	this.graphics.drawRect(this.x-this.width/2, this.y-this.height/2, this.width, this.height);
	this.graphics.endFill();
	//Draw value of bar
	var percentage = this.value / this.maxValue;
	var barWidth = this.width - this.paddingHoriz;
	var barHeight = this.height - this.paddingVert;
	this.graphics.lineStyle(this.valueBorderSize, this.valueBorderColor, 1);
	this.graphics.beginFill(this.valueColor);
	this.graphics.drawRect(this.x-(barWidth/2), this.y-(barHeight/2), barWidth*percentage, barHeight);
	this.graphics.endFill();
};

module.exports = ProgressBar;
},{}],"C:\\HACKUCSC\\src\\js\\entities\\background.js":[function(require,module,exports){
var Group_Manager = require('./groupManager');
var Person = require('./person');

var Background = function (game, baseX, baseY, hRatio, vRatio, income, type, state) {
    Phaser.Sprite.call(this, game, baseX * hRatio * game.width, baseY * vRatio * game.height, 'background');
    game.add.existing(this);
    this.baseX = baseX;
    this.baseY = baseY;
    this.hRatio = hRatio;
    this.vRatio = vRatio;
    this.newHRatio = hRatio;
    this.newVRatio = vRatio;
    this.minRatio = .1;
    this.group_manager = new Group_Manager(this.game, state);
	this.group_manager.background = this;
   	this.type = type;
    this.incomeLevel = income;
	this.state = state
};

Background.prototype = Object.create(Phaser.Sprite.prototype);
Background.prototype.constructor = Background;

Background.prototype.getVars = function() {
    //return x & y and width & height of visible
    console.log('this.hRatio: ' + this.hRatio);
    return [this.x, this.y, this.hRatio * this.game.width, this.vRatio * this.game.height];
};

Background.prototype.getVarsCenter = function() {
    // //return x & y of center and width & height of visible
    var visWidth = this.hRatio * this.game.width;
    var visHeight = this.vRatio * this.game.height;
    return {width : visWidth, height : visHeight, center : {x : this.x + visWidth / 2, y : this.y + visHeight / 2}};
};

Background.prototype.numPeople = function() {
    var num = this.group_manager.numPeople();
    if (num === 0) return 1;
    else return num;
};

Background.prototype.update = function() {
	if (this.newHRatio < this.minRatio) this.newHRatio = this.minRatio;
    if (this.newVRatio < this.minRatio) this.newVRatio = this.minRatio;
    if (this.hRatio !== this.newHRatio) {
        if (this.hRatio + .01 < this.newHRatio) this.hRatio += .01;
        else if (this.hRatio - .01 > this.newHRatio) this.hRatio -= .01;
        else this.hRatio = this.newHRatio;
    }
    if (this.vRatio !== this.newVRatio) {
        if (this.vRatio + .01 < this.newVRatio) this.vRatio += .01;
        else if (this.vRatio - .01 > this.newVRatio) this.vRatio -= .01;
        else this.vRatio = this.newVRatio;
    }
    if (this.type === 'unemployed')
        this.hRatio = 1;
    this.group_manager.update();
};



module.exports = Background;
},{"./groupManager":"C:\\HACKUCSC\\src\\js\\entities\\groupManager.js","./person":"C:\\HACKUCSC\\src\\js\\entities\\person.js"}],"C:\\HACKUCSC\\src\\js\\entities\\background_manager.js":[function(require,module,exports){
//Controls background elements

var Background = require('./background');
var Person = require('./person');
var util = require('../utils');

var Group = require('./group');

var Background_Manager = function(game, state) {
	this.game = game;
	this.state = state;
	//Create array of backgrounds
	this.bgArray = [
		new Background(this.game, 0, 0, .33, .33, Person.EDULEVEL.low , 'work' , state),	// this.bgArray[0] == workLow
		new Background(this.game, 1, 0, .33, .33, Person.EDULEVEL.mid , 'work' , state),	// this.bgArray[1] == workMid
		new Background(this.game, 2, 0, .33, .33, Person.EDULEVEL.high, 'work' , state),	// this.bgArray[2] == workMid
		new Background(this.game, 0, 1, .33, .33, Person.EDULEVEL.low , 'house', state),	// this.bgArray[3] == houseLow
		new Background(this.game, 1, 1, .33, .33, Person.EDULEVEL.mid , 'house', state),	// this.bgArray[4] == houseMid
		new Background(this.game, 2, 1, .33, .33, Person.EDULEVEL.high, 'house', state),	// this.bgArray[5] == houseMid
		new Background(this.game, 0, 2,   1, .33, '',              'unemployed', state)		// this.bgArray[6] == unemployed
	];
	for (bg in this.bgArray) {
		this.bgArray[bg].myManager = this;
	}
	
	for (var i in this.bgArray) {
		if (this.bgArray[i].type == 'work') {
			if (this.bgArray[i].incomeLevel === Person.EDULEVEL.low) {
				this.bgArray[i].tint = 0xe2402b;
			}
			else if (this.bgArray[i].incomeLevel === Person.EDULEVEL.mid) {
				this.bgArray[i].tint = 0x56e22b;
			}
			else if (this.bgArray[i].incomeLevel === Person.EDULEVEL.high) {
				this.bgArray[i].tint = 0x2b59e2;
			}
		}
		else if (this.bgArray[i].type == 'house') {
			if (this.bgArray[i].incomeLevel === Person.EDULEVEL.low) {
				this.bgArray[i].tint = 0xe55340;
			}
			else if (this.bgArray[i].incomeLevel === Person.EDULEVEL.mid) {
				this.bgArray[i].tint = 0x6ae246;
			}
			else if (this.bgArray[i].incomeLevel === Person.EDULEVEL.high) {
				this.bgArray[i].tint = 0x5476dd;
			}
		}
		else { // Unemployed background
			this.bgArray[i].tint = 0x939393;
		}
	}
	
	var test = this.bgArray[6].group_manager;
	var testFlock = new Group(this.game, this.game.width / 2 + 100, this.game.height / 2 + 100, state);
    for (var i = 0; i < 10; i++) {
    	var testPerson = new Person(this.game, this.game.width / 2 + i * 15, this.game.height / 2 + i * 15, i);
    	this.game.add.existing(testPerson);
    	testFlock.addMember(testPerson);
    }
    test.addMember(testFlock);
	// testFlock = new Group(this.game, this.game.width / 2 - 100, this.game.height / 2 + 100, state);
	// for (var i = 0; i < 10; i++) {
    	// var testPerson = new Person(this.game, this.game.width / 2 + i * 15 - 100, this.game.height / 2 + i * 15 + 100, i);
    	// this.game.add.existing(testPerson);
    	// testFlock.addMember(testPerson);
    // }
    // test.addMember(testFlock);
};

Background_Manager.prototype.constructor = Background_Manager;

/*Background_Manager.BGNAMES = {
		workLow    : this.bgArray[0],
		workMid    : this.bgArray[1],
		workHigh   : this.bgArray[2],
		houseLow   : this.bgArray[3],
		houseMid   : this.bgArray[4],
		houseHigh  : this.bgArray[5],
		unemployed : this.bgArray[6]
};*/

Background_Manager.prototype.sendTo = function(source, destination, group) {
	// console.log(destination);
	if (destination === null) {
		console.log('sadasasdhasdjhadjkad')
		return;
	}
	var transType = this.transferType(source, destination, group)
	if (transType.can) {	// Check if they can transfer up
		source.group_manager.transfer(destination.group_manager, group);
		if (transType.educate) {
			group.startEducation();
		}
		this.updateRatios(destination);
		var test = destination.getVarsCenter();
		// console.log(test);
	}
};
Background_Manager.prototype.numPeople = function() {
	var count = 0;
	for (var i in this.bgArray) {
		count += this.bgArray[i].group_manager.numPeople();
	}
	return count;
};
Background_Manager.prototype.transferType = function(source, destination, group) {
	var groupEdu = group.members[0].eduLevel;
	var can = this.canTransfer(source, destination, group);
	// console.log(destination);
	// console.log(destination.type, destination.incomeLevel);
	var educate = (destination.type === 'house' && destination.incomeLevel) > groupEdu;
	return {can : can, educate : educate};
};
Background_Manager.prototype.canTransfer = function(source, destination, group) {
	// console.log(source, destination, group);
	if (source === null || destination === null) return false;
	var sourceEdu = group.members[0].eduLevel;
	if (destination.type === 'unemployed') {
		return true;
	}
	if (sourceEdu === Person.EDULEVEL.unemployed) {
		if (destination.incomeLevel === Person.EDULEVEL.low && destination.type === 'house') {
			return true;
		}
	} else if (sourceEdu === Person.EDULEVEL.low) {
		if (destination.incomeLevel === Person.EDULEVEL.low) {
			return true;
		} else if (destination.incomeLevel === Person.EDULEVEL.mid) {
			if (destination.type === 'house') {
				return true;
			}
		}
	} else if (sourceEdu === Person.EDULEVEL.mid) {
		if (destination.incomeLevel === Person.EDULEVEL.low) {
			return true;
		} else if (destination.incomeLevel === Person.EDULEVEL.mid) {
			return true;
		} else if (destination.incomeLevel === Person.EDULEVEL.high) {
			if (destination.type === 'house') {
				return true;
			}
		}
	} else if (sourceEdu === Person.EDULEVEL.high) {
		return true;
	}
	return false;
};

Background_Manager.prototype.whereClicked = function() {
	for (var i in this.bgArray) {
		var curDimensions = this.bgArray[i].getVars();
		var mouseX = this.game.input.x;
		var mouseY = this.game.input.y;
		if(i == 6) console.log('curDimensions: ' + curDimensions);
		if (mouseX > curDimensions[0] && mouseX <= curDimensions[0] + curDimensions[2]) {
			if (mouseY > curDimensions[1] && mouseY <= curDimensions[1] + curDimensions[3]) {
				return this.bgArray[i];
			}
		}
	}
	return null;
};

Background_Manager.prototype.findOther = function(source, destination) {
	if (source.type === 'work' && destination.type === 'work') {
		if (source.incomeLevel === Person.EDULEVEL.low) {
			if (destination.incomeLevel === Person.EDULEVEL.mid) return this.bgArray[2];
			else if (destination.incomeLevel === Person.EDULEVEL.high) return this.bgArray[1];
		}
		else if (source.incomeLevel === Person.EDULEVEL.mid) {
			if (destination.incomeLevel === Person.EDULEVEL.low) return this.bgArray[2];
			else if (destination.incomeLevel === Person.EDULEVEL.high) return this.bgArray[0];
		}
		else if (source.incomeLevel === Person.EDULEVEL.high) {
			if (destination.incomeLevel === Person.EDULEVEL.low) return this.bgArray[1];
			else if (destination.incomeLevel === Person.EDULEVEL.mid) return this.bgArray[0];
		}
	}
	else if (source.type === 'house' && destination.type === 'house') {
		if (source.incomeLevel === Person.EDULEVEL.low) {
			if (destination.incomeLevel === Person.EDULEVEL.mid) return this.bgArray[5];
			else if (destination.incomeLevel === Person.EDULEVEL.high) return this.bgArray[4];
		}
		else if (source.incomeLevel === Person.EDULEVEL.mid) {
			if (destination.incomeLevel === Person.EDULEVEL.low) return this.bgArray[5];
			else if (destination.incomeLevel === Person.EDULEVEL.high) return this.bgArray[3];
		}
		else if (source.incomeLevel === Person.EDULEVEL.high) {
			if (destination.incomeLevel === Person.EDULEVEL.low) return this.bgArray[4];
			else if (destination.incomeLevel === Person.EDULEVEL.mid) return this.bgArray[3];
		}
	}
};

Background_Manager.prototype.updateRatios = function(destination) {
	if (destination.type === 'work') {
		var hRatios = util.ratio(this.bgArray[0].numPeople(), this.bgArray[1].numPeople(), this.bgArray[2].numPeople());
	}
	else{
		var hRatios = util.ratio(this.bgArray[3].numPeople(), this.bgArray[4].numPeople(), this.bgArray[5].numPeople());
	}
	var employed = 0;
	for (var j = 0; j < 6; j++)
		employed += this.bgArray[j].numPeople();
	var vRatios = util.ratio(this.bgArray[6].numPeople(), employed);
	for (var i = 0 in this.bgArray) {
		if (i !== 6) {		// If not unemployed bg
			if (i < 3) {	// If work bg
				this.bgArray[i].newHRatio = hRatios[i];
				this.bgArray[i].newVRatio = vRatios[1] / 2;
			}
			else {			// If house bg
				this.bgArray[i].newHRatio = hRatios[i - 3];
				this.bgArray[i].newVRatio = vRatios[1] / 2;
			}
		}
		else bgArray[i].newVRatio = vRatios[0]; // Unemployed bg
	}
	console.log(this.bgArray[0].hRatio);
	console.log(this.bgArray[3].hRatio);
	console.log(this.bgArray[6].minRatio);
};

Background_Manager.prototype.update = function() {
	for (var i in this.bgArray) {
    	if (this.bgArray[i].incomeLevel === Person.EDULEVEL.mid) {
    		this.bgArray[i].x = this.bgArray[0].getVars()[2];
    	}
    	else if (this.bgArray[i].incomeLevel === Person.EDULEVEL.high) {
    	    this.bgArray[i].x = this.bgArray[1].getVars()[0] + this.bgArray[1].getVars()[2];
    	}
    	this.bgArray[i].y = this.bgArray[i].baseY * this.bgArray[i].vRatio * this.game.height;
		this.bgArray[i].update();
	}
	var test = this.bgArray[3].getVarsCenter();
	// console.log(test.center.x, test.center.y);
	// console.log(this.bgArray[3].group_manager.center);
};

module.exports = Background_Manager;
},{"../utils":"C:\\HACKUCSC\\src\\js\\utils.js","./background":"C:\\HACKUCSC\\src\\js\\entities\\background.js","./group":"C:\\HACKUCSC\\src\\js\\entities\\group.js","./person":"C:\\HACKUCSC\\src\\js\\entities\\person.js"}],"C:\\HACKUCSC\\src\\js\\entities\\group.js":[function(require,module,exports){
//controls flocking for a group of person objects
var util = require('../utils');

var Group = function (game, centerX, centerY, state) {
	this.game = game;
	this.members = [];
	this.minDist = 20;
	//this.noise = 10;
	this.center = {x : centerX, y : centerY};
	this.clickDist = 50;
	this.selected = false;
	this.selection = this.game.add.sprite(this.center.x, this.center.y, 'selection');
	this.selection.anchor.setTo(0.5, 0.5);
	this.selection.width = 100;
	this.selection.height = 100;
	this.selection.visible = false;
	this.velocity = {x : 0, y : 0};
	this.speed = .05;
	this.state = state;
	this.book = this.game.add.sprite(this.center.x, this.center.y, 'book');
	this.book.anchor.setTo(0.5, 0.5);
	this.book.width = 25;
	this.book.height = 25;
	this.book.visible = false;
	this.learningTime = .01;
	
	this.state.input.onDown.add(this.onInputDown, this);
}
Group.prototype.constructor = Group;
Group.prototype.update = function() {
	// console.log(this.center);
	//update center
	var newX = this.center.x + this.velocity.x * this.speed;
	var newY = this.center.y + this.velocity.y * this.speed;
	this.changeCenter({x : newX, y : newY});
	for (var member in this.members) {
		member = this.members[member];
		var velocity = {x:0, y:0};
		var diff = {x:0, y:0};
		diff.x = this.center.x - member.x;
		diff.y = this.center.y - member.y;
		velocity.x += diff.x;
		velocity.y += diff.y;
		for (var other in this.members) {
			other = this.members[other];
			//ignore self
			if (other === member) {
				continue;
			}
			var oDiff = {x:0, y:0};
			oDiff.x = other.x - member.x;
			oDiff.y = other.y - member.y;
			var totalDist = util.hypotenuse(oDiff.x, oDiff.y);
			if (totalDist <= this.minDist) {
				velocity.x = -1 * oDiff.x;
				velocity.y = -1 * oDiff.y;
				// velocity.x -= oDiff.x;
				// velocity.y -= oDiff.y;
				break;
			}
		}
		// if (util.hypotenuse(velocity.x, velocity.y) < this.minVelocity) {
			// velocity.x = velocity.y = 0;
		// }
		member.velocity = velocity;
	}
};
Group.prototype.addMember = function(member) {
	this.members.push(member);
	member.group = this;
};
Group.prototype.onInputDown = function() {
	// console.log('a');
	if (this.selected) {
		// console.log('c');
		// console.log(this.myManager, this.myManager.background);
		var bg = this.myManager.background.myManager.whereClicked();
		// console.log(bg);
		this.myManager.background.myManager.sendTo(this.myManager.background, bg, this);
		this.setSelected(false);
	} else if (this.clicked()) {
		this.click();
	}
};
Group.prototype.startEducation = function() {
	this.learning = false;
	this.book.visible = true;
	this.state.game.time.events.add(Phaser.Timer.SECOND * this.learningTime, this.endEducation, this);
};
Group.prototype.endEducation = function() {
	for (var member in this.members) {
		this.members[member].eduLevel += 1;
	}
	this.learning = false;
	this.book.visible = false;
};
Group.prototype.clicked = function() {
	var mouseX = this.game.input.x;
	var mouseY = this.game.input.y;
	var diffX = mouseX - this.center.x;
	var diffY = mouseY - this.center.y;
	var totalDiff = util.hypotenuse(diffX, diffY);
	if (totalDiff <= this.clickDist) {
		return true;
	}
	return false;
};
Group.prototype.click = function() {
	if (this.selected) {
		this.setSelected(false);
	} else {
		this.setSelected(true);
	}
};
Group.prototype.move = function() {
	var mouseX = this.game.input.x;
	var mouseY = this.game.input.y;
	this.changeCenter({x : mouseX, y : mouseY});
	this.setSelected(false);
	// console.log({x : mouseX, y : mouseY});s
};
Group.prototype.setSelected = function(newSelected) {
	this.selected = newSelected;
	this.selection.visible = newSelected;
};
Group.prototype.changeCenter = function(newCenter) {
	this.selection.x = newCenter.x;
	this.selection.y = newCenter.y;
	this.book.x = newCenter.x;
	this.book.y = newCenter.y;
	this.center = newCenter;
};
Group.prototype.numPeople = function() {
	return this.members.length;
};
Group.prototype.mouseDown = function() {
	
};

module.exports = Group;













},{"../utils":"C:\\HACKUCSC\\src\\js\\utils.js"}],"C:\\HACKUCSC\\src\\js\\entities\\groupManager.js":[function(require,module,exports){
var Util = require('../utils');

var GroupManager = function (game) {
	this.game = game;
	this.members = [];
	/*
	this.bound = {
		upper : center.y - height / 2,
		lower : center.y + height / 2,
		left : center.x - width / 2,
		right : center.x + width / 2
	};
	this.width = width;
	this.height = height;
	this.center = center;
	this.minDist = width / 2;
	*/
	/*
	Phaser.Sprite.call(this, game, x, y, 'person');
	this.velocity = {x:0, y:0};
	this.width = 10;
	this.height = 10;
	this.speed = .05;
	this.id = id;
	*/
};
GroupManager.prototype.constructor = GroupManager;
GroupManager.prototype.update = function() {
	// console.log(this.center);
	//update bounds
	if (this.background) {
		var vars = this.background.getVarsCenter();
		this.width = vars.width;
		this.height = vars.height;
		this.center = vars.center;
		// console.log(vars);
	} else {
		return;
	}
	//update member velocity
	for (var member in this.members) {
		member = this.members[member];
		var velocity = {x : 0, y : 0};
		// console.log(this.center, member.center);
		var diffX = this.center.x - member.center.x;
		var diffY = this.center.y - member.center.y;
		velocity.x = diffX;
		velocity.y = diffY;
		for (var other in this.members) {
			other = this.members[other];
			if (other === member) {
				continue;
			}
			var oDiffx = other.center.x - member.center.x;
			var oDiffy = other.center.y - member.center.y;
			var hyp = Util.hypotenuse(oDiffx, oDiffy);
			//console.log(hyp);
			if (hyp <= this.minDist) {
				// console.log('b', hyp);
				velocity.x = -1 * oDiffx;
				velocity.y = -1 * oDiffy;
				break;
			} else {
				// console.log('a');
			}
		}
		member.velocity = velocity;
	}
	//update members
	for (member in this.members) {
		this.members[member].update();
	}
};
GroupManager.prototype.transfer = function(otherGM, myMember) {
	var testVals = otherGM.background.getVarsCenter();
	// console.log('transfer to', otherGM.background.type, otherGM.background.incomeLevel, testVals.center.y, testVals.y, testVals.visHeight, testVals.vRatio);
	/*
	if (!(myMember in this.members)) {
		console.log('ERROR', myMember, 'not in', this);
		return;
	}
	*/
	var index = this.members.indexOf(myMember);
	this.members.splice(index, 1);
	otherGM.addMember(myMember);
};
GroupManager.prototype.addMember = function(member) {
	this.members.push(member);
	member.myManager = this;
	var smaller = (this.width < this.height) ? this.width : this.height;
	this.minDist = smaller / this.members.length;
	// console.log(this.minDist);
};
GroupManager.prototype.numPeople = function() {
	var count = 0;
	for (var member in this.members) {
		member = this.members[member];
		count += member.numPeople();
	}
	return count;
};

module.exports = GroupManager;












},{"../utils":"C:\\HACKUCSC\\src\\js\\utils.js"}],"C:\\HACKUCSC\\src\\js\\entities\\person.js":[function(require,module,exports){
var Person = function (game, x, y, id) {
	Phaser.Sprite.call(this, game, x, y, 'person');
	this.velocity = {x:0, y:0};
	this.width = 10;
	this.height = 10;
	this.speed = .05;
	this.id = id;
	this.eduLevel = Person.EDULEVEL.unemployed;
	this.happiness = 100;
};
Person.prototype = Object.create(Phaser.Sprite.prototype);
Person.prototype.constructor = Person;

Person.EDULEVEL = {
	unemployed : -1,
	low  : 0,
	mid  : 1,
	high : 2
};

Person.prototype.update = function() {
	this.x += this.velocity.x * this.speed;
	this.y += this.velocity.y * this.speed;
	//console.log(this.velocity);
};
//TODO adjust tax by tax rate and happiness
Person.prototype.getTax = function() {
	// console.log('get tax', this.group.myManager.background.type);
	if (this.group.myManager.background.type === 'house') {
		if (this.group.myManager.background.incomeLevel === Person.EDULEVEL.low) {
			return -1;
		} else if (this.group.myManager.background.incomeLevel === Person.EDULEVEL.mid) {
			return -2;
		} else if (this.group.myManager.background.incomeLevel === Person.EDULEVEL.high) {
			return -3;
		}
	} else if (this.group.myManager.background.type === 'work') {
		if (this.group.myManager.background.incomeLevel === Person.EDULEVEL.low) {
			return 1;
		} else if (this.group.myManager.background.incomeLevel === Person.EDULEVEL.mid) {
			return 2;
		} else if (this.group.myManager.background.incomeLevel === Person.EDULEVEL.high) {
			return 3;
		}
	}
	return 0;
};

module.exports = Person;
},{}],"C:\\HACKUCSC\\src\\js\\entities\\player.js":[function(require,module,exports){
var Player = function (game, x, y) {
    Phaser.Sprite.call(this, game, x, y, 'testsprite');
    game.add.existing(this);
	this.speed = 0.1;
}

Player.prototype = Object.create(Phaser.Sprite.prototype);
Player.prototype.constructor = Player;

/**
 * Automatically called by World.update
 */
Player.prototype.update = function() {
	//this.x += this.velocity;
};

module.exports = Player;

},{}],"C:\\HACKUCSC\\src\\js\\entities\\uiBuilder.js":[function(require,module,exports){
var ProgressBar = require('./ProgressBar');

var UIBuilder = function(setGameState) {
	//Ensure that cannot create multiple instances of this class
	if(UIBuilder.prototype.exists) {
		return UIBuilder.prototype.existingReference;
	}
	
	this.gameState = setGameState;
	this.renderables = [];
	//Create and store a graphics object (used for stuff like drawing rectangles)
	UIBuilder.prototype.exists = true;
	UIBuilder.prototype.existingReference = this;
};

UIBuilder.prototype.constructor = UIBuilder;
//These var's help create the singleton functionality
UIBuilder.prototype.exists = false;
UIBuilder.prototype.existingReference = null;

//Use this function to create a progress bar
//Usage: type: can be "growing" or "shrinking", this will effect if bar starts at 0 and goes up or vis versa
//		 maxValue: sets the max value of the progress bar, i.e. using 100 creates a bar from 0 to 100
//		 x,y: sets location
//		 DON'T FORGET to overwrite the onEvent() function for the progress bar after creating it
//			-onEvent() is automatically called when bar fills/shrinks past limit (depending on bar type)
UIBuilder.prototype.buildProgressBar = function(type, x, y, width, height, maxValue) {
	//create and format new prog bar
	var graphics = this.gameState.game.add.graphics(0,0);
	var newProgBar = new ProgressBar(type, maxValue, graphics, this.renderables);
	newProgBar.setLocation(x,y);
	newProgBar.setSize(width, height);
	//subscribe to 'renderables' so that render() is called automatically
	// this.renderables.subscribe(newProgBar);
	this.renderables.push(newProgBar);
	return newProgBar;
};
UIBuilder.prototype.render = function() {
	for (renderable in this.renderables) {
		this.renderables[renderable].render();
	}
};

module.exports = UIBuilder;
},{"./ProgressBar":"C:\\HACKUCSC\\src\\js\\entities\\ProgressBar.js"}],"C:\\HACKUCSC\\src\\js\\main.js":[function(require,module,exports){
'use strict';

var game = new Phaser.Game(800, 600, Phaser.AUTO, '-game');

window.Utils = require('./utils');
window.playerState = {
    currentLevel: 'Game'
}

game.state.add('Boot', require('./states/boot'));
game.state.add('Splash', require('./states/splash'));
game.state.add('Preloader', require('./states/preloader'));
game.state.add('Menu', require('./states/menu'));
game.state.add('Game', require('./states/game'));

game.state.start('Boot');

//game.stage.backgroundColor = "#ffffff";

},{"./states/boot":"C:\\HACKUCSC\\src\\js\\states\\boot.js","./states/game":"C:\\HACKUCSC\\src\\js\\states\\game.js","./states/menu":"C:\\HACKUCSC\\src\\js\\states\\menu.js","./states/preloader":"C:\\HACKUCSC\\src\\js\\states\\preloader.js","./states/splash":"C:\\HACKUCSC\\src\\js\\states\\splash.js","./utils":"C:\\HACKUCSC\\src\\js\\utils.js"}],"C:\\HACKUCSC\\src\\js\\states\\boot.js":[function(require,module,exports){
var Boot = function () {};

module.exports = Boot;

Boot.prototype = {

  preload: function () {
    this.load.image('preloader', 'assets/preloader.gif');
  },

  create: function () {
    this.game.input.maxPointers = 1;

    if (this.game.device.desktop) {
      this.game.stage.scale.pageAlignHorizontally = true;
    } else {
      this.game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;
      this.game.scale.minWidth =  480;
      this.game.scale.minHeight = 260;
      this.game.scale.maxWidth = 640;
      this.game.scale.maxHeight = 480;
      this.game.scale.forceLandscape = true;
      this.game.scale.pageAlignHorizontally = true;
      this.game.scale.setScreenSize(true);
    }

    this.game.state.start('Preloader');
  }
};

},{}],"C:\\HACKUCSC\\src\\js\\states\\game.js":[function(require,module,exports){
var Player = require('../entities/player');
var Background_Manager = require('../entities/background_manager');
var Person = require('../entities/person');
var Group = require('../entities/group');
var GroupManager = require('../entities/groupManager');
var UIBuilder = require('../entities/uiBuilder');

var Game = function () {
  this.testentity = null;
  //this.flocks = [];
  this.bg_mg = null;
  // this.selectedGroup = null;
  this.money = null;
  this.moneyVal = 0;
  this.curMoney = 0;
  this.moneyUpdateDelay = 0.001;
  this.moneyIncrementing = false;
  this.happinessVal = 0;
  this.curHappiness = 0;
  this.happinessUpdateDelay = 0.001;
  this.happinessIncrementing = false;
  this.taxTime = 3;
};

module.exports = Game;

Game.prototype = {

  create: function () {
	  // console.log(this);
	this.game.stage.backgroundColor = "#ffffff";
	  
    var x = (this.game.width / 2) - 100;
    var y = (this.game.height / 2) - 50;

    this.bg_mg = new Background_Manager(this.game, this);
	
    this.input.onDown.add(this.onInputDown, this);
	
	this.money = this.game.add.text(10, 10, '$0');
	this.money.font = 'VT323';
	this.money.fontSize = 24;
	this.money.fill = '#ffffff';
    this.money.setShadow(3, 3, 'rgba(0,0,0,0.5)', 5);
	
	this.uib = new UIBuilder(this);
	this.bar = this.uib.buildProgressBar("growing", this.game.width / 2, 25, 300, 25, 100);
	//this.bar.addValue(100);
	this.happy = this.game.add.sprite(this.game.width * .73, 25, 'happyface');
	this.happy.width = 40;
	this.happy.height = 40;
	this.happy.anchor.setTo(0.5, 0.5);
	
	this.game.time.events.add(Phaser.Timer.SECOND * this.taxTime, this.collectTax, this);
  },

  update: function () {
	this.bg_mg.update();
	//this.gm.update();
	this.uib.render();
	var happiness = 0;
	  for (var bg in this.bg_mg.bgArray) {
		  for (var group in this.bg_mg.bgArray[bg].group_manager.members) {
			  for (var person in this.bg_mg.bgArray[bg].group_manager.members[group].members) {
				  happiness += this.bg_mg.bgArray[bg].group_manager.members[group].members[person].happiness;
			  }
		  }
	  }
	  happiness /= this.bg_mg.numPeople();
	  // console.log(happiness);
	  this.setHappiness(happiness);
  },

  onInputDown: function () {
	 // console.log(this.game.width, this.game.height);
  },
  collectTax: function () {
	  // console.log('collect tax');
	  var taxes = 0;
	  for (var bg in this.bg_mg.bgArray) {
		  for (var group in this.bg_mg.bgArray[bg].group_manager.members) {
			  for (var person in this.bg_mg.bgArray[bg].group_manager.members[group].members) {
				  taxes += this.bg_mg.bgArray[bg].group_manager.members[group].members[person].getTax();
			  }
		  }
	  }
	  this.addMoney(taxes);
	  this.game.time.events.add(Phaser.Timer.SECOND * this.taxTime, this.collectTax, this);
  },
  setHappiness: function (amt) {
	  this.curHappiness = amt;
	  if (!this.happinessIncrementing) {
		  this.game.time.events.add(Phaser.Timer.SECOND * this.happinessUpdateDelay, this.incrementHappiness, this);
		  this.happinessIncrementing = true;
	  }
  },
  incrementHappiness: function () {
	if (this.happinessVal === this.curHappiness) {
		this.happinessIncrementing = false;
		return;
	}
	if (this.curHappiness > this.happinessVal) {
		this.bar.addValue(1);
		this.happinessVal += 1;
	} else if (this.curHappiness < this.happinessVal) {
		this.bar.addValue(-1);
		this.happinessVal -= 1;
	}
	this.game.time.events.add(Phaser.Timer.SECOND * this.happinessUpdateDelay, this.incrementHappiness, this);
  },
  addMoney: function (amt) {
	  this.curMoney += amt;
	  //this.money.text = '$' + newMoney;
	  if (!this.moneyIncrementing) {
		this.game.time.events.add(Phaser.Timer.SECOND * this.moneyUpdateDelay, this.incrementMoney, this);
		this.moneyIncrementing = true;
	  }
  },
  incrementMoney: function () {
	if (this.moneyVal === this.curMoney) {
		this.moneyIncrementing = false;
		return;
	}
	if (this.curMoney > this.moneyVal) {
		this.moneyVal += 1;
	} else if (this.curMoney < this.moneyVal) {
		this.moneyVal -= 1;
	}
	this.money.text = '$' + this.moneyVal;
	this.game.time.events.add(Phaser.Timer.SECOND * this.moneyUpdateDelay, this.incrementMoney, this);
  }
};














},{"../entities/background_manager":"C:\\HACKUCSC\\src\\js\\entities\\background_manager.js","../entities/group":"C:\\HACKUCSC\\src\\js\\entities\\group.js","../entities/groupManager":"C:\\HACKUCSC\\src\\js\\entities\\groupManager.js","../entities/person":"C:\\HACKUCSC\\src\\js\\entities\\person.js","../entities/player":"C:\\HACKUCSC\\src\\js\\entities\\player.js","../entities/uiBuilder":"C:\\HACKUCSC\\src\\js\\entities\\uiBuilder.js"}],"C:\\HACKUCSC\\src\\js\\states\\menu.js":[function(require,module,exports){
var Menu = function () {
  this.text = null;
};

module.exports = Menu;

Menu.prototype = {

  create: function () {
    var x = this.game.width / 2;
    var y = this.game.height / 2;

    var style = { font: "65px Arial", fill: "#ffffff", align: "center" };

    this.text = this.add.text(x - 300, y - 200, "Press to Start", style);

    this.input.onDown.add(this.onDown, this);
  },

  update: function () {
  },

  onDown: function () {
    this.game.state.start(playerState.currentLevel);
  }
};

},{}],"C:\\HACKUCSC\\src\\js\\states\\preloader.js":[function(require,module,exports){
var Preloader = function (game) {
  this.asset = null;
  this.ready = false;
};

module.exports = Preloader;

Preloader.prototype = {

  preload: function () {
    this.asset = this.add.sprite(320, 240, 'preloader');
    this.asset.anchor.setTo(0.5, 0.5);

    this.load.onLoadComplete.addOnce(this.onLoadComplete, this);
    this.load.setPreloadSprite(this.asset);
    this.load.image('testsprite', 'assets/test.png');
    this.load.image('background', 'assets/sectorBG.png')
    this.load.image('person', 'assets/person.png');
    this.load.image('selection', 'assets/selection.png');
    this.load.image('book', 'assets/book.png');
    // this.load.image('happyface', 'assets/happyface.png');
    // this.load.image('sadface', 'assets/sadface.png');
	this.load.image('happyface', 'assets/happyface_better.png');
	this.load.script('webfont', '//ajax.googleapis.com/ajax/libs/webfont/1.4.7/webfont.js');
  },

  create: function () {
    this.asset.cropEnabled = false;
  },

  update: function () {
    if (!!this.ready) {
      this.game.state.start('Game');
    }
  },

  onLoadComplete: function () {
    this.ready = true;
  }
};

},{}],"C:\\HACKUCSC\\src\\js\\states\\splash.js":[function(require,module,exports){
var Splash = function () {
};

module.exports = Splash;

Splash.prototype = {
  create: function () {
  }
};
},{}],"C:\\HACKUCSC\\src\\js\\utils.js":[function(require,module,exports){
var Utils = {
    containsObject: function(obj, list) {
        var i;
        for (i = 0; i < list.length; i++) {
            if (list[i] === obj) {
                return true;
            }
        }

        return false;
    },
	hypotenuse: function(a, b) {
		return Math.sqrt(Math.pow(a, 2) + Math.pow(b, 2));
	},
	ratio: function(a, b, c) {
		if (arguments.length === 1) {
			return [a / a];
		}
		else if (arguments.length === 2) {
			return [a / (a + b), b / (a + b)];
		}
		else if (arguments.length === 3) {
			return [a / (a + b + c), b / (a + b + c), c / (a + b + c)];
		}
		else {
			return [];
		}
	}
};


module.exports = Utils;
},{}]},{},["C:\\HACKUCSC\\src\\js\\main.js"])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvZW50aXRpZXMvUHJvZ3Jlc3NCYXIuanMiLCJzcmMvanMvZW50aXRpZXMvYmFja2dyb3VuZC5qcyIsInNyYy9qcy9lbnRpdGllcy9iYWNrZ3JvdW5kX21hbmFnZXIuanMiLCJzcmMvanMvZW50aXRpZXMvZ3JvdXAuanMiLCJzcmMvanMvZW50aXRpZXMvZ3JvdXBNYW5hZ2VyLmpzIiwic3JjL2pzL2VudGl0aWVzL3BlcnNvbi5qcyIsInNyYy9qcy9lbnRpdGllcy9wbGF5ZXIuanMiLCJzcmMvanMvZW50aXRpZXMvdWlCdWlsZGVyLmpzIiwic3JjL2pzL21haW4uanMiLCJzcmMvanMvc3RhdGVzL2Jvb3QuanMiLCJzcmMvanMvc3RhdGVzL2dhbWUuanMiLCJzcmMvanMvc3RhdGVzL21lbnUuanMiLCJzcmMvanMvc3RhdGVzL3ByZWxvYWRlci5qcyIsInNyYy9qcy9zdGF0ZXMvc3BsYXNoLmpzIiwic3JjL2pzL3V0aWxzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0dBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaFBBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4SkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLy9OT1RFOiBET04nVCBVU0UgdGhpcyBjb2RlIHRvIGNyZWF0ZSBhIFByb2dyZXNzQmFyLiBJbnN0ZWFkLCB1c2UgdGhlIFVJQnVpbGRlciBvYmplY3QgYW5kIGNhbGwgYnVpbGRQcm9ncmVzc0JhclxyXG5cclxudmFyIFByb2dyZXNzQmFyID0gZnVuY3Rpb24oc2V0VHlwZSwgc2V0TWF4VmFsdWUsIHNldEdyYXBoaWNzLCBzZXRSZW5kZXJhYmxlcykge1xyXG5cdHRoaXMudHlwZSA9IHNldFR5cGU7IC8vVHdvIHR5cGVzLCBcImdyb3dpbmdcIiAoc3RhcnRzIGF0IDAsIHRyaWdnZXJzIGV2ZW50IHdoZW4gZnVsbCkgXHJcblx0XHRcdFx0XHRcdCAvL2FuZCBcInNocmlua2luZ1wiIChzdGFydHMgZnVsbCwgdHJpZ2dlcnMgYXQgMClcclxuXHR0aGlzLmJnQm9yZGVyU2l6ZSA9IDI7XHRcdFx0Ly9kZWZhdWx0IHNpemUgb2YgYmFja2dyb3VuZCBib3JkZXJcclxuXHR0aGlzLmJnQm9yZGVyQ29sb3IgPSAweEFBQUFBQTtcdC8vZGVmYXVsdCBjb2xvciBvZiBiYWNrZ3JvdW5kIGJvcmRlclxyXG5cdHRoaXMuYmdDb2xvciA9IDB4ODg4ODg4O1x0XHQvL2RlZmF1bHQgY29sb3Igb2YgYmFja2dyb3VuZFxyXG5cdHRoaXMucGFkZGluZ0hvcml6ID0gNTtcdFx0XHQvL2RlZmF1bHQgc3VtIG9mIHBhZGRpbmcgb24gbGVmdCBhbmQgcmlnaHQgc2lkZSBpbm5lciB2YWx1ZSBiYXJcclxuXHR0aGlzLnBhZGRpbmdWZXJ0ID0gNTtcdFx0XHQvL2RlZmF1bHQgc3VtIChpLmUuIGhhbGYgb24gZWFjaCBzaWRlKSBvZiB2ZXJ0aWNhbCBwYWRkaW5nIG9mIGlubmVyIHZhbHVlIGJhclxyXG5cdHRoaXMudmFsdWVCb3JkZXJTaXplID0gMTtcdFx0Ly9kZWZhdWx0IHNpemUgb2YgdmFsdWUgYm9yZGVyXHJcblx0dGhpcy52YWx1ZUJvcmRlckNvbG9yID0gMHg4ODg4RkY7IC8vZGVmYXVsdCBjb2xvciBvZiB2YWx1ZSBib3JkZXJcclxuXHR0aGlzLnZhbHVlQ29sb3IgPSAweDAwMDA5OTtcdFx0Ly9kZWZhdWx0IGNvbG9yIG9mIGlubmVyIHZhbHVlIGJhclxyXG5cdHRoaXMueCA9IG51bGw7XHJcblx0dGhpcy55ID0gbnVsbDtcclxuXHR0aGlzLndpZHRoID0gbnVsbDtcclxuXHR0aGlzLmhlaWdodCA9IG51bGw7XHJcblx0dGhpcy5tYXhWYWx1ZSA9IHNldE1heFZhbHVlO1xyXG5cdHRoaXMuZ3JhcGhpY3MgPSBzZXRHcmFwaGljczsgLy9zdG9yZSBncmFwaGljcyBjbGFzcyAodXNlZCB0byBkcmF3IGJhcilcclxuXHR0aGlzLnJlbmRlcmFibGVzID0gc2V0UmVuZGVyYWJsZXM7XHJcblx0XHJcblx0dGhpcy5vbkV2ZW50ID0gZnVuY3Rpb24oKSB7fTsgLy9vdmVyd3JpdGUgdGhpcyBmdW5jdGlvbiB0byBtYWtlIHdoYXRldmVyIHlvdSB3YW50IGhhcHBlbiB3aGVuIHByb2dyZXNzQmFyIHJlYWNoZXMgbGltaXRcclxuXHRcclxuXHQvL3N3aXRjaCh0aGlzLnR5cGUpIHtcclxuXHQvL2Nhc2UgJ2dyb3dpbmcnIDogXHJcblx0aWYoc2V0VHlwZSA9PT0gJ2dyb3dpbmcnKSB7XHJcblx0XHR0aGlzLnZhbHVlID0gMDtcclxuXHRcdC8vdHJ5VHJpZ2dlciBpcyBjYWxsZWQgYXV0b21hdGljYWxseSB3aGVuIHlvdSBhZGQvc3VidHJhY3QgdmFsdWUsIGFuZCB3aWxsIHRyaWdnZXIgdGhlIG9uRXZlbnQoKSBmdW5jdGlvblxyXG5cdFx0dGhpcy50cnlUcmlnZ2VyID0gZnVuY3Rpb24oKSB7XHJcblx0XHRcdGlmKHRoaXMudmFsdWUgPj0gdGhpcy5tYXhWYWx1ZSkge1xyXG5cdFx0XHRcdHRoaXMub25FdmVudCgpO1xyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cdFx0Ly9icmVhaztcclxuXHR9XHJcblx0ZWxzZSBpZihzZXRUeXBlID09PSAnc2hyaW5raW5nJykge1xyXG5cdC8vY2FzZSAnc2hyaW5raW5nJyA6XHJcblx0XHR0aGlzLnZhbHVlID0gdGhpcy5tYXhWYWx1ZTtcclxuXHRcdHRoaXMudHJ5VHJpZ2dlciA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRpZih0aGlzLnZhbHVlIDw9IDApIHtcclxuXHRcdFx0XHR0aGlzLm9uRXZlbnQoKTtcclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHR9XHJcbn07XHJcblxyXG5Qcm9ncmVzc0Jhci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBQcm9ncmVzc0JhcjtcclxuXHJcblByb2dyZXNzQmFyLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24oKSB7XHJcblx0dGhpcy5ncmFwaGljcy5jbGVhcigpO1xyXG5cdHRoaXMucmVuZGVyYWJsZXMudW5zdWJzY3JpYmUodGhpcyk7XHJcbn07XHJcblxyXG4vL1RvIHN1YnRyYWN0IHZhbHVlLCBqdXN0IHVzZSBuZWdhdGl2ZSBudW1iZXJzIGFzIGFyZ3VtZW50IGkuZS4gZm9vLmFkZFZhbHVlKC01KTtcclxuUHJvZ3Jlc3NCYXIucHJvdG90eXBlLmFkZFZhbHVlID0gZnVuY3Rpb24gKGFkZFRoaXMpIHtcclxuXHR0aGlzLnZhbHVlICs9IGFkZFRoaXM7XHJcblx0aWYodGhpcy52YWx1ZSA+IHRoaXMubWF4VmFsdWUpIHtcclxuXHRcdHRoaXMudmFsdWUgPSB0aGlzLm1heFZhbHVlO1xyXG5cdH1cclxuXHRpZih0aGlzLnZhbHVlIDwgMCkge1xyXG5cdFx0dGhpcy52YWx1ZSA9IDA7XHJcblx0fVxyXG5cdHRoaXMudHJ5VHJpZ2dlcigpO1xyXG59O1xyXG5cclxuLy9TZXRzIHRoZSBsb2NhdGlvbiB3aGVyZSBwcm9ncmVzcyBiYXIgaXMgcmVuZGVyZWRcclxuUHJvZ3Jlc3NCYXIucHJvdG90eXBlLnNldExvY2F0aW9uID0gZnVuY3Rpb24oc2V0WCwgc2V0WSkge1xyXG5cdHRoaXMueCA9IHNldFg7XHJcblx0dGhpcy55ID0gc2V0WTtcclxufTtcclxuXHJcbi8vU2V0cyB0aGUgc2l6ZSBvZiB0aGUgcHJvZ3Jlc3MgYmFyXHJcblByb2dyZXNzQmFyLnByb3RvdHlwZS5zZXRTaXplID0gZnVuY3Rpb24oc2V0V2lkdGgsIHNldEhlaWdodCkge1xyXG5cdHRoaXMud2lkdGggPSBzZXRXaWR0aDtcclxuXHR0aGlzLmhlaWdodCA9IHNldEhlaWdodDtcclxufTtcclxuXHJcblByb2dyZXNzQmFyLnByb3RvdHlwZS5zZXRTdHlsZSA9IGZ1bmN0aW9uKGJnQm9yZGVyU2l6ZSwgYmdCb3JkZXJDb2xvciwgYmdDb2xvciwgcGFkZGluZ0hvcml6LCBwYWRkaW5nVmVydCwgdmFsdWVCb3JkZXJTaXplLCB2YWx1ZUJvcmRlckNvbG9yLCB2YWx1ZUNvbG9yKSB7XHJcblx0dGhpcy5iZ0JvcmRlclNpemUgPSBiZ0JvcmRlclNpemU7XHJcblx0dGhpcy5iZ0JvcmRlckNvbG9yID0gYmdCb3JkZXJDb2xvcjtcclxuXHR0aGlzLmJnQ29sb3IgPSBiZ0NvbG9yO1xyXG5cdHRoaXMucGFkZGluZ0hvcml6ID0gcGFkZGluZ0hvcml6O1xyXG5cdHRoaXMucGFkZGluZ1ZlcnQgPSBwYWRkaW5nVmVydDtcclxuXHR0aGlzLnZhbHVlQm9yZGVyU2l6ZSA9IHZhbHVlQm9yZGVyU2l6ZTtcclxuXHR0aGlzLnZhbHVlQm9yZGVyQ29sb3IgPSB2YWx1ZUJvcmRlckNvbG9yO1xyXG5cdHRoaXMudmFsdWVDb2xvciA9IHZhbHVlQ29sb3I7XHJcbn07XHJcblxyXG4vL3VwZGF0ZSBmb3IgcHJvZ3Jlc3MgYmFyLCBjYWxsZWQganVzdCBiZWZvcmUgZHJhd2luZyBwcm9ncmVzcyBiYXJcclxuLy9PdmVyd3JpdGUgdGhpcyBmdW5jdGlvbiBpZiBkZXNpcmVkXHJcblByb2dyZXNzQmFyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHt9O1xyXG5cclxuLy9SZW5kZXJzIHByb2dyZXNzQmFyXHJcblByb2dyZXNzQmFyLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbigpIHtcclxuXHR0aGlzLnVwZGF0ZSgpO1xyXG5cdHRoaXMuZ3JhcGhpY3MuY2xlYXIoKTtcclxuXHQvL0RyYXcgYmFja2dyb3VuZCBvZiBiYXJcclxuXHR0aGlzLmdyYXBoaWNzLmxpbmVTdHlsZSh0aGlzLmJnQm9yZGVyU2l6ZSwgdGhpcy5iZ0JvcmRlckNvbG9yLCAxKTsgLy9zZXRzIGJvcmRlciBjb2xvciBhbmQgc2l6ZVxyXG5cdHRoaXMuZ3JhcGhpY3MuYmVnaW5GaWxsKHRoaXMuYmdDb2xvcik7IC8vc2V0cyBjb2xvciBvZiBiYWNrZ3JvdW5kIGZpbGxcclxuXHR0aGlzLmdyYXBoaWNzLmRyYXdSZWN0KHRoaXMueC10aGlzLndpZHRoLzIsIHRoaXMueS10aGlzLmhlaWdodC8yLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7XHJcblx0dGhpcy5ncmFwaGljcy5lbmRGaWxsKCk7XHJcblx0Ly9EcmF3IHZhbHVlIG9mIGJhclxyXG5cdHZhciBwZXJjZW50YWdlID0gdGhpcy52YWx1ZSAvIHRoaXMubWF4VmFsdWU7XHJcblx0dmFyIGJhcldpZHRoID0gdGhpcy53aWR0aCAtIHRoaXMucGFkZGluZ0hvcml6O1xyXG5cdHZhciBiYXJIZWlnaHQgPSB0aGlzLmhlaWdodCAtIHRoaXMucGFkZGluZ1ZlcnQ7XHJcblx0dGhpcy5ncmFwaGljcy5saW5lU3R5bGUodGhpcy52YWx1ZUJvcmRlclNpemUsIHRoaXMudmFsdWVCb3JkZXJDb2xvciwgMSk7XHJcblx0dGhpcy5ncmFwaGljcy5iZWdpbkZpbGwodGhpcy52YWx1ZUNvbG9yKTtcclxuXHR0aGlzLmdyYXBoaWNzLmRyYXdSZWN0KHRoaXMueC0oYmFyV2lkdGgvMiksIHRoaXMueS0oYmFySGVpZ2h0LzIpLCBiYXJXaWR0aCpwZXJjZW50YWdlLCBiYXJIZWlnaHQpO1xyXG5cdHRoaXMuZ3JhcGhpY3MuZW5kRmlsbCgpO1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBQcm9ncmVzc0JhcjsiLCJ2YXIgR3JvdXBfTWFuYWdlciA9IHJlcXVpcmUoJy4vZ3JvdXBNYW5hZ2VyJyk7XHJcbnZhciBQZXJzb24gPSByZXF1aXJlKCcuL3BlcnNvbicpO1xyXG5cclxudmFyIEJhY2tncm91bmQgPSBmdW5jdGlvbiAoZ2FtZSwgYmFzZVgsIGJhc2VZLCBoUmF0aW8sIHZSYXRpbywgaW5jb21lLCB0eXBlLCBzdGF0ZSkge1xyXG4gICAgUGhhc2VyLlNwcml0ZS5jYWxsKHRoaXMsIGdhbWUsIGJhc2VYICogaFJhdGlvICogZ2FtZS53aWR0aCwgYmFzZVkgKiB2UmF0aW8gKiBnYW1lLmhlaWdodCwgJ2JhY2tncm91bmQnKTtcclxuICAgIGdhbWUuYWRkLmV4aXN0aW5nKHRoaXMpO1xyXG4gICAgdGhpcy5iYXNlWCA9IGJhc2VYO1xyXG4gICAgdGhpcy5iYXNlWSA9IGJhc2VZO1xyXG4gICAgdGhpcy5oUmF0aW8gPSBoUmF0aW87XHJcbiAgICB0aGlzLnZSYXRpbyA9IHZSYXRpbztcclxuICAgIHRoaXMubmV3SFJhdGlvID0gaFJhdGlvO1xyXG4gICAgdGhpcy5uZXdWUmF0aW8gPSB2UmF0aW87XHJcbiAgICB0aGlzLm1pblJhdGlvID0gLjE7XHJcbiAgICB0aGlzLmdyb3VwX21hbmFnZXIgPSBuZXcgR3JvdXBfTWFuYWdlcih0aGlzLmdhbWUsIHN0YXRlKTtcclxuXHR0aGlzLmdyb3VwX21hbmFnZXIuYmFja2dyb3VuZCA9IHRoaXM7XHJcbiAgIFx0dGhpcy50eXBlID0gdHlwZTtcclxuICAgIHRoaXMuaW5jb21lTGV2ZWwgPSBpbmNvbWU7XHJcblx0dGhpcy5zdGF0ZSA9IHN0YXRlXHJcbn07XHJcblxyXG5CYWNrZ3JvdW5kLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUGhhc2VyLlNwcml0ZS5wcm90b3R5cGUpO1xyXG5CYWNrZ3JvdW5kLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IEJhY2tncm91bmQ7XHJcblxyXG5CYWNrZ3JvdW5kLnByb3RvdHlwZS5nZXRWYXJzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAvL3JldHVybiB4ICYgeSBhbmQgd2lkdGggJiBoZWlnaHQgb2YgdmlzaWJsZVxyXG4gICAgY29uc29sZS5sb2coJ3RoaXMuaFJhdGlvOiAnICsgdGhpcy5oUmF0aW8pO1xyXG4gICAgcmV0dXJuIFt0aGlzLngsIHRoaXMueSwgdGhpcy5oUmF0aW8gKiB0aGlzLmdhbWUud2lkdGgsIHRoaXMudlJhdGlvICogdGhpcy5nYW1lLmhlaWdodF07XHJcbn07XHJcblxyXG5CYWNrZ3JvdW5kLnByb3RvdHlwZS5nZXRWYXJzQ2VudGVyID0gZnVuY3Rpb24oKSB7XHJcbiAgICAvLyAvL3JldHVybiB4ICYgeSBvZiBjZW50ZXIgYW5kIHdpZHRoICYgaGVpZ2h0IG9mIHZpc2libGVcclxuICAgIHZhciB2aXNXaWR0aCA9IHRoaXMuaFJhdGlvICogdGhpcy5nYW1lLndpZHRoO1xyXG4gICAgdmFyIHZpc0hlaWdodCA9IHRoaXMudlJhdGlvICogdGhpcy5nYW1lLmhlaWdodDtcclxuICAgIHJldHVybiB7d2lkdGggOiB2aXNXaWR0aCwgaGVpZ2h0IDogdmlzSGVpZ2h0LCBjZW50ZXIgOiB7eCA6IHRoaXMueCArIHZpc1dpZHRoIC8gMiwgeSA6IHRoaXMueSArIHZpc0hlaWdodCAvIDJ9fTtcclxufTtcclxuXHJcbkJhY2tncm91bmQucHJvdG90eXBlLm51bVBlb3BsZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIG51bSA9IHRoaXMuZ3JvdXBfbWFuYWdlci5udW1QZW9wbGUoKTtcclxuICAgIGlmIChudW0gPT09IDApIHJldHVybiAxO1xyXG4gICAgZWxzZSByZXR1cm4gbnVtO1xyXG59O1xyXG5cclxuQmFja2dyb3VuZC5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7XHJcblx0aWYgKHRoaXMubmV3SFJhdGlvIDwgdGhpcy5taW5SYXRpbykgdGhpcy5uZXdIUmF0aW8gPSB0aGlzLm1pblJhdGlvO1xyXG4gICAgaWYgKHRoaXMubmV3VlJhdGlvIDwgdGhpcy5taW5SYXRpbykgdGhpcy5uZXdWUmF0aW8gPSB0aGlzLm1pblJhdGlvO1xyXG4gICAgaWYgKHRoaXMuaFJhdGlvICE9PSB0aGlzLm5ld0hSYXRpbykge1xyXG4gICAgICAgIGlmICh0aGlzLmhSYXRpbyArIC4wMSA8IHRoaXMubmV3SFJhdGlvKSB0aGlzLmhSYXRpbyArPSAuMDE7XHJcbiAgICAgICAgZWxzZSBpZiAodGhpcy5oUmF0aW8gLSAuMDEgPiB0aGlzLm5ld0hSYXRpbykgdGhpcy5oUmF0aW8gLT0gLjAxO1xyXG4gICAgICAgIGVsc2UgdGhpcy5oUmF0aW8gPSB0aGlzLm5ld0hSYXRpbztcclxuICAgIH1cclxuICAgIGlmICh0aGlzLnZSYXRpbyAhPT0gdGhpcy5uZXdWUmF0aW8pIHtcclxuICAgICAgICBpZiAodGhpcy52UmF0aW8gKyAuMDEgPCB0aGlzLm5ld1ZSYXRpbykgdGhpcy52UmF0aW8gKz0gLjAxO1xyXG4gICAgICAgIGVsc2UgaWYgKHRoaXMudlJhdGlvIC0gLjAxID4gdGhpcy5uZXdWUmF0aW8pIHRoaXMudlJhdGlvIC09IC4wMTtcclxuICAgICAgICBlbHNlIHRoaXMudlJhdGlvID0gdGhpcy5uZXdWUmF0aW87XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy50eXBlID09PSAndW5lbXBsb3llZCcpXHJcbiAgICAgICAgdGhpcy5oUmF0aW8gPSAxO1xyXG4gICAgdGhpcy5ncm91cF9tYW5hZ2VyLnVwZGF0ZSgpO1xyXG59O1xyXG5cclxuXHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEJhY2tncm91bmQ7IiwiLy9Db250cm9scyBiYWNrZ3JvdW5kIGVsZW1lbnRzXHJcblxyXG52YXIgQmFja2dyb3VuZCA9IHJlcXVpcmUoJy4vYmFja2dyb3VuZCcpO1xyXG52YXIgUGVyc29uID0gcmVxdWlyZSgnLi9wZXJzb24nKTtcclxudmFyIHV0aWwgPSByZXF1aXJlKCcuLi91dGlscycpO1xyXG5cclxudmFyIEdyb3VwID0gcmVxdWlyZSgnLi9ncm91cCcpO1xyXG5cclxudmFyIEJhY2tncm91bmRfTWFuYWdlciA9IGZ1bmN0aW9uKGdhbWUsIHN0YXRlKSB7XHJcblx0dGhpcy5nYW1lID0gZ2FtZTtcclxuXHR0aGlzLnN0YXRlID0gc3RhdGU7XHJcblx0Ly9DcmVhdGUgYXJyYXkgb2YgYmFja2dyb3VuZHNcclxuXHR0aGlzLmJnQXJyYXkgPSBbXHJcblx0XHRuZXcgQmFja2dyb3VuZCh0aGlzLmdhbWUsIDAsIDAsIC4zMywgLjMzLCBQZXJzb24uRURVTEVWRUwubG93ICwgJ3dvcmsnICwgc3RhdGUpLFx0Ly8gdGhpcy5iZ0FycmF5WzBdID09IHdvcmtMb3dcclxuXHRcdG5ldyBCYWNrZ3JvdW5kKHRoaXMuZ2FtZSwgMSwgMCwgLjMzLCAuMzMsIFBlcnNvbi5FRFVMRVZFTC5taWQgLCAnd29yaycgLCBzdGF0ZSksXHQvLyB0aGlzLmJnQXJyYXlbMV0gPT0gd29ya01pZFxyXG5cdFx0bmV3IEJhY2tncm91bmQodGhpcy5nYW1lLCAyLCAwLCAuMzMsIC4zMywgUGVyc29uLkVEVUxFVkVMLmhpZ2gsICd3b3JrJyAsIHN0YXRlKSxcdC8vIHRoaXMuYmdBcnJheVsyXSA9PSB3b3JrTWlkXHJcblx0XHRuZXcgQmFja2dyb3VuZCh0aGlzLmdhbWUsIDAsIDEsIC4zMywgLjMzLCBQZXJzb24uRURVTEVWRUwubG93ICwgJ2hvdXNlJywgc3RhdGUpLFx0Ly8gdGhpcy5iZ0FycmF5WzNdID09IGhvdXNlTG93XHJcblx0XHRuZXcgQmFja2dyb3VuZCh0aGlzLmdhbWUsIDEsIDEsIC4zMywgLjMzLCBQZXJzb24uRURVTEVWRUwubWlkICwgJ2hvdXNlJywgc3RhdGUpLFx0Ly8gdGhpcy5iZ0FycmF5WzRdID09IGhvdXNlTWlkXHJcblx0XHRuZXcgQmFja2dyb3VuZCh0aGlzLmdhbWUsIDIsIDEsIC4zMywgLjMzLCBQZXJzb24uRURVTEVWRUwuaGlnaCwgJ2hvdXNlJywgc3RhdGUpLFx0Ly8gdGhpcy5iZ0FycmF5WzVdID09IGhvdXNlTWlkXHJcblx0XHRuZXcgQmFja2dyb3VuZCh0aGlzLmdhbWUsIDAsIDIsICAgMSwgLjMzLCAnJywgICAgICAgICAgICAgICd1bmVtcGxveWVkJywgc3RhdGUpXHRcdC8vIHRoaXMuYmdBcnJheVs2XSA9PSB1bmVtcGxveWVkXHJcblx0XTtcclxuXHRmb3IgKGJnIGluIHRoaXMuYmdBcnJheSkge1xyXG5cdFx0dGhpcy5iZ0FycmF5W2JnXS5teU1hbmFnZXIgPSB0aGlzO1xyXG5cdH1cclxuXHRcclxuXHRmb3IgKHZhciBpIGluIHRoaXMuYmdBcnJheSkge1xyXG5cdFx0aWYgKHRoaXMuYmdBcnJheVtpXS50eXBlID09ICd3b3JrJykge1xyXG5cdFx0XHRpZiAodGhpcy5iZ0FycmF5W2ldLmluY29tZUxldmVsID09PSBQZXJzb24uRURVTEVWRUwubG93KSB7XHJcblx0XHRcdFx0dGhpcy5iZ0FycmF5W2ldLnRpbnQgPSAweGUyNDAyYjtcclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIGlmICh0aGlzLmJnQXJyYXlbaV0uaW5jb21lTGV2ZWwgPT09IFBlcnNvbi5FRFVMRVZFTC5taWQpIHtcclxuXHRcdFx0XHR0aGlzLmJnQXJyYXlbaV0udGludCA9IDB4NTZlMjJiO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2UgaWYgKHRoaXMuYmdBcnJheVtpXS5pbmNvbWVMZXZlbCA9PT0gUGVyc29uLkVEVUxFVkVMLmhpZ2gpIHtcclxuXHRcdFx0XHR0aGlzLmJnQXJyYXlbaV0udGludCA9IDB4MmI1OWUyO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRlbHNlIGlmICh0aGlzLmJnQXJyYXlbaV0udHlwZSA9PSAnaG91c2UnKSB7XHJcblx0XHRcdGlmICh0aGlzLmJnQXJyYXlbaV0uaW5jb21lTGV2ZWwgPT09IFBlcnNvbi5FRFVMRVZFTC5sb3cpIHtcclxuXHRcdFx0XHR0aGlzLmJnQXJyYXlbaV0udGludCA9IDB4ZTU1MzQwO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2UgaWYgKHRoaXMuYmdBcnJheVtpXS5pbmNvbWVMZXZlbCA9PT0gUGVyc29uLkVEVUxFVkVMLm1pZCkge1xyXG5cdFx0XHRcdHRoaXMuYmdBcnJheVtpXS50aW50ID0gMHg2YWUyNDY7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSBpZiAodGhpcy5iZ0FycmF5W2ldLmluY29tZUxldmVsID09PSBQZXJzb24uRURVTEVWRUwuaGlnaCkge1xyXG5cdFx0XHRcdHRoaXMuYmdBcnJheVtpXS50aW50ID0gMHg1NDc2ZGQ7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGVsc2UgeyAvLyBVbmVtcGxveWVkIGJhY2tncm91bmRcclxuXHRcdFx0dGhpcy5iZ0FycmF5W2ldLnRpbnQgPSAweDkzOTM5MztcclxuXHRcdH1cclxuXHR9XHJcblx0XHJcblx0dmFyIHRlc3QgPSB0aGlzLmJnQXJyYXlbNl0uZ3JvdXBfbWFuYWdlcjtcclxuXHR2YXIgdGVzdEZsb2NrID0gbmV3IEdyb3VwKHRoaXMuZ2FtZSwgdGhpcy5nYW1lLndpZHRoIC8gMiArIDEwMCwgdGhpcy5nYW1lLmhlaWdodCAvIDIgKyAxMDAsIHN0YXRlKTtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMTA7IGkrKykge1xyXG4gICAgXHR2YXIgdGVzdFBlcnNvbiA9IG5ldyBQZXJzb24odGhpcy5nYW1lLCB0aGlzLmdhbWUud2lkdGggLyAyICsgaSAqIDE1LCB0aGlzLmdhbWUuaGVpZ2h0IC8gMiArIGkgKiAxNSwgaSk7XHJcbiAgICBcdHRoaXMuZ2FtZS5hZGQuZXhpc3RpbmcodGVzdFBlcnNvbik7XHJcbiAgICBcdHRlc3RGbG9jay5hZGRNZW1iZXIodGVzdFBlcnNvbik7XHJcbiAgICB9XHJcbiAgICB0ZXN0LmFkZE1lbWJlcih0ZXN0RmxvY2spO1xyXG5cdC8vIHRlc3RGbG9jayA9IG5ldyBHcm91cCh0aGlzLmdhbWUsIHRoaXMuZ2FtZS53aWR0aCAvIDIgLSAxMDAsIHRoaXMuZ2FtZS5oZWlnaHQgLyAyICsgMTAwLCBzdGF0ZSk7XHJcblx0Ly8gZm9yICh2YXIgaSA9IDA7IGkgPCAxMDsgaSsrKSB7XHJcbiAgICBcdC8vIHZhciB0ZXN0UGVyc29uID0gbmV3IFBlcnNvbih0aGlzLmdhbWUsIHRoaXMuZ2FtZS53aWR0aCAvIDIgKyBpICogMTUgLSAxMDAsIHRoaXMuZ2FtZS5oZWlnaHQgLyAyICsgaSAqIDE1ICsgMTAwLCBpKTtcclxuICAgIFx0Ly8gdGhpcy5nYW1lLmFkZC5leGlzdGluZyh0ZXN0UGVyc29uKTtcclxuICAgIFx0Ly8gdGVzdEZsb2NrLmFkZE1lbWJlcih0ZXN0UGVyc29uKTtcclxuICAgIC8vIH1cclxuICAgIC8vIHRlc3QuYWRkTWVtYmVyKHRlc3RGbG9jayk7XHJcbn07XHJcblxyXG5CYWNrZ3JvdW5kX01hbmFnZXIucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gQmFja2dyb3VuZF9NYW5hZ2VyO1xyXG5cclxuLypCYWNrZ3JvdW5kX01hbmFnZXIuQkdOQU1FUyA9IHtcclxuXHRcdHdvcmtMb3cgICAgOiB0aGlzLmJnQXJyYXlbMF0sXHJcblx0XHR3b3JrTWlkICAgIDogdGhpcy5iZ0FycmF5WzFdLFxyXG5cdFx0d29ya0hpZ2ggICA6IHRoaXMuYmdBcnJheVsyXSxcclxuXHRcdGhvdXNlTG93ICAgOiB0aGlzLmJnQXJyYXlbM10sXHJcblx0XHRob3VzZU1pZCAgIDogdGhpcy5iZ0FycmF5WzRdLFxyXG5cdFx0aG91c2VIaWdoICA6IHRoaXMuYmdBcnJheVs1XSxcclxuXHRcdHVuZW1wbG95ZWQgOiB0aGlzLmJnQXJyYXlbNl1cclxufTsqL1xyXG5cclxuQmFja2dyb3VuZF9NYW5hZ2VyLnByb3RvdHlwZS5zZW5kVG8gPSBmdW5jdGlvbihzb3VyY2UsIGRlc3RpbmF0aW9uLCBncm91cCkge1xyXG5cdC8vIGNvbnNvbGUubG9nKGRlc3RpbmF0aW9uKTtcclxuXHRpZiAoZGVzdGluYXRpb24gPT09IG51bGwpIHtcclxuXHRcdGNvbnNvbGUubG9nKCdzYWRhc2FzZGhhc2RqaGFkamthZCcpXHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cdHZhciB0cmFuc1R5cGUgPSB0aGlzLnRyYW5zZmVyVHlwZShzb3VyY2UsIGRlc3RpbmF0aW9uLCBncm91cClcclxuXHRpZiAodHJhbnNUeXBlLmNhbikge1x0Ly8gQ2hlY2sgaWYgdGhleSBjYW4gdHJhbnNmZXIgdXBcclxuXHRcdHNvdXJjZS5ncm91cF9tYW5hZ2VyLnRyYW5zZmVyKGRlc3RpbmF0aW9uLmdyb3VwX21hbmFnZXIsIGdyb3VwKTtcclxuXHRcdGlmICh0cmFuc1R5cGUuZWR1Y2F0ZSkge1xyXG5cdFx0XHRncm91cC5zdGFydEVkdWNhdGlvbigpO1xyXG5cdFx0fVxyXG5cdFx0dGhpcy51cGRhdGVSYXRpb3MoZGVzdGluYXRpb24pO1xyXG5cdFx0dmFyIHRlc3QgPSBkZXN0aW5hdGlvbi5nZXRWYXJzQ2VudGVyKCk7XHJcblx0XHQvLyBjb25zb2xlLmxvZyh0ZXN0KTtcclxuXHR9XHJcbn07XHJcbkJhY2tncm91bmRfTWFuYWdlci5wcm90b3R5cGUubnVtUGVvcGxlID0gZnVuY3Rpb24oKSB7XHJcblx0dmFyIGNvdW50ID0gMDtcclxuXHRmb3IgKHZhciBpIGluIHRoaXMuYmdBcnJheSkge1xyXG5cdFx0Y291bnQgKz0gdGhpcy5iZ0FycmF5W2ldLmdyb3VwX21hbmFnZXIubnVtUGVvcGxlKCk7XHJcblx0fVxyXG5cdHJldHVybiBjb3VudDtcclxufTtcclxuQmFja2dyb3VuZF9NYW5hZ2VyLnByb3RvdHlwZS50cmFuc2ZlclR5cGUgPSBmdW5jdGlvbihzb3VyY2UsIGRlc3RpbmF0aW9uLCBncm91cCkge1xyXG5cdHZhciBncm91cEVkdSA9IGdyb3VwLm1lbWJlcnNbMF0uZWR1TGV2ZWw7XHJcblx0dmFyIGNhbiA9IHRoaXMuY2FuVHJhbnNmZXIoc291cmNlLCBkZXN0aW5hdGlvbiwgZ3JvdXApO1xyXG5cdC8vIGNvbnNvbGUubG9nKGRlc3RpbmF0aW9uKTtcclxuXHQvLyBjb25zb2xlLmxvZyhkZXN0aW5hdGlvbi50eXBlLCBkZXN0aW5hdGlvbi5pbmNvbWVMZXZlbCk7XHJcblx0dmFyIGVkdWNhdGUgPSAoZGVzdGluYXRpb24udHlwZSA9PT0gJ2hvdXNlJyAmJiBkZXN0aW5hdGlvbi5pbmNvbWVMZXZlbCkgPiBncm91cEVkdTtcclxuXHRyZXR1cm4ge2NhbiA6IGNhbiwgZWR1Y2F0ZSA6IGVkdWNhdGV9O1xyXG59O1xyXG5CYWNrZ3JvdW5kX01hbmFnZXIucHJvdG90eXBlLmNhblRyYW5zZmVyID0gZnVuY3Rpb24oc291cmNlLCBkZXN0aW5hdGlvbiwgZ3JvdXApIHtcclxuXHQvLyBjb25zb2xlLmxvZyhzb3VyY2UsIGRlc3RpbmF0aW9uLCBncm91cCk7XHJcblx0aWYgKHNvdXJjZSA9PT0gbnVsbCB8fCBkZXN0aW5hdGlvbiA9PT0gbnVsbCkgcmV0dXJuIGZhbHNlO1xyXG5cdHZhciBzb3VyY2VFZHUgPSBncm91cC5tZW1iZXJzWzBdLmVkdUxldmVsO1xyXG5cdGlmIChkZXN0aW5hdGlvbi50eXBlID09PSAndW5lbXBsb3llZCcpIHtcclxuXHRcdHJldHVybiB0cnVlO1xyXG5cdH1cclxuXHRpZiAoc291cmNlRWR1ID09PSBQZXJzb24uRURVTEVWRUwudW5lbXBsb3llZCkge1xyXG5cdFx0aWYgKGRlc3RpbmF0aW9uLmluY29tZUxldmVsID09PSBQZXJzb24uRURVTEVWRUwubG93ICYmIGRlc3RpbmF0aW9uLnR5cGUgPT09ICdob3VzZScpIHtcclxuXHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHR9XHJcblx0fSBlbHNlIGlmIChzb3VyY2VFZHUgPT09IFBlcnNvbi5FRFVMRVZFTC5sb3cpIHtcclxuXHRcdGlmIChkZXN0aW5hdGlvbi5pbmNvbWVMZXZlbCA9PT0gUGVyc29uLkVEVUxFVkVMLmxvdykge1xyXG5cdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdH0gZWxzZSBpZiAoZGVzdGluYXRpb24uaW5jb21lTGV2ZWwgPT09IFBlcnNvbi5FRFVMRVZFTC5taWQpIHtcclxuXHRcdFx0aWYgKGRlc3RpbmF0aW9uLnR5cGUgPT09ICdob3VzZScpIHtcclxuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH0gZWxzZSBpZiAoc291cmNlRWR1ID09PSBQZXJzb24uRURVTEVWRUwubWlkKSB7XHJcblx0XHRpZiAoZGVzdGluYXRpb24uaW5jb21lTGV2ZWwgPT09IFBlcnNvbi5FRFVMRVZFTC5sb3cpIHtcclxuXHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHR9IGVsc2UgaWYgKGRlc3RpbmF0aW9uLmluY29tZUxldmVsID09PSBQZXJzb24uRURVTEVWRUwubWlkKSB7XHJcblx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0fSBlbHNlIGlmIChkZXN0aW5hdGlvbi5pbmNvbWVMZXZlbCA9PT0gUGVyc29uLkVEVUxFVkVMLmhpZ2gpIHtcclxuXHRcdFx0aWYgKGRlc3RpbmF0aW9uLnR5cGUgPT09ICdob3VzZScpIHtcclxuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH0gZWxzZSBpZiAoc291cmNlRWR1ID09PSBQZXJzb24uRURVTEVWRUwuaGlnaCkge1xyXG5cdFx0cmV0dXJuIHRydWU7XHJcblx0fVxyXG5cdHJldHVybiBmYWxzZTtcclxufTtcclxuXHJcbkJhY2tncm91bmRfTWFuYWdlci5wcm90b3R5cGUud2hlcmVDbGlja2VkID0gZnVuY3Rpb24oKSB7XHJcblx0Zm9yICh2YXIgaSBpbiB0aGlzLmJnQXJyYXkpIHtcclxuXHRcdHZhciBjdXJEaW1lbnNpb25zID0gdGhpcy5iZ0FycmF5W2ldLmdldFZhcnMoKTtcclxuXHRcdHZhciBtb3VzZVggPSB0aGlzLmdhbWUuaW5wdXQueDtcclxuXHRcdHZhciBtb3VzZVkgPSB0aGlzLmdhbWUuaW5wdXQueTtcclxuXHRcdGlmKGkgPT0gNikgY29uc29sZS5sb2coJ2N1ckRpbWVuc2lvbnM6ICcgKyBjdXJEaW1lbnNpb25zKTtcclxuXHRcdGlmIChtb3VzZVggPiBjdXJEaW1lbnNpb25zWzBdICYmIG1vdXNlWCA8PSBjdXJEaW1lbnNpb25zWzBdICsgY3VyRGltZW5zaW9uc1syXSkge1xyXG5cdFx0XHRpZiAobW91c2VZID4gY3VyRGltZW5zaW9uc1sxXSAmJiBtb3VzZVkgPD0gY3VyRGltZW5zaW9uc1sxXSArIGN1ckRpbWVuc2lvbnNbM10pIHtcclxuXHRcdFx0XHRyZXR1cm4gdGhpcy5iZ0FycmF5W2ldO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cdHJldHVybiBudWxsO1xyXG59O1xyXG5cclxuQmFja2dyb3VuZF9NYW5hZ2VyLnByb3RvdHlwZS5maW5kT3RoZXIgPSBmdW5jdGlvbihzb3VyY2UsIGRlc3RpbmF0aW9uKSB7XHJcblx0aWYgKHNvdXJjZS50eXBlID09PSAnd29yaycgJiYgZGVzdGluYXRpb24udHlwZSA9PT0gJ3dvcmsnKSB7XHJcblx0XHRpZiAoc291cmNlLmluY29tZUxldmVsID09PSBQZXJzb24uRURVTEVWRUwubG93KSB7XHJcblx0XHRcdGlmIChkZXN0aW5hdGlvbi5pbmNvbWVMZXZlbCA9PT0gUGVyc29uLkVEVUxFVkVMLm1pZCkgcmV0dXJuIHRoaXMuYmdBcnJheVsyXTtcclxuXHRcdFx0ZWxzZSBpZiAoZGVzdGluYXRpb24uaW5jb21lTGV2ZWwgPT09IFBlcnNvbi5FRFVMRVZFTC5oaWdoKSByZXR1cm4gdGhpcy5iZ0FycmF5WzFdO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSBpZiAoc291cmNlLmluY29tZUxldmVsID09PSBQZXJzb24uRURVTEVWRUwubWlkKSB7XHJcblx0XHRcdGlmIChkZXN0aW5hdGlvbi5pbmNvbWVMZXZlbCA9PT0gUGVyc29uLkVEVUxFVkVMLmxvdykgcmV0dXJuIHRoaXMuYmdBcnJheVsyXTtcclxuXHRcdFx0ZWxzZSBpZiAoZGVzdGluYXRpb24uaW5jb21lTGV2ZWwgPT09IFBlcnNvbi5FRFVMRVZFTC5oaWdoKSByZXR1cm4gdGhpcy5iZ0FycmF5WzBdO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSBpZiAoc291cmNlLmluY29tZUxldmVsID09PSBQZXJzb24uRURVTEVWRUwuaGlnaCkge1xyXG5cdFx0XHRpZiAoZGVzdGluYXRpb24uaW5jb21lTGV2ZWwgPT09IFBlcnNvbi5FRFVMRVZFTC5sb3cpIHJldHVybiB0aGlzLmJnQXJyYXlbMV07XHJcblx0XHRcdGVsc2UgaWYgKGRlc3RpbmF0aW9uLmluY29tZUxldmVsID09PSBQZXJzb24uRURVTEVWRUwubWlkKSByZXR1cm4gdGhpcy5iZ0FycmF5WzBdO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRlbHNlIGlmIChzb3VyY2UudHlwZSA9PT0gJ2hvdXNlJyAmJiBkZXN0aW5hdGlvbi50eXBlID09PSAnaG91c2UnKSB7XHJcblx0XHRpZiAoc291cmNlLmluY29tZUxldmVsID09PSBQZXJzb24uRURVTEVWRUwubG93KSB7XHJcblx0XHRcdGlmIChkZXN0aW5hdGlvbi5pbmNvbWVMZXZlbCA9PT0gUGVyc29uLkVEVUxFVkVMLm1pZCkgcmV0dXJuIHRoaXMuYmdBcnJheVs1XTtcclxuXHRcdFx0ZWxzZSBpZiAoZGVzdGluYXRpb24uaW5jb21lTGV2ZWwgPT09IFBlcnNvbi5FRFVMRVZFTC5oaWdoKSByZXR1cm4gdGhpcy5iZ0FycmF5WzRdO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSBpZiAoc291cmNlLmluY29tZUxldmVsID09PSBQZXJzb24uRURVTEVWRUwubWlkKSB7XHJcblx0XHRcdGlmIChkZXN0aW5hdGlvbi5pbmNvbWVMZXZlbCA9PT0gUGVyc29uLkVEVUxFVkVMLmxvdykgcmV0dXJuIHRoaXMuYmdBcnJheVs1XTtcclxuXHRcdFx0ZWxzZSBpZiAoZGVzdGluYXRpb24uaW5jb21lTGV2ZWwgPT09IFBlcnNvbi5FRFVMRVZFTC5oaWdoKSByZXR1cm4gdGhpcy5iZ0FycmF5WzNdO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSBpZiAoc291cmNlLmluY29tZUxldmVsID09PSBQZXJzb24uRURVTEVWRUwuaGlnaCkge1xyXG5cdFx0XHRpZiAoZGVzdGluYXRpb24uaW5jb21lTGV2ZWwgPT09IFBlcnNvbi5FRFVMRVZFTC5sb3cpIHJldHVybiB0aGlzLmJnQXJyYXlbNF07XHJcblx0XHRcdGVsc2UgaWYgKGRlc3RpbmF0aW9uLmluY29tZUxldmVsID09PSBQZXJzb24uRURVTEVWRUwubWlkKSByZXR1cm4gdGhpcy5iZ0FycmF5WzNdO1xyXG5cdFx0fVxyXG5cdH1cclxufTtcclxuXHJcbkJhY2tncm91bmRfTWFuYWdlci5wcm90b3R5cGUudXBkYXRlUmF0aW9zID0gZnVuY3Rpb24oZGVzdGluYXRpb24pIHtcclxuXHRpZiAoZGVzdGluYXRpb24udHlwZSA9PT0gJ3dvcmsnKSB7XHJcblx0XHR2YXIgaFJhdGlvcyA9IHV0aWwucmF0aW8odGhpcy5iZ0FycmF5WzBdLm51bVBlb3BsZSgpLCB0aGlzLmJnQXJyYXlbMV0ubnVtUGVvcGxlKCksIHRoaXMuYmdBcnJheVsyXS5udW1QZW9wbGUoKSk7XHJcblx0fVxyXG5cdGVsc2V7XHJcblx0XHR2YXIgaFJhdGlvcyA9IHV0aWwucmF0aW8odGhpcy5iZ0FycmF5WzNdLm51bVBlb3BsZSgpLCB0aGlzLmJnQXJyYXlbNF0ubnVtUGVvcGxlKCksIHRoaXMuYmdBcnJheVs1XS5udW1QZW9wbGUoKSk7XHJcblx0fVxyXG5cdHZhciBlbXBsb3llZCA9IDA7XHJcblx0Zm9yICh2YXIgaiA9IDA7IGogPCA2OyBqKyspXHJcblx0XHRlbXBsb3llZCArPSB0aGlzLmJnQXJyYXlbal0ubnVtUGVvcGxlKCk7XHJcblx0dmFyIHZSYXRpb3MgPSB1dGlsLnJhdGlvKHRoaXMuYmdBcnJheVs2XS5udW1QZW9wbGUoKSwgZW1wbG95ZWQpO1xyXG5cdGZvciAodmFyIGkgPSAwIGluIHRoaXMuYmdBcnJheSkge1xyXG5cdFx0aWYgKGkgIT09IDYpIHtcdFx0Ly8gSWYgbm90IHVuZW1wbG95ZWQgYmdcclxuXHRcdFx0aWYgKGkgPCAzKSB7XHQvLyBJZiB3b3JrIGJnXHJcblx0XHRcdFx0dGhpcy5iZ0FycmF5W2ldLm5ld0hSYXRpbyA9IGhSYXRpb3NbaV07XHJcblx0XHRcdFx0dGhpcy5iZ0FycmF5W2ldLm5ld1ZSYXRpbyA9IHZSYXRpb3NbMV0gLyAyO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2Uge1x0XHRcdC8vIElmIGhvdXNlIGJnXHJcblx0XHRcdFx0dGhpcy5iZ0FycmF5W2ldLm5ld0hSYXRpbyA9IGhSYXRpb3NbaSAtIDNdO1xyXG5cdFx0XHRcdHRoaXMuYmdBcnJheVtpXS5uZXdWUmF0aW8gPSB2UmF0aW9zWzFdIC8gMjtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0ZWxzZSBiZ0FycmF5W2ldLm5ld1ZSYXRpbyA9IHZSYXRpb3NbMF07IC8vIFVuZW1wbG95ZWQgYmdcclxuXHR9XHJcblx0Y29uc29sZS5sb2codGhpcy5iZ0FycmF5WzBdLmhSYXRpbyk7XHJcblx0Y29uc29sZS5sb2codGhpcy5iZ0FycmF5WzNdLmhSYXRpbyk7XHJcblx0Y29uc29sZS5sb2codGhpcy5iZ0FycmF5WzZdLm1pblJhdGlvKTtcclxufTtcclxuXHJcbkJhY2tncm91bmRfTWFuYWdlci5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7XHJcblx0Zm9yICh2YXIgaSBpbiB0aGlzLmJnQXJyYXkpIHtcclxuICAgIFx0aWYgKHRoaXMuYmdBcnJheVtpXS5pbmNvbWVMZXZlbCA9PT0gUGVyc29uLkVEVUxFVkVMLm1pZCkge1xyXG4gICAgXHRcdHRoaXMuYmdBcnJheVtpXS54ID0gdGhpcy5iZ0FycmF5WzBdLmdldFZhcnMoKVsyXTtcclxuICAgIFx0fVxyXG4gICAgXHRlbHNlIGlmICh0aGlzLmJnQXJyYXlbaV0uaW5jb21lTGV2ZWwgPT09IFBlcnNvbi5FRFVMRVZFTC5oaWdoKSB7XHJcbiAgICBcdCAgICB0aGlzLmJnQXJyYXlbaV0ueCA9IHRoaXMuYmdBcnJheVsxXS5nZXRWYXJzKClbMF0gKyB0aGlzLmJnQXJyYXlbMV0uZ2V0VmFycygpWzJdO1xyXG4gICAgXHR9XHJcbiAgICBcdHRoaXMuYmdBcnJheVtpXS55ID0gdGhpcy5iZ0FycmF5W2ldLmJhc2VZICogdGhpcy5iZ0FycmF5W2ldLnZSYXRpbyAqIHRoaXMuZ2FtZS5oZWlnaHQ7XHJcblx0XHR0aGlzLmJnQXJyYXlbaV0udXBkYXRlKCk7XHJcblx0fVxyXG5cdHZhciB0ZXN0ID0gdGhpcy5iZ0FycmF5WzNdLmdldFZhcnNDZW50ZXIoKTtcclxuXHQvLyBjb25zb2xlLmxvZyh0ZXN0LmNlbnRlci54LCB0ZXN0LmNlbnRlci55KTtcclxuXHQvLyBjb25zb2xlLmxvZyh0aGlzLmJnQXJyYXlbM10uZ3JvdXBfbWFuYWdlci5jZW50ZXIpO1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBCYWNrZ3JvdW5kX01hbmFnZXI7IiwiLy9jb250cm9scyBmbG9ja2luZyBmb3IgYSBncm91cCBvZiBwZXJzb24gb2JqZWN0c1xyXG52YXIgdXRpbCA9IHJlcXVpcmUoJy4uL3V0aWxzJyk7XHJcblxyXG52YXIgR3JvdXAgPSBmdW5jdGlvbiAoZ2FtZSwgY2VudGVyWCwgY2VudGVyWSwgc3RhdGUpIHtcclxuXHR0aGlzLmdhbWUgPSBnYW1lO1xyXG5cdHRoaXMubWVtYmVycyA9IFtdO1xyXG5cdHRoaXMubWluRGlzdCA9IDIwO1xyXG5cdC8vdGhpcy5ub2lzZSA9IDEwO1xyXG5cdHRoaXMuY2VudGVyID0ge3ggOiBjZW50ZXJYLCB5IDogY2VudGVyWX07XHJcblx0dGhpcy5jbGlja0Rpc3QgPSA1MDtcclxuXHR0aGlzLnNlbGVjdGVkID0gZmFsc2U7XHJcblx0dGhpcy5zZWxlY3Rpb24gPSB0aGlzLmdhbWUuYWRkLnNwcml0ZSh0aGlzLmNlbnRlci54LCB0aGlzLmNlbnRlci55LCAnc2VsZWN0aW9uJyk7XHJcblx0dGhpcy5zZWxlY3Rpb24uYW5jaG9yLnNldFRvKDAuNSwgMC41KTtcclxuXHR0aGlzLnNlbGVjdGlvbi53aWR0aCA9IDEwMDtcclxuXHR0aGlzLnNlbGVjdGlvbi5oZWlnaHQgPSAxMDA7XHJcblx0dGhpcy5zZWxlY3Rpb24udmlzaWJsZSA9IGZhbHNlO1xyXG5cdHRoaXMudmVsb2NpdHkgPSB7eCA6IDAsIHkgOiAwfTtcclxuXHR0aGlzLnNwZWVkID0gLjA1O1xyXG5cdHRoaXMuc3RhdGUgPSBzdGF0ZTtcclxuXHR0aGlzLmJvb2sgPSB0aGlzLmdhbWUuYWRkLnNwcml0ZSh0aGlzLmNlbnRlci54LCB0aGlzLmNlbnRlci55LCAnYm9vaycpO1xyXG5cdHRoaXMuYm9vay5hbmNob3Iuc2V0VG8oMC41LCAwLjUpO1xyXG5cdHRoaXMuYm9vay53aWR0aCA9IDI1O1xyXG5cdHRoaXMuYm9vay5oZWlnaHQgPSAyNTtcclxuXHR0aGlzLmJvb2sudmlzaWJsZSA9IGZhbHNlO1xyXG5cdHRoaXMubGVhcm5pbmdUaW1lID0gLjAxO1xyXG5cdFxyXG5cdHRoaXMuc3RhdGUuaW5wdXQub25Eb3duLmFkZCh0aGlzLm9uSW5wdXREb3duLCB0aGlzKTtcclxufVxyXG5Hcm91cC5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBHcm91cDtcclxuR3JvdXAucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG5cdC8vIGNvbnNvbGUubG9nKHRoaXMuY2VudGVyKTtcclxuXHQvL3VwZGF0ZSBjZW50ZXJcclxuXHR2YXIgbmV3WCA9IHRoaXMuY2VudGVyLnggKyB0aGlzLnZlbG9jaXR5LnggKiB0aGlzLnNwZWVkO1xyXG5cdHZhciBuZXdZID0gdGhpcy5jZW50ZXIueSArIHRoaXMudmVsb2NpdHkueSAqIHRoaXMuc3BlZWQ7XHJcblx0dGhpcy5jaGFuZ2VDZW50ZXIoe3ggOiBuZXdYLCB5IDogbmV3WX0pO1xyXG5cdGZvciAodmFyIG1lbWJlciBpbiB0aGlzLm1lbWJlcnMpIHtcclxuXHRcdG1lbWJlciA9IHRoaXMubWVtYmVyc1ttZW1iZXJdO1xyXG5cdFx0dmFyIHZlbG9jaXR5ID0ge3g6MCwgeTowfTtcclxuXHRcdHZhciBkaWZmID0ge3g6MCwgeTowfTtcclxuXHRcdGRpZmYueCA9IHRoaXMuY2VudGVyLnggLSBtZW1iZXIueDtcclxuXHRcdGRpZmYueSA9IHRoaXMuY2VudGVyLnkgLSBtZW1iZXIueTtcclxuXHRcdHZlbG9jaXR5LnggKz0gZGlmZi54O1xyXG5cdFx0dmVsb2NpdHkueSArPSBkaWZmLnk7XHJcblx0XHRmb3IgKHZhciBvdGhlciBpbiB0aGlzLm1lbWJlcnMpIHtcclxuXHRcdFx0b3RoZXIgPSB0aGlzLm1lbWJlcnNbb3RoZXJdO1xyXG5cdFx0XHQvL2lnbm9yZSBzZWxmXHJcblx0XHRcdGlmIChvdGhlciA9PT0gbWVtYmVyKSB7XHJcblx0XHRcdFx0Y29udGludWU7XHJcblx0XHRcdH1cclxuXHRcdFx0dmFyIG9EaWZmID0ge3g6MCwgeTowfTtcclxuXHRcdFx0b0RpZmYueCA9IG90aGVyLnggLSBtZW1iZXIueDtcclxuXHRcdFx0b0RpZmYueSA9IG90aGVyLnkgLSBtZW1iZXIueTtcclxuXHRcdFx0dmFyIHRvdGFsRGlzdCA9IHV0aWwuaHlwb3RlbnVzZShvRGlmZi54LCBvRGlmZi55KTtcclxuXHRcdFx0aWYgKHRvdGFsRGlzdCA8PSB0aGlzLm1pbkRpc3QpIHtcclxuXHRcdFx0XHR2ZWxvY2l0eS54ID0gLTEgKiBvRGlmZi54O1xyXG5cdFx0XHRcdHZlbG9jaXR5LnkgPSAtMSAqIG9EaWZmLnk7XHJcblx0XHRcdFx0Ly8gdmVsb2NpdHkueCAtPSBvRGlmZi54O1xyXG5cdFx0XHRcdC8vIHZlbG9jaXR5LnkgLT0gb0RpZmYueTtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0Ly8gaWYgKHV0aWwuaHlwb3RlbnVzZSh2ZWxvY2l0eS54LCB2ZWxvY2l0eS55KSA8IHRoaXMubWluVmVsb2NpdHkpIHtcclxuXHRcdFx0Ly8gdmVsb2NpdHkueCA9IHZlbG9jaXR5LnkgPSAwO1xyXG5cdFx0Ly8gfVxyXG5cdFx0bWVtYmVyLnZlbG9jaXR5ID0gdmVsb2NpdHk7XHJcblx0fVxyXG59O1xyXG5Hcm91cC5wcm90b3R5cGUuYWRkTWVtYmVyID0gZnVuY3Rpb24obWVtYmVyKSB7XHJcblx0dGhpcy5tZW1iZXJzLnB1c2gobWVtYmVyKTtcclxuXHRtZW1iZXIuZ3JvdXAgPSB0aGlzO1xyXG59O1xyXG5Hcm91cC5wcm90b3R5cGUub25JbnB1dERvd24gPSBmdW5jdGlvbigpIHtcclxuXHQvLyBjb25zb2xlLmxvZygnYScpO1xyXG5cdGlmICh0aGlzLnNlbGVjdGVkKSB7XHJcblx0XHQvLyBjb25zb2xlLmxvZygnYycpO1xyXG5cdFx0Ly8gY29uc29sZS5sb2codGhpcy5teU1hbmFnZXIsIHRoaXMubXlNYW5hZ2VyLmJhY2tncm91bmQpO1xyXG5cdFx0dmFyIGJnID0gdGhpcy5teU1hbmFnZXIuYmFja2dyb3VuZC5teU1hbmFnZXIud2hlcmVDbGlja2VkKCk7XHJcblx0XHQvLyBjb25zb2xlLmxvZyhiZyk7XHJcblx0XHR0aGlzLm15TWFuYWdlci5iYWNrZ3JvdW5kLm15TWFuYWdlci5zZW5kVG8odGhpcy5teU1hbmFnZXIuYmFja2dyb3VuZCwgYmcsIHRoaXMpO1xyXG5cdFx0dGhpcy5zZXRTZWxlY3RlZChmYWxzZSk7XHJcblx0fSBlbHNlIGlmICh0aGlzLmNsaWNrZWQoKSkge1xyXG5cdFx0dGhpcy5jbGljaygpO1xyXG5cdH1cclxufTtcclxuR3JvdXAucHJvdG90eXBlLnN0YXJ0RWR1Y2F0aW9uID0gZnVuY3Rpb24oKSB7XHJcblx0dGhpcy5sZWFybmluZyA9IGZhbHNlO1xyXG5cdHRoaXMuYm9vay52aXNpYmxlID0gdHJ1ZTtcclxuXHR0aGlzLnN0YXRlLmdhbWUudGltZS5ldmVudHMuYWRkKFBoYXNlci5UaW1lci5TRUNPTkQgKiB0aGlzLmxlYXJuaW5nVGltZSwgdGhpcy5lbmRFZHVjYXRpb24sIHRoaXMpO1xyXG59O1xyXG5Hcm91cC5wcm90b3R5cGUuZW5kRWR1Y2F0aW9uID0gZnVuY3Rpb24oKSB7XHJcblx0Zm9yICh2YXIgbWVtYmVyIGluIHRoaXMubWVtYmVycykge1xyXG5cdFx0dGhpcy5tZW1iZXJzW21lbWJlcl0uZWR1TGV2ZWwgKz0gMTtcclxuXHR9XHJcblx0dGhpcy5sZWFybmluZyA9IGZhbHNlO1xyXG5cdHRoaXMuYm9vay52aXNpYmxlID0gZmFsc2U7XHJcbn07XHJcbkdyb3VwLnByb3RvdHlwZS5jbGlja2VkID0gZnVuY3Rpb24oKSB7XHJcblx0dmFyIG1vdXNlWCA9IHRoaXMuZ2FtZS5pbnB1dC54O1xyXG5cdHZhciBtb3VzZVkgPSB0aGlzLmdhbWUuaW5wdXQueTtcclxuXHR2YXIgZGlmZlggPSBtb3VzZVggLSB0aGlzLmNlbnRlci54O1xyXG5cdHZhciBkaWZmWSA9IG1vdXNlWSAtIHRoaXMuY2VudGVyLnk7XHJcblx0dmFyIHRvdGFsRGlmZiA9IHV0aWwuaHlwb3RlbnVzZShkaWZmWCwgZGlmZlkpO1xyXG5cdGlmICh0b3RhbERpZmYgPD0gdGhpcy5jbGlja0Rpc3QpIHtcclxuXHRcdHJldHVybiB0cnVlO1xyXG5cdH1cclxuXHRyZXR1cm4gZmFsc2U7XHJcbn07XHJcbkdyb3VwLnByb3RvdHlwZS5jbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdGlmICh0aGlzLnNlbGVjdGVkKSB7XHJcblx0XHR0aGlzLnNldFNlbGVjdGVkKGZhbHNlKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0dGhpcy5zZXRTZWxlY3RlZCh0cnVlKTtcclxuXHR9XHJcbn07XHJcbkdyb3VwLnByb3RvdHlwZS5tb3ZlID0gZnVuY3Rpb24oKSB7XHJcblx0dmFyIG1vdXNlWCA9IHRoaXMuZ2FtZS5pbnB1dC54O1xyXG5cdHZhciBtb3VzZVkgPSB0aGlzLmdhbWUuaW5wdXQueTtcclxuXHR0aGlzLmNoYW5nZUNlbnRlcih7eCA6IG1vdXNlWCwgeSA6IG1vdXNlWX0pO1xyXG5cdHRoaXMuc2V0U2VsZWN0ZWQoZmFsc2UpO1xyXG5cdC8vIGNvbnNvbGUubG9nKHt4IDogbW91c2VYLCB5IDogbW91c2VZfSk7c1xyXG59O1xyXG5Hcm91cC5wcm90b3R5cGUuc2V0U2VsZWN0ZWQgPSBmdW5jdGlvbihuZXdTZWxlY3RlZCkge1xyXG5cdHRoaXMuc2VsZWN0ZWQgPSBuZXdTZWxlY3RlZDtcclxuXHR0aGlzLnNlbGVjdGlvbi52aXNpYmxlID0gbmV3U2VsZWN0ZWQ7XHJcbn07XHJcbkdyb3VwLnByb3RvdHlwZS5jaGFuZ2VDZW50ZXIgPSBmdW5jdGlvbihuZXdDZW50ZXIpIHtcclxuXHR0aGlzLnNlbGVjdGlvbi54ID0gbmV3Q2VudGVyLng7XHJcblx0dGhpcy5zZWxlY3Rpb24ueSA9IG5ld0NlbnRlci55O1xyXG5cdHRoaXMuYm9vay54ID0gbmV3Q2VudGVyLng7XHJcblx0dGhpcy5ib29rLnkgPSBuZXdDZW50ZXIueTtcclxuXHR0aGlzLmNlbnRlciA9IG5ld0NlbnRlcjtcclxufTtcclxuR3JvdXAucHJvdG90eXBlLm51bVBlb3BsZSA9IGZ1bmN0aW9uKCkge1xyXG5cdHJldHVybiB0aGlzLm1lbWJlcnMubGVuZ3RoO1xyXG59O1xyXG5Hcm91cC5wcm90b3R5cGUubW91c2VEb3duID0gZnVuY3Rpb24oKSB7XHJcblx0XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEdyb3VwO1xyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4iLCJ2YXIgVXRpbCA9IHJlcXVpcmUoJy4uL3V0aWxzJyk7XHJcblxyXG52YXIgR3JvdXBNYW5hZ2VyID0gZnVuY3Rpb24gKGdhbWUpIHtcclxuXHR0aGlzLmdhbWUgPSBnYW1lO1xyXG5cdHRoaXMubWVtYmVycyA9IFtdO1xyXG5cdC8qXHJcblx0dGhpcy5ib3VuZCA9IHtcclxuXHRcdHVwcGVyIDogY2VudGVyLnkgLSBoZWlnaHQgLyAyLFxyXG5cdFx0bG93ZXIgOiBjZW50ZXIueSArIGhlaWdodCAvIDIsXHJcblx0XHRsZWZ0IDogY2VudGVyLnggLSB3aWR0aCAvIDIsXHJcblx0XHRyaWdodCA6IGNlbnRlci54ICsgd2lkdGggLyAyXHJcblx0fTtcclxuXHR0aGlzLndpZHRoID0gd2lkdGg7XHJcblx0dGhpcy5oZWlnaHQgPSBoZWlnaHQ7XHJcblx0dGhpcy5jZW50ZXIgPSBjZW50ZXI7XHJcblx0dGhpcy5taW5EaXN0ID0gd2lkdGggLyAyO1xyXG5cdCovXHJcblx0LypcclxuXHRQaGFzZXIuU3ByaXRlLmNhbGwodGhpcywgZ2FtZSwgeCwgeSwgJ3BlcnNvbicpO1xyXG5cdHRoaXMudmVsb2NpdHkgPSB7eDowLCB5OjB9O1xyXG5cdHRoaXMud2lkdGggPSAxMDtcclxuXHR0aGlzLmhlaWdodCA9IDEwO1xyXG5cdHRoaXMuc3BlZWQgPSAuMDU7XHJcblx0dGhpcy5pZCA9IGlkO1xyXG5cdCovXHJcbn07XHJcbkdyb3VwTWFuYWdlci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBHcm91cE1hbmFnZXI7XHJcbkdyb3VwTWFuYWdlci5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7XHJcblx0Ly8gY29uc29sZS5sb2codGhpcy5jZW50ZXIpO1xyXG5cdC8vdXBkYXRlIGJvdW5kc1xyXG5cdGlmICh0aGlzLmJhY2tncm91bmQpIHtcclxuXHRcdHZhciB2YXJzID0gdGhpcy5iYWNrZ3JvdW5kLmdldFZhcnNDZW50ZXIoKTtcclxuXHRcdHRoaXMud2lkdGggPSB2YXJzLndpZHRoO1xyXG5cdFx0dGhpcy5oZWlnaHQgPSB2YXJzLmhlaWdodDtcclxuXHRcdHRoaXMuY2VudGVyID0gdmFycy5jZW50ZXI7XHJcblx0XHQvLyBjb25zb2xlLmxvZyh2YXJzKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHQvL3VwZGF0ZSBtZW1iZXIgdmVsb2NpdHlcclxuXHRmb3IgKHZhciBtZW1iZXIgaW4gdGhpcy5tZW1iZXJzKSB7XHJcblx0XHRtZW1iZXIgPSB0aGlzLm1lbWJlcnNbbWVtYmVyXTtcclxuXHRcdHZhciB2ZWxvY2l0eSA9IHt4IDogMCwgeSA6IDB9O1xyXG5cdFx0Ly8gY29uc29sZS5sb2codGhpcy5jZW50ZXIsIG1lbWJlci5jZW50ZXIpO1xyXG5cdFx0dmFyIGRpZmZYID0gdGhpcy5jZW50ZXIueCAtIG1lbWJlci5jZW50ZXIueDtcclxuXHRcdHZhciBkaWZmWSA9IHRoaXMuY2VudGVyLnkgLSBtZW1iZXIuY2VudGVyLnk7XHJcblx0XHR2ZWxvY2l0eS54ID0gZGlmZlg7XHJcblx0XHR2ZWxvY2l0eS55ID0gZGlmZlk7XHJcblx0XHRmb3IgKHZhciBvdGhlciBpbiB0aGlzLm1lbWJlcnMpIHtcclxuXHRcdFx0b3RoZXIgPSB0aGlzLm1lbWJlcnNbb3RoZXJdO1xyXG5cdFx0XHRpZiAob3RoZXIgPT09IG1lbWJlcikge1xyXG5cdFx0XHRcdGNvbnRpbnVlO1xyXG5cdFx0XHR9XHJcblx0XHRcdHZhciBvRGlmZnggPSBvdGhlci5jZW50ZXIueCAtIG1lbWJlci5jZW50ZXIueDtcclxuXHRcdFx0dmFyIG9EaWZmeSA9IG90aGVyLmNlbnRlci55IC0gbWVtYmVyLmNlbnRlci55O1xyXG5cdFx0XHR2YXIgaHlwID0gVXRpbC5oeXBvdGVudXNlKG9EaWZmeCwgb0RpZmZ5KTtcclxuXHRcdFx0Ly9jb25zb2xlLmxvZyhoeXApO1xyXG5cdFx0XHRpZiAoaHlwIDw9IHRoaXMubWluRGlzdCkge1xyXG5cdFx0XHRcdC8vIGNvbnNvbGUubG9nKCdiJywgaHlwKTtcclxuXHRcdFx0XHR2ZWxvY2l0eS54ID0gLTEgKiBvRGlmZng7XHJcblx0XHRcdFx0dmVsb2NpdHkueSA9IC0xICogb0RpZmZ5O1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdC8vIGNvbnNvbGUubG9nKCdhJyk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdG1lbWJlci52ZWxvY2l0eSA9IHZlbG9jaXR5O1xyXG5cdH1cclxuXHQvL3VwZGF0ZSBtZW1iZXJzXHJcblx0Zm9yIChtZW1iZXIgaW4gdGhpcy5tZW1iZXJzKSB7XHJcblx0XHR0aGlzLm1lbWJlcnNbbWVtYmVyXS51cGRhdGUoKTtcclxuXHR9XHJcbn07XHJcbkdyb3VwTWFuYWdlci5wcm90b3R5cGUudHJhbnNmZXIgPSBmdW5jdGlvbihvdGhlckdNLCBteU1lbWJlcikge1xyXG5cdHZhciB0ZXN0VmFscyA9IG90aGVyR00uYmFja2dyb3VuZC5nZXRWYXJzQ2VudGVyKCk7XHJcblx0Ly8gY29uc29sZS5sb2coJ3RyYW5zZmVyIHRvJywgb3RoZXJHTS5iYWNrZ3JvdW5kLnR5cGUsIG90aGVyR00uYmFja2dyb3VuZC5pbmNvbWVMZXZlbCwgdGVzdFZhbHMuY2VudGVyLnksIHRlc3RWYWxzLnksIHRlc3RWYWxzLnZpc0hlaWdodCwgdGVzdFZhbHMudlJhdGlvKTtcclxuXHQvKlxyXG5cdGlmICghKG15TWVtYmVyIGluIHRoaXMubWVtYmVycykpIHtcclxuXHRcdGNvbnNvbGUubG9nKCdFUlJPUicsIG15TWVtYmVyLCAnbm90IGluJywgdGhpcyk7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cdCovXHJcblx0dmFyIGluZGV4ID0gdGhpcy5tZW1iZXJzLmluZGV4T2YobXlNZW1iZXIpO1xyXG5cdHRoaXMubWVtYmVycy5zcGxpY2UoaW5kZXgsIDEpO1xyXG5cdG90aGVyR00uYWRkTWVtYmVyKG15TWVtYmVyKTtcclxufTtcclxuR3JvdXBNYW5hZ2VyLnByb3RvdHlwZS5hZGRNZW1iZXIgPSBmdW5jdGlvbihtZW1iZXIpIHtcclxuXHR0aGlzLm1lbWJlcnMucHVzaChtZW1iZXIpO1xyXG5cdG1lbWJlci5teU1hbmFnZXIgPSB0aGlzO1xyXG5cdHZhciBzbWFsbGVyID0gKHRoaXMud2lkdGggPCB0aGlzLmhlaWdodCkgPyB0aGlzLndpZHRoIDogdGhpcy5oZWlnaHQ7XHJcblx0dGhpcy5taW5EaXN0ID0gc21hbGxlciAvIHRoaXMubWVtYmVycy5sZW5ndGg7XHJcblx0Ly8gY29uc29sZS5sb2codGhpcy5taW5EaXN0KTtcclxufTtcclxuR3JvdXBNYW5hZ2VyLnByb3RvdHlwZS5udW1QZW9wbGUgPSBmdW5jdGlvbigpIHtcclxuXHR2YXIgY291bnQgPSAwO1xyXG5cdGZvciAodmFyIG1lbWJlciBpbiB0aGlzLm1lbWJlcnMpIHtcclxuXHRcdG1lbWJlciA9IHRoaXMubWVtYmVyc1ttZW1iZXJdO1xyXG5cdFx0Y291bnQgKz0gbWVtYmVyLm51bVBlb3BsZSgpO1xyXG5cdH1cclxuXHRyZXR1cm4gY291bnQ7XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEdyb3VwTWFuYWdlcjtcclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4iLCJ2YXIgUGVyc29uID0gZnVuY3Rpb24gKGdhbWUsIHgsIHksIGlkKSB7XHJcblx0UGhhc2VyLlNwcml0ZS5jYWxsKHRoaXMsIGdhbWUsIHgsIHksICdwZXJzb24nKTtcclxuXHR0aGlzLnZlbG9jaXR5ID0ge3g6MCwgeTowfTtcclxuXHR0aGlzLndpZHRoID0gMTA7XHJcblx0dGhpcy5oZWlnaHQgPSAxMDtcclxuXHR0aGlzLnNwZWVkID0gLjA1O1xyXG5cdHRoaXMuaWQgPSBpZDtcclxuXHR0aGlzLmVkdUxldmVsID0gUGVyc29uLkVEVUxFVkVMLnVuZW1wbG95ZWQ7XHJcblx0dGhpcy5oYXBwaW5lc3MgPSAxMDA7XHJcbn07XHJcblBlcnNvbi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBoYXNlci5TcHJpdGUucHJvdG90eXBlKTtcclxuUGVyc29uLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFBlcnNvbjtcclxuXHJcblBlcnNvbi5FRFVMRVZFTCA9IHtcclxuXHR1bmVtcGxveWVkIDogLTEsXHJcblx0bG93ICA6IDAsXHJcblx0bWlkICA6IDEsXHJcblx0aGlnaCA6IDJcclxufTtcclxuXHJcblBlcnNvbi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7XHJcblx0dGhpcy54ICs9IHRoaXMudmVsb2NpdHkueCAqIHRoaXMuc3BlZWQ7XHJcblx0dGhpcy55ICs9IHRoaXMudmVsb2NpdHkueSAqIHRoaXMuc3BlZWQ7XHJcblx0Ly9jb25zb2xlLmxvZyh0aGlzLnZlbG9jaXR5KTtcclxufTtcclxuLy9UT0RPIGFkanVzdCB0YXggYnkgdGF4IHJhdGUgYW5kIGhhcHBpbmVzc1xyXG5QZXJzb24ucHJvdG90eXBlLmdldFRheCA9IGZ1bmN0aW9uKCkge1xyXG5cdC8vIGNvbnNvbGUubG9nKCdnZXQgdGF4JywgdGhpcy5ncm91cC5teU1hbmFnZXIuYmFja2dyb3VuZC50eXBlKTtcclxuXHRpZiAodGhpcy5ncm91cC5teU1hbmFnZXIuYmFja2dyb3VuZC50eXBlID09PSAnaG91c2UnKSB7XHJcblx0XHRpZiAodGhpcy5ncm91cC5teU1hbmFnZXIuYmFja2dyb3VuZC5pbmNvbWVMZXZlbCA9PT0gUGVyc29uLkVEVUxFVkVMLmxvdykge1xyXG5cdFx0XHRyZXR1cm4gLTE7XHJcblx0XHR9IGVsc2UgaWYgKHRoaXMuZ3JvdXAubXlNYW5hZ2VyLmJhY2tncm91bmQuaW5jb21lTGV2ZWwgPT09IFBlcnNvbi5FRFVMRVZFTC5taWQpIHtcclxuXHRcdFx0cmV0dXJuIC0yO1xyXG5cdFx0fSBlbHNlIGlmICh0aGlzLmdyb3VwLm15TWFuYWdlci5iYWNrZ3JvdW5kLmluY29tZUxldmVsID09PSBQZXJzb24uRURVTEVWRUwuaGlnaCkge1xyXG5cdFx0XHRyZXR1cm4gLTM7XHJcblx0XHR9XHJcblx0fSBlbHNlIGlmICh0aGlzLmdyb3VwLm15TWFuYWdlci5iYWNrZ3JvdW5kLnR5cGUgPT09ICd3b3JrJykge1xyXG5cdFx0aWYgKHRoaXMuZ3JvdXAubXlNYW5hZ2VyLmJhY2tncm91bmQuaW5jb21lTGV2ZWwgPT09IFBlcnNvbi5FRFVMRVZFTC5sb3cpIHtcclxuXHRcdFx0cmV0dXJuIDE7XHJcblx0XHR9IGVsc2UgaWYgKHRoaXMuZ3JvdXAubXlNYW5hZ2VyLmJhY2tncm91bmQuaW5jb21lTGV2ZWwgPT09IFBlcnNvbi5FRFVMRVZFTC5taWQpIHtcclxuXHRcdFx0cmV0dXJuIDI7XHJcblx0XHR9IGVsc2UgaWYgKHRoaXMuZ3JvdXAubXlNYW5hZ2VyLmJhY2tncm91bmQuaW5jb21lTGV2ZWwgPT09IFBlcnNvbi5FRFVMRVZFTC5oaWdoKSB7XHJcblx0XHRcdHJldHVybiAzO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRyZXR1cm4gMDtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gUGVyc29uOyIsInZhciBQbGF5ZXIgPSBmdW5jdGlvbiAoZ2FtZSwgeCwgeSkge1xyXG4gICAgUGhhc2VyLlNwcml0ZS5jYWxsKHRoaXMsIGdhbWUsIHgsIHksICd0ZXN0c3ByaXRlJyk7XHJcbiAgICBnYW1lLmFkZC5leGlzdGluZyh0aGlzKTtcclxuXHR0aGlzLnNwZWVkID0gMC4xO1xyXG59XHJcblxyXG5QbGF5ZXIucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShQaGFzZXIuU3ByaXRlLnByb3RvdHlwZSk7XHJcblBsYXllci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBQbGF5ZXI7XHJcblxyXG4vKipcclxuICogQXV0b21hdGljYWxseSBjYWxsZWQgYnkgV29ybGQudXBkYXRlXHJcbiAqL1xyXG5QbGF5ZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG5cdC8vdGhpcy54ICs9IHRoaXMudmVsb2NpdHk7XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFBsYXllcjtcclxuIiwidmFyIFByb2dyZXNzQmFyID0gcmVxdWlyZSgnLi9Qcm9ncmVzc0JhcicpO1xyXG5cclxudmFyIFVJQnVpbGRlciA9IGZ1bmN0aW9uKHNldEdhbWVTdGF0ZSkge1xyXG5cdC8vRW5zdXJlIHRoYXQgY2Fubm90IGNyZWF0ZSBtdWx0aXBsZSBpbnN0YW5jZXMgb2YgdGhpcyBjbGFzc1xyXG5cdGlmKFVJQnVpbGRlci5wcm90b3R5cGUuZXhpc3RzKSB7XHJcblx0XHRyZXR1cm4gVUlCdWlsZGVyLnByb3RvdHlwZS5leGlzdGluZ1JlZmVyZW5jZTtcclxuXHR9XHJcblx0XHJcblx0dGhpcy5nYW1lU3RhdGUgPSBzZXRHYW1lU3RhdGU7XHJcblx0dGhpcy5yZW5kZXJhYmxlcyA9IFtdO1xyXG5cdC8vQ3JlYXRlIGFuZCBzdG9yZSBhIGdyYXBoaWNzIG9iamVjdCAodXNlZCBmb3Igc3R1ZmYgbGlrZSBkcmF3aW5nIHJlY3RhbmdsZXMpXHJcblx0VUlCdWlsZGVyLnByb3RvdHlwZS5leGlzdHMgPSB0cnVlO1xyXG5cdFVJQnVpbGRlci5wcm90b3R5cGUuZXhpc3RpbmdSZWZlcmVuY2UgPSB0aGlzO1xyXG59O1xyXG5cclxuVUlCdWlsZGVyLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFVJQnVpbGRlcjtcclxuLy9UaGVzZSB2YXIncyBoZWxwIGNyZWF0ZSB0aGUgc2luZ2xldG9uIGZ1bmN0aW9uYWxpdHlcclxuVUlCdWlsZGVyLnByb3RvdHlwZS5leGlzdHMgPSBmYWxzZTtcclxuVUlCdWlsZGVyLnByb3RvdHlwZS5leGlzdGluZ1JlZmVyZW5jZSA9IG51bGw7XHJcblxyXG4vL1VzZSB0aGlzIGZ1bmN0aW9uIHRvIGNyZWF0ZSBhIHByb2dyZXNzIGJhclxyXG4vL1VzYWdlOiB0eXBlOiBjYW4gYmUgXCJncm93aW5nXCIgb3IgXCJzaHJpbmtpbmdcIiwgdGhpcyB3aWxsIGVmZmVjdCBpZiBiYXIgc3RhcnRzIGF0IDAgYW5kIGdvZXMgdXAgb3IgdmlzIHZlcnNhXHJcbi8vXHRcdCBtYXhWYWx1ZTogc2V0cyB0aGUgbWF4IHZhbHVlIG9mIHRoZSBwcm9ncmVzcyBiYXIsIGkuZS4gdXNpbmcgMTAwIGNyZWF0ZXMgYSBiYXIgZnJvbSAwIHRvIDEwMFxyXG4vL1x0XHQgeCx5OiBzZXRzIGxvY2F0aW9uXHJcbi8vXHRcdCBET04nVCBGT1JHRVQgdG8gb3ZlcndyaXRlIHRoZSBvbkV2ZW50KCkgZnVuY3Rpb24gZm9yIHRoZSBwcm9ncmVzcyBiYXIgYWZ0ZXIgY3JlYXRpbmcgaXRcclxuLy9cdFx0XHQtb25FdmVudCgpIGlzIGF1dG9tYXRpY2FsbHkgY2FsbGVkIHdoZW4gYmFyIGZpbGxzL3Nocmlua3MgcGFzdCBsaW1pdCAoZGVwZW5kaW5nIG9uIGJhciB0eXBlKVxyXG5VSUJ1aWxkZXIucHJvdG90eXBlLmJ1aWxkUHJvZ3Jlc3NCYXIgPSBmdW5jdGlvbih0eXBlLCB4LCB5LCB3aWR0aCwgaGVpZ2h0LCBtYXhWYWx1ZSkge1xyXG5cdC8vY3JlYXRlIGFuZCBmb3JtYXQgbmV3IHByb2cgYmFyXHJcblx0dmFyIGdyYXBoaWNzID0gdGhpcy5nYW1lU3RhdGUuZ2FtZS5hZGQuZ3JhcGhpY3MoMCwwKTtcclxuXHR2YXIgbmV3UHJvZ0JhciA9IG5ldyBQcm9ncmVzc0Jhcih0eXBlLCBtYXhWYWx1ZSwgZ3JhcGhpY3MsIHRoaXMucmVuZGVyYWJsZXMpO1xyXG5cdG5ld1Byb2dCYXIuc2V0TG9jYXRpb24oeCx5KTtcclxuXHRuZXdQcm9nQmFyLnNldFNpemUod2lkdGgsIGhlaWdodCk7XHJcblx0Ly9zdWJzY3JpYmUgdG8gJ3JlbmRlcmFibGVzJyBzbyB0aGF0IHJlbmRlcigpIGlzIGNhbGxlZCBhdXRvbWF0aWNhbGx5XHJcblx0Ly8gdGhpcy5yZW5kZXJhYmxlcy5zdWJzY3JpYmUobmV3UHJvZ0Jhcik7XHJcblx0dGhpcy5yZW5kZXJhYmxlcy5wdXNoKG5ld1Byb2dCYXIpO1xyXG5cdHJldHVybiBuZXdQcm9nQmFyO1xyXG59O1xyXG5VSUJ1aWxkZXIucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uKCkge1xyXG5cdGZvciAocmVuZGVyYWJsZSBpbiB0aGlzLnJlbmRlcmFibGVzKSB7XHJcblx0XHR0aGlzLnJlbmRlcmFibGVzW3JlbmRlcmFibGVdLnJlbmRlcigpO1xyXG5cdH1cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gVUlCdWlsZGVyOyIsIid1c2Ugc3RyaWN0JztcclxuXHJcbnZhciBnYW1lID0gbmV3IFBoYXNlci5HYW1lKDgwMCwgNjAwLCBQaGFzZXIuQVVUTywgJy1nYW1lJyk7XHJcblxyXG53aW5kb3cuVXRpbHMgPSByZXF1aXJlKCcuL3V0aWxzJyk7XHJcbndpbmRvdy5wbGF5ZXJTdGF0ZSA9IHtcclxuICAgIGN1cnJlbnRMZXZlbDogJ0dhbWUnXHJcbn1cclxuXHJcbmdhbWUuc3RhdGUuYWRkKCdCb290JywgcmVxdWlyZSgnLi9zdGF0ZXMvYm9vdCcpKTtcclxuZ2FtZS5zdGF0ZS5hZGQoJ1NwbGFzaCcsIHJlcXVpcmUoJy4vc3RhdGVzL3NwbGFzaCcpKTtcclxuZ2FtZS5zdGF0ZS5hZGQoJ1ByZWxvYWRlcicsIHJlcXVpcmUoJy4vc3RhdGVzL3ByZWxvYWRlcicpKTtcclxuZ2FtZS5zdGF0ZS5hZGQoJ01lbnUnLCByZXF1aXJlKCcuL3N0YXRlcy9tZW51JykpO1xyXG5nYW1lLnN0YXRlLmFkZCgnR2FtZScsIHJlcXVpcmUoJy4vc3RhdGVzL2dhbWUnKSk7XHJcblxyXG5nYW1lLnN0YXRlLnN0YXJ0KCdCb290Jyk7XHJcblxyXG4vL2dhbWUuc3RhZ2UuYmFja2dyb3VuZENvbG9yID0gXCIjZmZmZmZmXCI7XHJcbiIsInZhciBCb290ID0gZnVuY3Rpb24gKCkge307XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEJvb3Q7XHJcblxyXG5Cb290LnByb3RvdHlwZSA9IHtcclxuXHJcbiAgcHJlbG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5sb2FkLmltYWdlKCdwcmVsb2FkZXInLCAnYXNzZXRzL3ByZWxvYWRlci5naWYnKTtcclxuICB9LFxyXG5cclxuICBjcmVhdGU6IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMuZ2FtZS5pbnB1dC5tYXhQb2ludGVycyA9IDE7XHJcblxyXG4gICAgaWYgKHRoaXMuZ2FtZS5kZXZpY2UuZGVza3RvcCkge1xyXG4gICAgICB0aGlzLmdhbWUuc3RhZ2Uuc2NhbGUucGFnZUFsaWduSG9yaXpvbnRhbGx5ID0gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuZ2FtZS5zY2FsZS5zY2FsZU1vZGUgPSBQaGFzZXIuU2NhbGVNYW5hZ2VyLlNIT1dfQUxMO1xyXG4gICAgICB0aGlzLmdhbWUuc2NhbGUubWluV2lkdGggPSAgNDgwO1xyXG4gICAgICB0aGlzLmdhbWUuc2NhbGUubWluSGVpZ2h0ID0gMjYwO1xyXG4gICAgICB0aGlzLmdhbWUuc2NhbGUubWF4V2lkdGggPSA2NDA7XHJcbiAgICAgIHRoaXMuZ2FtZS5zY2FsZS5tYXhIZWlnaHQgPSA0ODA7XHJcbiAgICAgIHRoaXMuZ2FtZS5zY2FsZS5mb3JjZUxhbmRzY2FwZSA9IHRydWU7XHJcbiAgICAgIHRoaXMuZ2FtZS5zY2FsZS5wYWdlQWxpZ25Ib3Jpem9udGFsbHkgPSB0cnVlO1xyXG4gICAgICB0aGlzLmdhbWUuc2NhbGUuc2V0U2NyZWVuU2l6ZSh0cnVlKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQoJ1ByZWxvYWRlcicpO1xyXG4gIH1cclxufTtcclxuIiwidmFyIFBsYXllciA9IHJlcXVpcmUoJy4uL2VudGl0aWVzL3BsYXllcicpO1xyXG52YXIgQmFja2dyb3VuZF9NYW5hZ2VyID0gcmVxdWlyZSgnLi4vZW50aXRpZXMvYmFja2dyb3VuZF9tYW5hZ2VyJyk7XHJcbnZhciBQZXJzb24gPSByZXF1aXJlKCcuLi9lbnRpdGllcy9wZXJzb24nKTtcclxudmFyIEdyb3VwID0gcmVxdWlyZSgnLi4vZW50aXRpZXMvZ3JvdXAnKTtcclxudmFyIEdyb3VwTWFuYWdlciA9IHJlcXVpcmUoJy4uL2VudGl0aWVzL2dyb3VwTWFuYWdlcicpO1xyXG52YXIgVUlCdWlsZGVyID0gcmVxdWlyZSgnLi4vZW50aXRpZXMvdWlCdWlsZGVyJyk7XHJcblxyXG52YXIgR2FtZSA9IGZ1bmN0aW9uICgpIHtcclxuICB0aGlzLnRlc3RlbnRpdHkgPSBudWxsO1xyXG4gIC8vdGhpcy5mbG9ja3MgPSBbXTtcclxuICB0aGlzLmJnX21nID0gbnVsbDtcclxuICAvLyB0aGlzLnNlbGVjdGVkR3JvdXAgPSBudWxsO1xyXG4gIHRoaXMubW9uZXkgPSBudWxsO1xyXG4gIHRoaXMubW9uZXlWYWwgPSAwO1xyXG4gIHRoaXMuY3VyTW9uZXkgPSAwO1xyXG4gIHRoaXMubW9uZXlVcGRhdGVEZWxheSA9IDAuMDAxO1xyXG4gIHRoaXMubW9uZXlJbmNyZW1lbnRpbmcgPSBmYWxzZTtcclxuICB0aGlzLmhhcHBpbmVzc1ZhbCA9IDA7XHJcbiAgdGhpcy5jdXJIYXBwaW5lc3MgPSAwO1xyXG4gIHRoaXMuaGFwcGluZXNzVXBkYXRlRGVsYXkgPSAwLjAwMTtcclxuICB0aGlzLmhhcHBpbmVzc0luY3JlbWVudGluZyA9IGZhbHNlO1xyXG4gIHRoaXMudGF4VGltZSA9IDM7XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEdhbWU7XHJcblxyXG5HYW1lLnByb3RvdHlwZSA9IHtcclxuXHJcbiAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XHJcblx0ICAvLyBjb25zb2xlLmxvZyh0aGlzKTtcclxuXHR0aGlzLmdhbWUuc3RhZ2UuYmFja2dyb3VuZENvbG9yID0gXCIjZmZmZmZmXCI7XHJcblx0ICBcclxuICAgIHZhciB4ID0gKHRoaXMuZ2FtZS53aWR0aCAvIDIpIC0gMTAwO1xyXG4gICAgdmFyIHkgPSAodGhpcy5nYW1lLmhlaWdodCAvIDIpIC0gNTA7XHJcblxyXG4gICAgdGhpcy5iZ19tZyA9IG5ldyBCYWNrZ3JvdW5kX01hbmFnZXIodGhpcy5nYW1lLCB0aGlzKTtcclxuXHRcclxuICAgIHRoaXMuaW5wdXQub25Eb3duLmFkZCh0aGlzLm9uSW5wdXREb3duLCB0aGlzKTtcclxuXHRcclxuXHR0aGlzLm1vbmV5ID0gdGhpcy5nYW1lLmFkZC50ZXh0KDEwLCAxMCwgJyQwJyk7XHJcblx0dGhpcy5tb25leS5mb250ID0gJ1ZUMzIzJztcclxuXHR0aGlzLm1vbmV5LmZvbnRTaXplID0gMjQ7XHJcblx0dGhpcy5tb25leS5maWxsID0gJyNmZmZmZmYnO1xyXG4gICAgdGhpcy5tb25leS5zZXRTaGFkb3coMywgMywgJ3JnYmEoMCwwLDAsMC41KScsIDUpO1xyXG5cdFxyXG5cdHRoaXMudWliID0gbmV3IFVJQnVpbGRlcih0aGlzKTtcclxuXHR0aGlzLmJhciA9IHRoaXMudWliLmJ1aWxkUHJvZ3Jlc3NCYXIoXCJncm93aW5nXCIsIHRoaXMuZ2FtZS53aWR0aCAvIDIsIDI1LCAzMDAsIDI1LCAxMDApO1xyXG5cdC8vdGhpcy5iYXIuYWRkVmFsdWUoMTAwKTtcclxuXHR0aGlzLmhhcHB5ID0gdGhpcy5nYW1lLmFkZC5zcHJpdGUodGhpcy5nYW1lLndpZHRoICogLjczLCAyNSwgJ2hhcHB5ZmFjZScpO1xyXG5cdHRoaXMuaGFwcHkud2lkdGggPSA0MDtcclxuXHR0aGlzLmhhcHB5LmhlaWdodCA9IDQwO1xyXG5cdHRoaXMuaGFwcHkuYW5jaG9yLnNldFRvKDAuNSwgMC41KTtcclxuXHRcclxuXHR0aGlzLmdhbWUudGltZS5ldmVudHMuYWRkKFBoYXNlci5UaW1lci5TRUNPTkQgKiB0aGlzLnRheFRpbWUsIHRoaXMuY29sbGVjdFRheCwgdGhpcyk7XHJcbiAgfSxcclxuXHJcbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XHJcblx0dGhpcy5iZ19tZy51cGRhdGUoKTtcclxuXHQvL3RoaXMuZ20udXBkYXRlKCk7XHJcblx0dGhpcy51aWIucmVuZGVyKCk7XHJcblx0dmFyIGhhcHBpbmVzcyA9IDA7XHJcblx0ICBmb3IgKHZhciBiZyBpbiB0aGlzLmJnX21nLmJnQXJyYXkpIHtcclxuXHRcdCAgZm9yICh2YXIgZ3JvdXAgaW4gdGhpcy5iZ19tZy5iZ0FycmF5W2JnXS5ncm91cF9tYW5hZ2VyLm1lbWJlcnMpIHtcclxuXHRcdFx0ICBmb3IgKHZhciBwZXJzb24gaW4gdGhpcy5iZ19tZy5iZ0FycmF5W2JnXS5ncm91cF9tYW5hZ2VyLm1lbWJlcnNbZ3JvdXBdLm1lbWJlcnMpIHtcclxuXHRcdFx0XHQgIGhhcHBpbmVzcyArPSB0aGlzLmJnX21nLmJnQXJyYXlbYmddLmdyb3VwX21hbmFnZXIubWVtYmVyc1tncm91cF0ubWVtYmVyc1twZXJzb25dLmhhcHBpbmVzcztcclxuXHRcdFx0ICB9XHJcblx0XHQgIH1cclxuXHQgIH1cclxuXHQgIGhhcHBpbmVzcyAvPSB0aGlzLmJnX21nLm51bVBlb3BsZSgpO1xyXG5cdCAgLy8gY29uc29sZS5sb2coaGFwcGluZXNzKTtcclxuXHQgIHRoaXMuc2V0SGFwcGluZXNzKGhhcHBpbmVzcyk7XHJcbiAgfSxcclxuXHJcbiAgb25JbnB1dERvd246IGZ1bmN0aW9uICgpIHtcclxuXHQgLy8gY29uc29sZS5sb2codGhpcy5nYW1lLndpZHRoLCB0aGlzLmdhbWUuaGVpZ2h0KTtcclxuICB9LFxyXG4gIGNvbGxlY3RUYXg6IGZ1bmN0aW9uICgpIHtcclxuXHQgIC8vIGNvbnNvbGUubG9nKCdjb2xsZWN0IHRheCcpO1xyXG5cdCAgdmFyIHRheGVzID0gMDtcclxuXHQgIGZvciAodmFyIGJnIGluIHRoaXMuYmdfbWcuYmdBcnJheSkge1xyXG5cdFx0ICBmb3IgKHZhciBncm91cCBpbiB0aGlzLmJnX21nLmJnQXJyYXlbYmddLmdyb3VwX21hbmFnZXIubWVtYmVycykge1xyXG5cdFx0XHQgIGZvciAodmFyIHBlcnNvbiBpbiB0aGlzLmJnX21nLmJnQXJyYXlbYmddLmdyb3VwX21hbmFnZXIubWVtYmVyc1tncm91cF0ubWVtYmVycykge1xyXG5cdFx0XHRcdCAgdGF4ZXMgKz0gdGhpcy5iZ19tZy5iZ0FycmF5W2JnXS5ncm91cF9tYW5hZ2VyLm1lbWJlcnNbZ3JvdXBdLm1lbWJlcnNbcGVyc29uXS5nZXRUYXgoKTtcclxuXHRcdFx0ICB9XHJcblx0XHQgIH1cclxuXHQgIH1cclxuXHQgIHRoaXMuYWRkTW9uZXkodGF4ZXMpO1xyXG5cdCAgdGhpcy5nYW1lLnRpbWUuZXZlbnRzLmFkZChQaGFzZXIuVGltZXIuU0VDT05EICogdGhpcy50YXhUaW1lLCB0aGlzLmNvbGxlY3RUYXgsIHRoaXMpO1xyXG4gIH0sXHJcbiAgc2V0SGFwcGluZXNzOiBmdW5jdGlvbiAoYW10KSB7XHJcblx0ICB0aGlzLmN1ckhhcHBpbmVzcyA9IGFtdDtcclxuXHQgIGlmICghdGhpcy5oYXBwaW5lc3NJbmNyZW1lbnRpbmcpIHtcclxuXHRcdCAgdGhpcy5nYW1lLnRpbWUuZXZlbnRzLmFkZChQaGFzZXIuVGltZXIuU0VDT05EICogdGhpcy5oYXBwaW5lc3NVcGRhdGVEZWxheSwgdGhpcy5pbmNyZW1lbnRIYXBwaW5lc3MsIHRoaXMpO1xyXG5cdFx0ICB0aGlzLmhhcHBpbmVzc0luY3JlbWVudGluZyA9IHRydWU7XHJcblx0ICB9XHJcbiAgfSxcclxuICBpbmNyZW1lbnRIYXBwaW5lc3M6IGZ1bmN0aW9uICgpIHtcclxuXHRpZiAodGhpcy5oYXBwaW5lc3NWYWwgPT09IHRoaXMuY3VySGFwcGluZXNzKSB7XHJcblx0XHR0aGlzLmhhcHBpbmVzc0luY3JlbWVudGluZyA9IGZhbHNlO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHRpZiAodGhpcy5jdXJIYXBwaW5lc3MgPiB0aGlzLmhhcHBpbmVzc1ZhbCkge1xyXG5cdFx0dGhpcy5iYXIuYWRkVmFsdWUoMSk7XHJcblx0XHR0aGlzLmhhcHBpbmVzc1ZhbCArPSAxO1xyXG5cdH0gZWxzZSBpZiAodGhpcy5jdXJIYXBwaW5lc3MgPCB0aGlzLmhhcHBpbmVzc1ZhbCkge1xyXG5cdFx0dGhpcy5iYXIuYWRkVmFsdWUoLTEpO1xyXG5cdFx0dGhpcy5oYXBwaW5lc3NWYWwgLT0gMTtcclxuXHR9XHJcblx0dGhpcy5nYW1lLnRpbWUuZXZlbnRzLmFkZChQaGFzZXIuVGltZXIuU0VDT05EICogdGhpcy5oYXBwaW5lc3NVcGRhdGVEZWxheSwgdGhpcy5pbmNyZW1lbnRIYXBwaW5lc3MsIHRoaXMpO1xyXG4gIH0sXHJcbiAgYWRkTW9uZXk6IGZ1bmN0aW9uIChhbXQpIHtcclxuXHQgIHRoaXMuY3VyTW9uZXkgKz0gYW10O1xyXG5cdCAgLy90aGlzLm1vbmV5LnRleHQgPSAnJCcgKyBuZXdNb25leTtcclxuXHQgIGlmICghdGhpcy5tb25leUluY3JlbWVudGluZykge1xyXG5cdFx0dGhpcy5nYW1lLnRpbWUuZXZlbnRzLmFkZChQaGFzZXIuVGltZXIuU0VDT05EICogdGhpcy5tb25leVVwZGF0ZURlbGF5LCB0aGlzLmluY3JlbWVudE1vbmV5LCB0aGlzKTtcclxuXHRcdHRoaXMubW9uZXlJbmNyZW1lbnRpbmcgPSB0cnVlO1xyXG5cdCAgfVxyXG4gIH0sXHJcbiAgaW5jcmVtZW50TW9uZXk6IGZ1bmN0aW9uICgpIHtcclxuXHRpZiAodGhpcy5tb25leVZhbCA9PT0gdGhpcy5jdXJNb25leSkge1xyXG5cdFx0dGhpcy5tb25leUluY3JlbWVudGluZyA9IGZhbHNlO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHRpZiAodGhpcy5jdXJNb25leSA+IHRoaXMubW9uZXlWYWwpIHtcclxuXHRcdHRoaXMubW9uZXlWYWwgKz0gMTtcclxuXHR9IGVsc2UgaWYgKHRoaXMuY3VyTW9uZXkgPCB0aGlzLm1vbmV5VmFsKSB7XHJcblx0XHR0aGlzLm1vbmV5VmFsIC09IDE7XHJcblx0fVxyXG5cdHRoaXMubW9uZXkudGV4dCA9ICckJyArIHRoaXMubW9uZXlWYWw7XHJcblx0dGhpcy5nYW1lLnRpbWUuZXZlbnRzLmFkZChQaGFzZXIuVGltZXIuU0VDT05EICogdGhpcy5tb25leVVwZGF0ZURlbGF5LCB0aGlzLmluY3JlbWVudE1vbmV5LCB0aGlzKTtcclxuICB9XHJcbn07XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4iLCJ2YXIgTWVudSA9IGZ1bmN0aW9uICgpIHtcclxuICB0aGlzLnRleHQgPSBudWxsO1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBNZW51O1xyXG5cclxuTWVudS5wcm90b3R5cGUgPSB7XHJcblxyXG4gIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHggPSB0aGlzLmdhbWUud2lkdGggLyAyO1xyXG4gICAgdmFyIHkgPSB0aGlzLmdhbWUuaGVpZ2h0IC8gMjtcclxuXHJcbiAgICB2YXIgc3R5bGUgPSB7IGZvbnQ6IFwiNjVweCBBcmlhbFwiLCBmaWxsOiBcIiNmZmZmZmZcIiwgYWxpZ246IFwiY2VudGVyXCIgfTtcclxuXHJcbiAgICB0aGlzLnRleHQgPSB0aGlzLmFkZC50ZXh0KHggLSAzMDAsIHkgLSAyMDAsIFwiUHJlc3MgdG8gU3RhcnRcIiwgc3R5bGUpO1xyXG5cclxuICAgIHRoaXMuaW5wdXQub25Eb3duLmFkZCh0aGlzLm9uRG93biwgdGhpcyk7XHJcbiAgfSxcclxuXHJcbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgfSxcclxuXHJcbiAgb25Eb3duOiBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQocGxheWVyU3RhdGUuY3VycmVudExldmVsKTtcclxuICB9XHJcbn07XHJcbiIsInZhciBQcmVsb2FkZXIgPSBmdW5jdGlvbiAoZ2FtZSkge1xyXG4gIHRoaXMuYXNzZXQgPSBudWxsO1xyXG4gIHRoaXMucmVhZHkgPSBmYWxzZTtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gUHJlbG9hZGVyO1xyXG5cclxuUHJlbG9hZGVyLnByb3RvdHlwZSA9IHtcclxuXHJcbiAgcHJlbG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5hc3NldCA9IHRoaXMuYWRkLnNwcml0ZSgzMjAsIDI0MCwgJ3ByZWxvYWRlcicpO1xyXG4gICAgdGhpcy5hc3NldC5hbmNob3Iuc2V0VG8oMC41LCAwLjUpO1xyXG5cclxuICAgIHRoaXMubG9hZC5vbkxvYWRDb21wbGV0ZS5hZGRPbmNlKHRoaXMub25Mb2FkQ29tcGxldGUsIHRoaXMpO1xyXG4gICAgdGhpcy5sb2FkLnNldFByZWxvYWRTcHJpdGUodGhpcy5hc3NldCk7XHJcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ3Rlc3RzcHJpdGUnLCAnYXNzZXRzL3Rlc3QucG5nJyk7XHJcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ2JhY2tncm91bmQnLCAnYXNzZXRzL3NlY3RvckJHLnBuZycpXHJcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ3BlcnNvbicsICdhc3NldHMvcGVyc29uLnBuZycpO1xyXG4gICAgdGhpcy5sb2FkLmltYWdlKCdzZWxlY3Rpb24nLCAnYXNzZXRzL3NlbGVjdGlvbi5wbmcnKTtcclxuICAgIHRoaXMubG9hZC5pbWFnZSgnYm9vaycsICdhc3NldHMvYm9vay5wbmcnKTtcclxuICAgIC8vIHRoaXMubG9hZC5pbWFnZSgnaGFwcHlmYWNlJywgJ2Fzc2V0cy9oYXBweWZhY2UucG5nJyk7XHJcbiAgICAvLyB0aGlzLmxvYWQuaW1hZ2UoJ3NhZGZhY2UnLCAnYXNzZXRzL3NhZGZhY2UucG5nJyk7XHJcblx0dGhpcy5sb2FkLmltYWdlKCdoYXBweWZhY2UnLCAnYXNzZXRzL2hhcHB5ZmFjZV9iZXR0ZXIucG5nJyk7XHJcblx0dGhpcy5sb2FkLnNjcmlwdCgnd2ViZm9udCcsICcvL2FqYXguZ29vZ2xlYXBpcy5jb20vYWpheC9saWJzL3dlYmZvbnQvMS40Ljcvd2ViZm9udC5qcycpO1xyXG4gIH0sXHJcblxyXG4gIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5hc3NldC5jcm9wRW5hYmxlZCA9IGZhbHNlO1xyXG4gIH0sXHJcblxyXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgaWYgKCEhdGhpcy5yZWFkeSkge1xyXG4gICAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQoJ0dhbWUnKTtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICBvbkxvYWRDb21wbGV0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5yZWFkeSA9IHRydWU7XHJcbiAgfVxyXG59O1xyXG4iLCJ2YXIgU3BsYXNoID0gZnVuY3Rpb24gKCkge1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBTcGxhc2g7XHJcblxyXG5TcGxhc2gucHJvdG90eXBlID0ge1xyXG4gIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xyXG4gIH1cclxufTsiLCJ2YXIgVXRpbHMgPSB7XHJcbiAgICBjb250YWluc09iamVjdDogZnVuY3Rpb24ob2JqLCBsaXN0KSB7XHJcbiAgICAgICAgdmFyIGk7XHJcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKGxpc3RbaV0gPT09IG9iaikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0sXHJcblx0aHlwb3RlbnVzZTogZnVuY3Rpb24oYSwgYikge1xyXG5cdFx0cmV0dXJuIE1hdGguc3FydChNYXRoLnBvdyhhLCAyKSArIE1hdGgucG93KGIsIDIpKTtcclxuXHR9LFxyXG5cdHJhdGlvOiBmdW5jdGlvbihhLCBiLCBjKSB7XHJcblx0XHRpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSkge1xyXG5cdFx0XHRyZXR1cm4gW2EgLyBhXTtcclxuXHRcdH1cclxuXHRcdGVsc2UgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIHtcclxuXHRcdFx0cmV0dXJuIFthIC8gKGEgKyBiKSwgYiAvIChhICsgYildO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMykge1xyXG5cdFx0XHRyZXR1cm4gW2EgLyAoYSArIGIgKyBjKSwgYiAvIChhICsgYiArIGMpLCBjIC8gKGEgKyBiICsgYyldO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdHJldHVybiBbXTtcclxuXHRcdH1cclxuXHR9XHJcbn07XHJcblxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBVdGlsczsiXX0=
