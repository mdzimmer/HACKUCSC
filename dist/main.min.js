(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"C:\\HACKUCSC\\src\\js\\entities\\ProgressBar.js":[function(require,module,exports){
//NOTE: DON'T USE this code to create a ProgressBar. Instead, use the UIBuilder object and call buildProgressBar

var ProgressBar = function(setType, setMaxValue, setGraphics, setRenderables) {
	this.type = setType; //Two types, "growing" (starts at 0, triggers event when full) 
						 //and "shrinking" (starts full, triggers at 0)
	this.bgBorderSize = 2;			//default size of background border
	this.bgBorderColor = 0xAAAAAA;	//default color of background border
	this.bgColor = 0x888888;		//default color of background
	this.paddingHoriz = 5;			//default sum of padding on left and right side inner value bar
	this.paddingVert = 5;			//default sum (i.e. half on each side) of vertical padding of inner value bar
	this.valueBorderSize = 1;		//default size of value border
	this.valueBorderColor = 0x8888FF; //default color of value border
	this.valueColor = 0x000099;		//default color of inner value bar
	this.x = null;
	this.y = null;
	this.width = null;
	this.height = null;
	this.maxValue = setMaxValue;
	this.graphics = setGraphics; //store graphics class (used to draw bar)
	this.renderables = setRenderables;
	
	this.onEvent = function() {}; //overwrite this function to make whatever you want happen when progressBar reaches limit
	
	//switch(this.type) {
	//case 'growing' : 
	if(setType === 'growing') {
		this.value = 0;
		//tryTrigger is called automatically when you add/subtract value, and will trigger the onEvent() function
		this.tryTrigger = function() {
			if(this.value >= this.maxValue) {
				this.onEvent();
			}
		};
		//break;
	}
	else if(setType === 'shrinking') {
	//case 'shrinking' :
		this.value = this.maxValue;
		this.tryTrigger = function() {
			if(this.value <= 0) {
				this.onEvent();
			}
		};
	}
};

ProgressBar.prototype.constructor = ProgressBar;

ProgressBar.prototype.destroy = function() {
	this.graphics.clear();
	this.renderables.unsubscribe(this);
};

//To subtract value, just use negative numbers as argument i.e. foo.addValue(-5);
ProgressBar.prototype.addValue = function (addThis) {
	this.value += addThis;
	if(this.value > this.maxValue) {
		this.value = this.maxValue;
	}
	if(this.value < 0) {
		this.value = 0;
	}
	this.tryTrigger();
};

//Sets the location where progress bar is rendered
ProgressBar.prototype.setLocation = function(setX, setY) {
	this.x = setX;
	this.y = setY;
};

//Sets the size of the progress bar
ProgressBar.prototype.setSize = function(setWidth, setHeight) {
	this.width = setWidth;
	this.height = setHeight;
};

ProgressBar.prototype.setStyle = function(bgBorderSize, bgBorderColor, bgColor, paddingHoriz, paddingVert, valueBorderSize, valueBorderColor, valueColor) {
	this.bgBorderSize = bgBorderSize;
	this.bgBorderColor = bgBorderColor;
	this.bgColor = bgColor;
	this.paddingHoriz = paddingHoriz;
	this.paddingVert = paddingVert;
	this.valueBorderSize = valueBorderSize;
	this.valueBorderColor = valueBorderColor;
	this.valueColor = valueColor;
};

//update for progress bar, called just before drawing progress bar
//Overwrite this function if desired
ProgressBar.prototype.update = function() {};

//Renders progressBar
ProgressBar.prototype.render = function() {
	this.update();
	this.graphics.clear();
	//Draw background of bar
	this.graphics.lineStyle(this.bgBorderSize, this.bgBorderColor, 1); //sets border color and size
	this.graphics.beginFill(this.bgColor); //sets color of background fill
	this.graphics.drawRect(this.x-this.width/2, this.y-this.height/2, this.width, this.height);
	this.graphics.endFill();
	//Draw value of bar
	var percentage = this.value / this.maxValue;
	var barWidth = this.width - this.paddingHoriz;
	var barHeight = this.height - this.paddingVert;
	this.graphics.lineStyle(this.valueBorderSize, this.valueBorderColor, 1);
	this.graphics.beginFill(this.valueColor);
	this.graphics.drawRect(this.x-(barWidth/2), this.y-(barHeight/2), barWidth*percentage, barHeight);
	this.graphics.endFill();
};

module.exports = ProgressBar;
},{}],"C:\\HACKUCSC\\src\\js\\entities\\background.js":[function(require,module,exports){
var Group_Manager = require('./groupManager');


var Background = function (game, baseX, baseY, hRatio, vRatio, income, type, state) {
    Phaser.Sprite.call(this, game, baseX * hRatio * game.width, baseY * vRatio * game.height, 'background');
    game.add.existing(this);
    this.hRatio = hRatio;
    this.vRatio = vRatio;
    this.newHRatio = hRatio;
    this.newVRatio = vRatio;
    this.group_manager = new Group_Manager(this.game, state);
	this.group_manager.background = this;
   	this.type = type;
    this.incomeLevel = income;
	this.state = state
};

Background.prototype = Object.create(Phaser.Sprite.prototype);
Background.prototype.constructor = Background;

Background.prototype.getVars = function() {
    //return x & y and width & height of visible
    return [this.x, this.y, this.hRatio * this.game.width, this.vRatio * this.game.height];
};

Background.prototype.getVarsCenter = function() {
    // //return x & y of center and width & height of visible
    var visWidth = this.hRatio * this.game.width;
    var visHeight = this.vRatio * this.game.height;
    return {width : visWidth, height : visHeight, center : {x : this.x + visWidth / 2, y : this.y + visHeight / 2}};
};

Background.prototype.update = function() {
    if (this.hRatio !== this.newHRatio) {
        if (this.hRatio + .1 < this.newHRatio) this.hRatio += .1;
        else if (this.hRatio - .1 > this.newHRatio) this.hRatio -= .1;
        else this.hRatio = this.newHRatio;
    }
    if (this.vRatio !== this.newVRatio) {
        if (this.vRatio + .1 < this.newVRatio) this.vRatio += .1;
        else if (this.vRatio - .1 > this.newVRatio) this.vRatio -= .1;
        else this.vRatio = this.newVRatio;
    }
	this.group_manager.update();
};



module.exports = Background;
},{"./groupManager":"C:\\HACKUCSC\\src\\js\\entities\\groupManager.js"}],"C:\\HACKUCSC\\src\\js\\entities\\background_manager.js":[function(require,module,exports){
//Controls background elements

var Background = require('./background');
var Person = require('./person');
var util = require('../utils');

var Group = require('./group');

var Background_Manager = function(game, state) {
	this.game = game;
	this.state = state;

	//Create array of backgrounds
	this.bgArray = [
		new Background(this.game, 0, 0, .33, .33, Person.EDULEVEL.low , 'work' , state),	// this.bgArray[0] == workLow
		new Background(this.game, 1, 0, .33, .33, Person.EDULEVEL.mid , 'work' , state),	// this.bgArray[1] == workMid
		new Background(this.game, 2, 0, .33, .33, Person.EDULEVEL.high, 'work' , state),	// this.bgArray[2] == workMid
		new Background(this.game, 0, 1, .33, .33, Person.EDULEVEL.low , 'house', state),	// this.bgArray[3] == houseLow
		new Background(this.game, 1, 1, .33, .33, Person.EDULEVEL.mid , 'house', state),	// this.bgArray[4] == houseMid
		new Background(this.game, 2, 1, .33, .33, Person.EDULEVEL.high, 'house', state),	// this.bgArray[5] == houseMid
		new Background(this.game, 0, 2,   1, .33, '',              'unemployed', state),	// this.bgArray[6] == unemployed
	];
	for (bg in this.bgArray) {
		this.bgArray[bg].myManager = this;
	}
	
	for (var i in this.bgArray) {
		if (this.bgArray[i].type == 'work') {
			if (this.bgArray[i].incomeLevel === Person.EDULEVEL.low) {
				this.bgArray[i].tint = 0xe2402b;
			}
			else if (this.bgArray[i].incomeLevel === Person.EDULEVEL.mid) {
				this.bgArray[i].tint = 0x56e22b;
			}
			else if (this.bgArray[i].incomeLevel === Person.EDULEVEL.high) {
				this.bgArray[i].tint = 0x2b59e2;
			}
		}
		else if (this.bgArray[i].type == 'house') {
			if (this.bgArray[i].incomeLevel === Person.EDULEVEL.low) {
				this.bgArray[i].tint = 0xe55340;
			}
			else if (this.bgArray[i].incomeLevel === Person.EDULEVEL.mid) {
				this.bgArray[i].tint = 0x6ae246;
			}
			else if (this.bgArray[i].incomeLevel === Person.EDULEVEL.high) {
				this.bgArray[i].tint = 0x5476dd;
			}
		}
		else { // Unemployed background
			this.bgArray[i].tint = 0x939393;
		}
	}
	
	var test = this.bgArray[0].group_manager;
	var testFlock = new Group(this.game, this.game.width / 2 + 100, this.game.height / 2 + 100, state);
    for (var i = 0; i < 10; i++) {
    	var testPerson = new Person(this.game, this.game.width / 2 + i * 15, this.game.height / 2 + i * 15, i);
    	this.game.add.existing(testPerson);
    	testFlock.addMember(testPerson);
    }
    test.addMember(testFlock);
	// testFlock = new Group(this.game, this.game.width / 2 - 100, this.game.height / 2 + 100, state);
	// for (var i = 0; i < 10; i++) {
    	// var testPerson = new Person(this.game, this.game.width / 2 + i * 15 - 100, this.game.height / 2 + i * 15 + 100, i);
    	// this.game.add.existing(testPerson);
    	// testFlock.addMember(testPerson);
    // }
    // test.addMember(testFlock);
	
};

Background_Manager.prototype.constructor = Background_Manager;

/*Background_Manager.BGNAMES = {
		workLow    : this.bgArray[0],
		workMid    : this.bgArray[1],
		workHigh   : this.bgArray[2],
		houseLow   : this.bgArray[3],
		houseMid   : this.bgArray[4],
		houseHigh  : this.bgArray[5],
		unemployed : this.bgArray[6]
};*/

Background_Manager.prototype.sendTo = function(source, destination, group) {
	if (this.canTransfer(source, destination, group)) {	// Check if they can transfer up
		source.group_manager.transfer(destination.group_manager, group);
		this.updateRatios();
	}
};

Background_Manager.prototype.canTransfer = function(source, destination, group) {
	if (source === null || destination === null) return false;
	var sourceEdu = group.members[0].eduLevel;
	if (destination.type === 'unemployed') {
		return true;
	}
	if (sourceEdu === Person.EDULEVEL.unemployed) {
		if (destination.incomeLevel === Person.EDULEVEL.low && destination.type === 'house') {
			return true;
		}
	} else if (sourceEdu === Person.EDULEVEL.low) {
		if (destination.incomeLevel === Person.EDULEVEL.low) {
			return true;
		} else if (destination.incomeLevel === Person.EDULEVEL.mid) {
			if (destination.type === 'house') {
				return true;
			}
		}
	} else if (sourceEdu === Person.EDULEVEL.mid) {
		if (destination.incomeLevel === Person.EDULEVEL.low) {
			return true;
		} else if (destination.incomeLevel === Person.EDULEVEL.mid) {
			return true;
		} else if (destination.incomeLevel === Person.EDULEVEL.high) {
			if (destination.type === 'house') {
				return true;
			}
		}
	} else if (sourceEdu === Person.EDULEVEL.high) {
		return true;
	}
	return false;
};

Background_Manager.prototype.whereClicked = function() {
	for (var i in this.bgArray) {
		var curDimensions = this.bgArray[i].getVars();
		var mouseX = this.game.input.x;
		var mouseY = this.game.input.y;
		if (mouseX > curDimensions[0] && mouseX <= curDimensions[0] + curDimensions[2]) {
			if (mouseY > curDimensions[1] && mouseY <= curDimensions[1] + curDimensions[3]) {
				return this.bgArray[i];
			}
		}
	}
	return null;
};

Background_Manager.prototype.findOther = function(source, destination) {
	if (source.type === 'work' && destination.type === 'work') {
		if (source.incomeLevel === Person.EDULEVEL.low) {
			if (destination.incomeLevel === Person.EDULEVEL.mid) return this.bgArray[2];
			else if (destination.incomeLevel === Person.EDULEVEL.high) return this.bgArray[1];
		}
		else if (source.incomeLevel === Person.EDULEVEL.mid) {
			if (destination.incomeLevel === Person.EDULEVEL.low) return this.bgArray[2];
			else if (destination.incomeLevel === Person.EDULEVEL.high) return this.bgArray[0];
		}
		else if (source.incomeLevel === Person.EDULEVEL.high) {
			if (destination.incomeLevel === Person.EDULEVEL.low) return this.bgArray[1];
			else if (destination.incomeLevel === Person.EDULEVEL.mid) return this.bgArray[0];
		}
	}
	else if (source.type === 'house' && destination.type === 'house') {
		if (source.incomeLevel === Person.EDULEVEL.low) {
			if (destination.incomeLevel === Person.EDULEVEL.mid) return this.bgArray[5];
			else if (destination.incomeLevel === Person.EDULEVEL.high) return this.bgArray[4];
		}
		else if (source.incomeLevel === Person.EDULEVEL.mid) {
			if (destination.incomeLevel === Person.EDULEVEL.low) return this.bgArray[5];
			else if (destination.incomeLevel === Person.EDULEVEL.high) return this.bgArray[3];
		}
		else if (source.incomeLevel === Person.EDULEVEL.high) {
			if (destination.incomeLevel === Person.EDULEVEL.low) return this.bgArray[4];
			else if (destination.incomeLevel === Person.EDULEVEL.mid) return this.bgArray[3];
		}
	}
};

Background_Manager.prototype.updateRatios = function() {
	var hWorkRatios = util.ratio(this.bgArray[0].group_manager.numPeople(), this.bgArray[1].group_manager.numPeople(), this.bgArray[2].group_manager.numPeople());
	var hHouseRatios = util.ratio(this.bgArray[3].group_manager.numPeople(), this.bgArray[4].group_manager.numPeople(), this.bgArray[5].group_manager.numPeople());
	var employed = 0;
	for (var j = 0; j < 6; j++)
		employed += this.bgArray[j].group_manager.numPeople();
	var vRatios = util.ratio(this.bgArray[6].group_manager.numPeople(), employed);
	console.log('this.bgArray[0].group_manager.numPeople(): ' + this.bgArray[0].group_manager.numPeople());
	console.log('hWorkRatios: ' + hWorkRatios);

	for (var i = 0 in this.bgArray) {
		if (i !== 6) {		// If not unemployed bg
			if (i < 3) {	// If work bg
				this.bgArray[i].newHRatio = hWorkRatios[i];
				this.bgArray[i].newVRatio = vRatios[1] / 2;
			}
			else {			// If house bg
				this.bgArray[i].newHRatio = hHouseRatios[i - 3];
				this.bgArray[i].newVRatio = vRatios[1] / 2;
			}
		}
		else bgArray[i].newVRatio = vRatios[0]; // Unemployed bg
	}
};

Background_Manager.prototype.getDimensions = function(background) {

};

Background_Manager.prototype.update = function() {
	for (var i in this.bgArray) {
		this.bgArray[i].update();
	}
};

module.exports = Background_Manager;
},{"../utils":"C:\\HACKUCSC\\src\\js\\utils.js","./background":"C:\\HACKUCSC\\src\\js\\entities\\background.js","./group":"C:\\HACKUCSC\\src\\js\\entities\\group.js","./person":"C:\\HACKUCSC\\src\\js\\entities\\person.js"}],"C:\\HACKUCSC\\src\\js\\entities\\group.js":[function(require,module,exports){
//controls flocking for a group of person objects
var util = require('../utils');

var Group = function (game, centerX, centerY, state) {
	this.game = game;
	this.members = [];
	this.minDist = 20;
	//this.noise = 10;
	this.center = {x : centerX, y : centerY};
	this.clickDist = 50;
	this.selected = false;
	this.selection = this.game.add.sprite(this.center.x, this.center.y, 'selection');
	this.selection.anchor.setTo(0.5, 0.5);
	this.selection.width = 100;
	this.selection.height = 100;
	this.selection.visible = false;
	this.velocity = {x : 0, y : 0};
	this.speed = .05;
	this.state = state;
	
	this.state.input.onDown.add(this.onInputDown, this);
}
Group.prototype.constructor = Group;
Group.prototype.update = function() {
	//update center
	var newX = this.center.x + this.velocity.x * this.speed;
	var newY = this.center.y + this.velocity.y * this.speed;
	this.changeCenter({x : newX, y : newY});
	//console.log(this.center);
	//aim towards center then push
	for (var member in this.members) {
		member = this.members[member];
		//if (member.id == '1') { console.log('1', member.velocity); };
		var velocity = {x:0, y:0};
		var diff = {x:0, y:0};
		/*
		diff.x = centerPoint.x - member.x;
		diff.y = centerPoint.y - member.y;
		*/
		diff.x = this.center.x - member.x;
		diff.y = this.center.y - member.y;
		velocity.x += diff.x;
		velocity.y += diff.y;
		//if (member.id == '1') { console.log('2', member.velocity); };
		for (var other in this.members) {
			other = this.members[other];
			//ignore self
			if (other === member) {
				continue;
			}
			var oDiff = {x:0, y:0};
			oDiff.x = other.x - member.x;
			oDiff.y = other.y - member.y;
			var totalDist = util.hypotenuse(oDiff.x, oDiff.y);
			if (totalDist <= this.minDist) {
				//if (member.id == '1') { console.log(oDiff, totalDist); };
				velocity.x = -1 * oDiff.x;
				velocity.y = -1 * oDiff.y;
				continue;
				//if (member.id == '1') { console.log('3', member.velocity); };
			}
		}
		//add noise
		/*
		velocity.x += Math.random() * this.noise - this.noise / 2;
		velocity.y += Math.random() * this.noise - this.noise / 2;
		*/
		//set new velocity
		//if (member.id == '1') { console.log(member.velocity); };
		member.velocity = velocity;
		//console.log(velocity);
	}
};
Group.prototype.addMember = function(member) {
	this.members.push(member);
};
Group.prototype.onInputDown = function() {
	// console.log('a');
	if (this.selected) {
		// console.log('c');
		// console.log(this.myManager, this.myManager.background);
		var bg = this.myManager.background.myManager.whereClicked();
		// console.log(bg);
		this.myManager.background.myManager.sendTo(this.myManager.background, bg, this);
		this.setSelected(false);
	} else if (this.clicked()) {
		this.click();
	}
};
Group.prototype.clicked = function() {
	var mouseX = this.game.input.x;
	var mouseY = this.game.input.y;
	var diffX = mouseX - this.center.x;
	var diffY = mouseY - this.center.y;
	var totalDiff = util.hypotenuse(diffX, diffY);
	if (totalDiff <= this.clickDist) {
		return true;
	}
	return false;
};
Group.prototype.click = function() {
	if (this.selected) {
		this.setSelected(false);
	} else {
		this.setSelected(true);
	}
};
Group.prototype.move = function() {
	var mouseX = this.game.input.x;
	var mouseY = this.game.input.y;
	this.changeCenter({x : mouseX, y : mouseY});
	this.setSelected(false);
	// console.log({x : mouseX, y : mouseY});s
};
Group.prototype.setSelected = function(newSelected) {
	this.selected = newSelected;
	this.selection.visible = newSelected;
};
Group.prototype.changeCenter = function(newCenter) {
	this.selection.x = newCenter.x;
	this.selection.y = newCenter.y;
	this.center = newCenter;
};
Group.prototype.numPeople = function() {
	return this.members.length;
};
Group.prototype.mouseDown = function() {
	
};
/*
Group.prototype.tryMove = function() {
	if (!this.selected) {
		return;
	}
	var newCenter = {x : this.game.input.x, y : this.game.input.y};
	this.changeCenter(newCenter);
};
*/

module.exports = Group;













},{"../utils":"C:\\HACKUCSC\\src\\js\\utils.js"}],"C:\\HACKUCSC\\src\\js\\entities\\groupManager.js":[function(require,module,exports){
var Util = require('../utils');

var GroupManager = function (game) {
	this.game = game;
	this.members = [];
	/*
	this.bound = {
		upper : center.y - height / 2,
		lower : center.y + height / 2,
		left : center.x - width / 2,
		right : center.x + width / 2
	};
	this.width = width;
	this.height = height;
	this.center = center;
	this.minDist = width / 2;
	*/
	/*
	Phaser.Sprite.call(this, game, x, y, 'person');
	this.velocity = {x:0, y:0};
	this.width = 10;
	this.height = 10;
	this.speed = .05;
	this.id = id;
	*/
};
GroupManager.prototype.constructor = GroupManager;
GroupManager.prototype.update = function() {
	//update bounds
	if (this.background) {
		var vars = this.background.getVarsCenter();
		this.width = vars.width;
		this.height = vars.height;
		this.center = vars.center;
		// console.log(vars);
	} else {
		return;
	}
	//update member velocity
	for (var member in this.members) {
		member = this.members[member];
		var velocity = {x : 0, y : 0};
		// console.log(this.center, member.center);
		var diffX = this.center.x - member.center.x;
		var diffY = this.center.y - member.center.y;
		velocity.x = diffX;
		velocity.y = diffY;
		for (var other in this.members) {
			other = this.members[other];
			if (other === member) {
				continue;
			}
			var oDiffx = other.center.x - member.center.x;
			var oDiffy = other.center.y - member.center.y;
			var hyp = Util.hypotenuse(oDiffx, oDiffy);
			//console.log(hyp);
			if (hyp <= this.minDist) {
				// console.log('b', hyp);
				velocity.x = -1 * oDiffx;
				velocity.y = -1 * oDiffy;
				break;
			} else {
				// console.log('a');
			}
		}
		member.velocity = velocity;
	}
	//update members
	for (member in this.members) {
		this.members[member].update();
	}
};
GroupManager.prototype.transfer = function(otherGM, myMember) {
	var testVals = otherGM.background.getVarsCenter();
	// console.log('transfer to', otherGM.background.type, otherGM.background.incomeLevel, testVals.center.y, testVals.y, testVals.visHeight, testVals.vRatio);
	/*
	if (!(myMember in this.members)) {
		console.log('ERROR', myMember, 'not in', this);
		return;
	}
	*/
	var index = this.members.indexOf(myMember);
	this.members.splice(index, 1);
	otherGM.addMember(myMember);
};
GroupManager.prototype.addMember = function(member) {
	this.members.push(member);
	member.myManager = this;
	var smaller = (this.width < this.height) ? this.width : this.height;
	this.minDist = smaller / this.members.length;
	// console.log(this.minDist);
};
GroupManager.prototype.numPeople = function() {
	var count = 0;
	for (var member in this.members) {
		member = this.members[member];
		count += member.numPeople();
	}
	return count;
};

module.exports = GroupManager;












},{"../utils":"C:\\HACKUCSC\\src\\js\\utils.js"}],"C:\\HACKUCSC\\src\\js\\entities\\person.js":[function(require,module,exports){
var Person = function (game, x, y, id) {
	Phaser.Sprite.call(this, game, x, y, 'person');
	this.velocity = {x:0, y:0};
	this.width = 10;
	this.height = 10;
	this.speed = .05;
	this.id = id;
	this.eduLevel = Person.EDULEVEL.unemployed;
};
Person.prototype = Object.create(Phaser.Sprite.prototype);
Person.prototype.constructor = Person;

Person.EDULEVEL = {
	unemployed : -1,
	low  : 0,
	mid  : 1,
	high : 2
};

Person.prototype.update = function() {
	this.x += this.velocity.x * this.speed;
	this.y += this.velocity.y * this.speed;
	//console.log(this.velocity);
};

module.exports = Person;
},{}],"C:\\HACKUCSC\\src\\js\\entities\\player.js":[function(require,module,exports){
var Player = function (game, x, y) {
    Phaser.Sprite.call(this, game, x, y, 'testsprite');
    game.add.existing(this);
	this.speed = 0.1;
}

Player.prototype = Object.create(Phaser.Sprite.prototype);
Player.prototype.constructor = Player;

/**
 * Automatically called by World.update
 */
Player.prototype.update = function() {
	//this.x += this.velocity;
};

module.exports = Player;

},{}],"C:\\HACKUCSC\\src\\js\\entities\\uiBuilder.js":[function(require,module,exports){
var ProgressBar = require('./ProgressBar');

var UIBuilder = function(setGameState) {
	//Ensure that cannot create multiple instances of this class
	if(UIBuilder.prototype.exists) {
		return UIBuilder.prototype.existingReference;
	}
	
	this.gameState = setGameState;
	this.renderables = [];
	//Create and store a graphics object (used for stuff like drawing rectangles)
	UIBuilder.prototype.exists = true;
	UIBuilder.prototype.existingReference = this;
};

UIBuilder.prototype.constructor = UIBuilder;
//These var's help create the singleton functionality
UIBuilder.prototype.exists = false;
UIBuilder.prototype.existingReference = null;

//Use this function to create a progress bar
//Usage: type: can be "growing" or "shrinking", this will effect if bar starts at 0 and goes up or vis versa
//		 maxValue: sets the max value of the progress bar, i.e. using 100 creates a bar from 0 to 100
//		 x,y: sets location
//		 DON'T FORGET to overwrite the onEvent() function for the progress bar after creating it
//			-onEvent() is automatically called when bar fills/shrinks past limit (depending on bar type)
UIBuilder.prototype.buildProgressBar = function(type, x, y, width, height, maxValue) {
	//create and format new prog bar
	var graphics = this.gameState.game.add.graphics(0,0);
	var newProgBar = new ProgressBar(type, maxValue, graphics, this.renderables);
	newProgBar.setLocation(x,y);
	newProgBar.setSize(width, height);
	//subscribe to 'renderables' so that render() is called automatically
	// this.renderables.subscribe(newProgBar);
	this.renderables.push(newProgBar);
	return newProgBar;
};
UIBuilder.prototype.render = function() {
	for (renderable in this.renderables) {
		this.renderables[renderable].render();
	}
};

module.exports = UIBuilder;
},{"./ProgressBar":"C:\\HACKUCSC\\src\\js\\entities\\ProgressBar.js"}],"C:\\HACKUCSC\\src\\js\\main.js":[function(require,module,exports){
'use strict';

var game = new Phaser.Game(800, 600, Phaser.AUTO, '-game');

window.Utils = require('./utils');
window.playerState = {
    currentLevel: 'Game'
}

game.state.add('Boot', require('./states/boot'));
game.state.add('Splash', require('./states/splash'));
game.state.add('Preloader', require('./states/preloader'));
game.state.add('Menu', require('./states/menu'));
game.state.add('Game', require('./states/game'));

game.state.start('Boot');

//game.stage.backgroundColor = "#ffffff";

},{"./states/boot":"C:\\HACKUCSC\\src\\js\\states\\boot.js","./states/game":"C:\\HACKUCSC\\src\\js\\states\\game.js","./states/menu":"C:\\HACKUCSC\\src\\js\\states\\menu.js","./states/preloader":"C:\\HACKUCSC\\src\\js\\states\\preloader.js","./states/splash":"C:\\HACKUCSC\\src\\js\\states\\splash.js","./utils":"C:\\HACKUCSC\\src\\js\\utils.js"}],"C:\\HACKUCSC\\src\\js\\states\\boot.js":[function(require,module,exports){
var Boot = function () {};

module.exports = Boot;

Boot.prototype = {

  preload: function () {
    this.load.image('preloader', 'assets/preloader.gif');
  },

  create: function () {
    this.game.input.maxPointers = 1;

    if (this.game.device.desktop) {
      this.game.stage.scale.pageAlignHorizontally = true;
    } else {
      this.game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;
      this.game.scale.minWidth =  480;
      this.game.scale.minHeight = 260;
      this.game.scale.maxWidth = 640;
      this.game.scale.maxHeight = 480;
      this.game.scale.forceLandscape = true;
      this.game.scale.pageAlignHorizontally = true;
      this.game.scale.setScreenSize(true);
    }

    this.game.state.start('Preloader');
  }
};

},{}],"C:\\HACKUCSC\\src\\js\\states\\game.js":[function(require,module,exports){
var Player = require('../entities/player');
var Background_Manager = require('../entities/background_manager');
var Person = require('../entities/person');
var Group = require('../entities/group');
var GroupManager = require('../entities/groupManager');
var UIBuilder = require('../entities/uiBuilder');

var Game = function () {
  this.testentity = null;
  //this.flocks = [];
  this.bg_mg = null;
  // this.selectedGroup = null;
  this.money = null;
  this.moneyVal = 0;
  this.curMoney = 0;
  this.moneyUpdateDelay = 0.001;
  this.moneyIncrementing = false;
};

module.exports = Game;

Game.prototype = {

  create: function () {
	  // console.log(this);
	this.game.stage.backgroundColor = "#ffffff";
	  
    var x = (this.game.width / 2) - 100;
    var y = (this.game.height / 2) - 50;

    this.bg_mg = new Background_Manager(this.game, this);
    /*
    this.testentity = new Player(this.game, x, y);
    this.testentity.anchor.setTo(0.5, 0.5);
    */
	
    this.input.onDown.add(this.onInputDown, this);
	
	/*
    this.gm = groupManager = new GroupManager(this.game, 600, 600, {x : this.game.width / 2, y : this.game.height / 2});
    var testFlock = new Group(this.game, this.game.width / 2 + 100, this.game.height / 2 + 100);
    this.flocks.push(testFlock);
    for (var i = 0; i < 10; i++) {
    	var testPerson = new Person(this.game, this.game.width / 2 + i * 15, this.game.height / 2 + i * 15, i);
    	this.game.add.existing(testPerson);
    	testFlock.addMember(testPerson);
    }
    groupManager.addMember(testFlock);
	testFlock = new Group(this.game, this.game.width / 2 - 100, this.game.height / 2 + 100);
	for (var i = 0; i < 10; i++) {
    	var testPerson = new Person(this.game, this.game.width / 2 + i * 15 - 100, this.game.height / 2 + i * 15 + 100, i);
    	this.game.add.existing(testPerson);
    	testFlock.addMember(testPerson);
    }
	this.flocks.push(testFlock);
    groupManager.addMember(testFlock);
	*/
	// console.log(Person.EduLevel.foo);
	// if (myPerson.eduLevel === Person.EduLevel.low) {
	  
	// }
	this.money = this.game.add.text(10, 10, '$0');
	this.money.font = 'VT323';
	this.money.fontSize = 24;
	this.money.fill = '#ffffff';
    this.money.setShadow(3, 3, 'rgba(0,0,0,0.5)', 5);
	
	this.uib = new UIBuilder(this);
	this.uib.buildProgressBar("growing", this.game.width / 2, 25, 300, 25, 100);
  },

  update: function () {
	this.bg_mg.update();
	//this.gm.update();
	this.uib.render();
  },

  onInputDown: function () {
	  // console.log(this.game.input.x, this.game.input.y);
    //this.game.state.start('Menu');
	//console.log(this.game.input.x, this.game.input.y);
	// if (this.game.input.activePointer.leftButton.isDown) {
		//this.addMoney(100);
		// if (this.selectedGroup) {
			// var bg = this.bg_mg.whereClicked();
			// this.bg_mg.sendTo(this.selectedGroup.myManager.background, bg, this.selectedGroup);
			// this.selectedGroup = null;
		// } else {
			// for (flock in this.flocks) {
				// flock = this.flocks[flock];
				// if (flock.clicked()) {
					// flock.click();
					// this.selectedGroup = flock;
					// break;
				// }
			// }
		// }
	// }
  },
  addMoney: function (amt) {
	  this.curMoney += amt;
	  //this.money.text = '$' + newMoney;
	  if (!this.moneyIncrementing) {
		this.game.time.events.add(Phaser.Timer.SECOND * this.moneyUpdateDelay, this.incrementMoney, this);
		this.moneyIncrementing = true;
	  }
  },
  incrementMoney: function () {
	if (this.moneyVal === this.curMoney) {
		this.moneyIncrementing = false;
		return;
	}
	if (this.curMoney > this.moneyVal) {
		this.moneyVal += 1;
	} else if (this.curMoney < this.moneyVal) {
		this.moneyVal -= 1;
	}
	this.money.text = '$' + this.moneyVal;
	this.game.time.events.add(Phaser.Timer.SECOND * this.moneyUpdateDelay, this.incrementMoney, this);
  }
};














},{"../entities/background_manager":"C:\\HACKUCSC\\src\\js\\entities\\background_manager.js","../entities/group":"C:\\HACKUCSC\\src\\js\\entities\\group.js","../entities/groupManager":"C:\\HACKUCSC\\src\\js\\entities\\groupManager.js","../entities/person":"C:\\HACKUCSC\\src\\js\\entities\\person.js","../entities/player":"C:\\HACKUCSC\\src\\js\\entities\\player.js","../entities/uiBuilder":"C:\\HACKUCSC\\src\\js\\entities\\uiBuilder.js"}],"C:\\HACKUCSC\\src\\js\\states\\menu.js":[function(require,module,exports){
var Menu = function () {
  this.text = null;
};

module.exports = Menu;

Menu.prototype = {

  create: function () {
    var x = this.game.width / 2;
    var y = this.game.height / 2;

    var style = { font: "65px Arial", fill: "#ffffff", align: "center" };

    this.text = this.add.text(x - 300, y - 200, "Press to Start", style);

    this.input.onDown.add(this.onDown, this);
  },

  update: function () {
  },

  onDown: function () {
    this.game.state.start(playerState.currentLevel);
  }
};

},{}],"C:\\HACKUCSC\\src\\js\\states\\preloader.js":[function(require,module,exports){
var Preloader = function (game) {
  this.asset = null;
  this.ready = false;
};

module.exports = Preloader;

Preloader.prototype = {

  preload: function () {
    this.asset = this.add.sprite(320, 240, 'preloader');
    this.asset.anchor.setTo(0.5, 0.5);

    this.load.onLoadComplete.addOnce(this.onLoadComplete, this);
    this.load.setPreloadSprite(this.asset);
    this.load.image('testsprite', 'assets/test.png');
    this.load.image('background', 'assets/sectorBG.png')
    this.load.image('person', 'assets/person.png');
    this.load.image('selection', 'assets/selection.png');
	this.load.script('webfont', '//ajax.googleapis.com/ajax/libs/webfont/1.4.7/webfont.js');
  },

  create: function () {
    this.asset.cropEnabled = false;
  },

  update: function () {
    if (!!this.ready) {
      this.game.state.start('Game');
    }
  },

  onLoadComplete: function () {
    this.ready = true;
  }
};

},{}],"C:\\HACKUCSC\\src\\js\\states\\splash.js":[function(require,module,exports){
var Splash = function () {
};

module.exports = Splash;

Splash.prototype = {
  create: function () {
  }
};
},{}],"C:\\HACKUCSC\\src\\js\\utils.js":[function(require,module,exports){
var Utils = {
    containsObject: function(obj, list) {
        var i;
        for (i = 0; i < list.length; i++) {
            if (list[i] === obj) {
                return true;
            }
        }

        return false;
    },
	hypotenuse: function(a, b) {
		return Math.sqrt(Math.pow(a, 2) + Math.pow(b, 2));
	},
	ratio: function(a, b, c) {
		if (arguments.length === 1) {
			return [a / a];
		}
		else if (arguments.length === 2) {
			return [a / (a + b), b / (a + b)];
		}
		else if (arguments.length === 3) {
			return [a / (a + b + c), b / (a + b + c), c / (a + b + c)];
		}
		else {
			return [];
		}
	}
};


module.exports = Utils;
},{}]},{},["C:\\HACKUCSC\\src\\js\\main.js"])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvZW50aXRpZXMvUHJvZ3Jlc3NCYXIuanMiLCJzcmMvanMvZW50aXRpZXMvYmFja2dyb3VuZC5qcyIsInNyYy9qcy9lbnRpdGllcy9iYWNrZ3JvdW5kX21hbmFnZXIuanMiLCJzcmMvanMvZW50aXRpZXMvZ3JvdXAuanMiLCJzcmMvanMvZW50aXRpZXMvZ3JvdXBNYW5hZ2VyLmpzIiwic3JjL2pzL2VudGl0aWVzL3BlcnNvbi5qcyIsInNyYy9qcy9lbnRpdGllcy9wbGF5ZXIuanMiLCJzcmMvanMvZW50aXRpZXMvdWlCdWlsZGVyLmpzIiwic3JjL2pzL21haW4uanMiLCJzcmMvanMvc3RhdGVzL2Jvb3QuanMiLCJzcmMvanMvc3RhdGVzL2dhbWUuanMiLCJzcmMvanMvc3RhdGVzL21lbnUuanMiLCJzcmMvanMvc3RhdGVzL3ByZWxvYWRlci5qcyIsInNyYy9qcy9zdGF0ZXMvc3BsYXNoLmpzIiwic3JjL2pzL3V0aWxzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0dBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdElBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIi8vTk9URTogRE9OJ1QgVVNFIHRoaXMgY29kZSB0byBjcmVhdGUgYSBQcm9ncmVzc0Jhci4gSW5zdGVhZCwgdXNlIHRoZSBVSUJ1aWxkZXIgb2JqZWN0IGFuZCBjYWxsIGJ1aWxkUHJvZ3Jlc3NCYXJcclxuXHJcbnZhciBQcm9ncmVzc0JhciA9IGZ1bmN0aW9uKHNldFR5cGUsIHNldE1heFZhbHVlLCBzZXRHcmFwaGljcywgc2V0UmVuZGVyYWJsZXMpIHtcclxuXHR0aGlzLnR5cGUgPSBzZXRUeXBlOyAvL1R3byB0eXBlcywgXCJncm93aW5nXCIgKHN0YXJ0cyBhdCAwLCB0cmlnZ2VycyBldmVudCB3aGVuIGZ1bGwpIFxyXG5cdFx0XHRcdFx0XHQgLy9hbmQgXCJzaHJpbmtpbmdcIiAoc3RhcnRzIGZ1bGwsIHRyaWdnZXJzIGF0IDApXHJcblx0dGhpcy5iZ0JvcmRlclNpemUgPSAyO1x0XHRcdC8vZGVmYXVsdCBzaXplIG9mIGJhY2tncm91bmQgYm9yZGVyXHJcblx0dGhpcy5iZ0JvcmRlckNvbG9yID0gMHhBQUFBQUE7XHQvL2RlZmF1bHQgY29sb3Igb2YgYmFja2dyb3VuZCBib3JkZXJcclxuXHR0aGlzLmJnQ29sb3IgPSAweDg4ODg4ODtcdFx0Ly9kZWZhdWx0IGNvbG9yIG9mIGJhY2tncm91bmRcclxuXHR0aGlzLnBhZGRpbmdIb3JpeiA9IDU7XHRcdFx0Ly9kZWZhdWx0IHN1bSBvZiBwYWRkaW5nIG9uIGxlZnQgYW5kIHJpZ2h0IHNpZGUgaW5uZXIgdmFsdWUgYmFyXHJcblx0dGhpcy5wYWRkaW5nVmVydCA9IDU7XHRcdFx0Ly9kZWZhdWx0IHN1bSAoaS5lLiBoYWxmIG9uIGVhY2ggc2lkZSkgb2YgdmVydGljYWwgcGFkZGluZyBvZiBpbm5lciB2YWx1ZSBiYXJcclxuXHR0aGlzLnZhbHVlQm9yZGVyU2l6ZSA9IDE7XHRcdC8vZGVmYXVsdCBzaXplIG9mIHZhbHVlIGJvcmRlclxyXG5cdHRoaXMudmFsdWVCb3JkZXJDb2xvciA9IDB4ODg4OEZGOyAvL2RlZmF1bHQgY29sb3Igb2YgdmFsdWUgYm9yZGVyXHJcblx0dGhpcy52YWx1ZUNvbG9yID0gMHgwMDAwOTk7XHRcdC8vZGVmYXVsdCBjb2xvciBvZiBpbm5lciB2YWx1ZSBiYXJcclxuXHR0aGlzLnggPSBudWxsO1xyXG5cdHRoaXMueSA9IG51bGw7XHJcblx0dGhpcy53aWR0aCA9IG51bGw7XHJcblx0dGhpcy5oZWlnaHQgPSBudWxsO1xyXG5cdHRoaXMubWF4VmFsdWUgPSBzZXRNYXhWYWx1ZTtcclxuXHR0aGlzLmdyYXBoaWNzID0gc2V0R3JhcGhpY3M7IC8vc3RvcmUgZ3JhcGhpY3MgY2xhc3MgKHVzZWQgdG8gZHJhdyBiYXIpXHJcblx0dGhpcy5yZW5kZXJhYmxlcyA9IHNldFJlbmRlcmFibGVzO1xyXG5cdFxyXG5cdHRoaXMub25FdmVudCA9IGZ1bmN0aW9uKCkge307IC8vb3ZlcndyaXRlIHRoaXMgZnVuY3Rpb24gdG8gbWFrZSB3aGF0ZXZlciB5b3Ugd2FudCBoYXBwZW4gd2hlbiBwcm9ncmVzc0JhciByZWFjaGVzIGxpbWl0XHJcblx0XHJcblx0Ly9zd2l0Y2godGhpcy50eXBlKSB7XHJcblx0Ly9jYXNlICdncm93aW5nJyA6IFxyXG5cdGlmKHNldFR5cGUgPT09ICdncm93aW5nJykge1xyXG5cdFx0dGhpcy52YWx1ZSA9IDA7XHJcblx0XHQvL3RyeVRyaWdnZXIgaXMgY2FsbGVkIGF1dG9tYXRpY2FsbHkgd2hlbiB5b3UgYWRkL3N1YnRyYWN0IHZhbHVlLCBhbmQgd2lsbCB0cmlnZ2VyIHRoZSBvbkV2ZW50KCkgZnVuY3Rpb25cclxuXHRcdHRoaXMudHJ5VHJpZ2dlciA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRpZih0aGlzLnZhbHVlID49IHRoaXMubWF4VmFsdWUpIHtcclxuXHRcdFx0XHR0aGlzLm9uRXZlbnQoKTtcclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHRcdC8vYnJlYWs7XHJcblx0fVxyXG5cdGVsc2UgaWYoc2V0VHlwZSA9PT0gJ3Nocmlua2luZycpIHtcclxuXHQvL2Nhc2UgJ3Nocmlua2luZycgOlxyXG5cdFx0dGhpcy52YWx1ZSA9IHRoaXMubWF4VmFsdWU7XHJcblx0XHR0aGlzLnRyeVRyaWdnZXIgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0aWYodGhpcy52YWx1ZSA8PSAwKSB7XHJcblx0XHRcdFx0dGhpcy5vbkV2ZW50KCk7XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0fVxyXG59O1xyXG5cclxuUHJvZ3Jlc3NCYXIucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gUHJvZ3Jlc3NCYXI7XHJcblxyXG5Qcm9ncmVzc0Jhci5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uKCkge1xyXG5cdHRoaXMuZ3JhcGhpY3MuY2xlYXIoKTtcclxuXHR0aGlzLnJlbmRlcmFibGVzLnVuc3Vic2NyaWJlKHRoaXMpO1xyXG59O1xyXG5cclxuLy9UbyBzdWJ0cmFjdCB2YWx1ZSwganVzdCB1c2UgbmVnYXRpdmUgbnVtYmVycyBhcyBhcmd1bWVudCBpLmUuIGZvby5hZGRWYWx1ZSgtNSk7XHJcblByb2dyZXNzQmFyLnByb3RvdHlwZS5hZGRWYWx1ZSA9IGZ1bmN0aW9uIChhZGRUaGlzKSB7XHJcblx0dGhpcy52YWx1ZSArPSBhZGRUaGlzO1xyXG5cdGlmKHRoaXMudmFsdWUgPiB0aGlzLm1heFZhbHVlKSB7XHJcblx0XHR0aGlzLnZhbHVlID0gdGhpcy5tYXhWYWx1ZTtcclxuXHR9XHJcblx0aWYodGhpcy52YWx1ZSA8IDApIHtcclxuXHRcdHRoaXMudmFsdWUgPSAwO1xyXG5cdH1cclxuXHR0aGlzLnRyeVRyaWdnZXIoKTtcclxufTtcclxuXHJcbi8vU2V0cyB0aGUgbG9jYXRpb24gd2hlcmUgcHJvZ3Jlc3MgYmFyIGlzIHJlbmRlcmVkXHJcblByb2dyZXNzQmFyLnByb3RvdHlwZS5zZXRMb2NhdGlvbiA9IGZ1bmN0aW9uKHNldFgsIHNldFkpIHtcclxuXHR0aGlzLnggPSBzZXRYO1xyXG5cdHRoaXMueSA9IHNldFk7XHJcbn07XHJcblxyXG4vL1NldHMgdGhlIHNpemUgb2YgdGhlIHByb2dyZXNzIGJhclxyXG5Qcm9ncmVzc0Jhci5wcm90b3R5cGUuc2V0U2l6ZSA9IGZ1bmN0aW9uKHNldFdpZHRoLCBzZXRIZWlnaHQpIHtcclxuXHR0aGlzLndpZHRoID0gc2V0V2lkdGg7XHJcblx0dGhpcy5oZWlnaHQgPSBzZXRIZWlnaHQ7XHJcbn07XHJcblxyXG5Qcm9ncmVzc0Jhci5wcm90b3R5cGUuc2V0U3R5bGUgPSBmdW5jdGlvbihiZ0JvcmRlclNpemUsIGJnQm9yZGVyQ29sb3IsIGJnQ29sb3IsIHBhZGRpbmdIb3JpeiwgcGFkZGluZ1ZlcnQsIHZhbHVlQm9yZGVyU2l6ZSwgdmFsdWVCb3JkZXJDb2xvciwgdmFsdWVDb2xvcikge1xyXG5cdHRoaXMuYmdCb3JkZXJTaXplID0gYmdCb3JkZXJTaXplO1xyXG5cdHRoaXMuYmdCb3JkZXJDb2xvciA9IGJnQm9yZGVyQ29sb3I7XHJcblx0dGhpcy5iZ0NvbG9yID0gYmdDb2xvcjtcclxuXHR0aGlzLnBhZGRpbmdIb3JpeiA9IHBhZGRpbmdIb3JpejtcclxuXHR0aGlzLnBhZGRpbmdWZXJ0ID0gcGFkZGluZ1ZlcnQ7XHJcblx0dGhpcy52YWx1ZUJvcmRlclNpemUgPSB2YWx1ZUJvcmRlclNpemU7XHJcblx0dGhpcy52YWx1ZUJvcmRlckNvbG9yID0gdmFsdWVCb3JkZXJDb2xvcjtcclxuXHR0aGlzLnZhbHVlQ29sb3IgPSB2YWx1ZUNvbG9yO1xyXG59O1xyXG5cclxuLy91cGRhdGUgZm9yIHByb2dyZXNzIGJhciwgY2FsbGVkIGp1c3QgYmVmb3JlIGRyYXdpbmcgcHJvZ3Jlc3MgYmFyXHJcbi8vT3ZlcndyaXRlIHRoaXMgZnVuY3Rpb24gaWYgZGVzaXJlZFxyXG5Qcm9ncmVzc0Jhci5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7fTtcclxuXHJcbi8vUmVuZGVycyBwcm9ncmVzc0JhclxyXG5Qcm9ncmVzc0Jhci5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24oKSB7XHJcblx0dGhpcy51cGRhdGUoKTtcclxuXHR0aGlzLmdyYXBoaWNzLmNsZWFyKCk7XHJcblx0Ly9EcmF3IGJhY2tncm91bmQgb2YgYmFyXHJcblx0dGhpcy5ncmFwaGljcy5saW5lU3R5bGUodGhpcy5iZ0JvcmRlclNpemUsIHRoaXMuYmdCb3JkZXJDb2xvciwgMSk7IC8vc2V0cyBib3JkZXIgY29sb3IgYW5kIHNpemVcclxuXHR0aGlzLmdyYXBoaWNzLmJlZ2luRmlsbCh0aGlzLmJnQ29sb3IpOyAvL3NldHMgY29sb3Igb2YgYmFja2dyb3VuZCBmaWxsXHJcblx0dGhpcy5ncmFwaGljcy5kcmF3UmVjdCh0aGlzLngtdGhpcy53aWR0aC8yLCB0aGlzLnktdGhpcy5oZWlnaHQvMiwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xyXG5cdHRoaXMuZ3JhcGhpY3MuZW5kRmlsbCgpO1xyXG5cdC8vRHJhdyB2YWx1ZSBvZiBiYXJcclxuXHR2YXIgcGVyY2VudGFnZSA9IHRoaXMudmFsdWUgLyB0aGlzLm1heFZhbHVlO1xyXG5cdHZhciBiYXJXaWR0aCA9IHRoaXMud2lkdGggLSB0aGlzLnBhZGRpbmdIb3JpejtcclxuXHR2YXIgYmFySGVpZ2h0ID0gdGhpcy5oZWlnaHQgLSB0aGlzLnBhZGRpbmdWZXJ0O1xyXG5cdHRoaXMuZ3JhcGhpY3MubGluZVN0eWxlKHRoaXMudmFsdWVCb3JkZXJTaXplLCB0aGlzLnZhbHVlQm9yZGVyQ29sb3IsIDEpO1xyXG5cdHRoaXMuZ3JhcGhpY3MuYmVnaW5GaWxsKHRoaXMudmFsdWVDb2xvcik7XHJcblx0dGhpcy5ncmFwaGljcy5kcmF3UmVjdCh0aGlzLngtKGJhcldpZHRoLzIpLCB0aGlzLnktKGJhckhlaWdodC8yKSwgYmFyV2lkdGgqcGVyY2VudGFnZSwgYmFySGVpZ2h0KTtcclxuXHR0aGlzLmdyYXBoaWNzLmVuZEZpbGwoKTtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gUHJvZ3Jlc3NCYXI7IiwidmFyIEdyb3VwX01hbmFnZXIgPSByZXF1aXJlKCcuL2dyb3VwTWFuYWdlcicpO1xyXG5cclxuXHJcbnZhciBCYWNrZ3JvdW5kID0gZnVuY3Rpb24gKGdhbWUsIGJhc2VYLCBiYXNlWSwgaFJhdGlvLCB2UmF0aW8sIGluY29tZSwgdHlwZSwgc3RhdGUpIHtcclxuICAgIFBoYXNlci5TcHJpdGUuY2FsbCh0aGlzLCBnYW1lLCBiYXNlWCAqIGhSYXRpbyAqIGdhbWUud2lkdGgsIGJhc2VZICogdlJhdGlvICogZ2FtZS5oZWlnaHQsICdiYWNrZ3JvdW5kJyk7XHJcbiAgICBnYW1lLmFkZC5leGlzdGluZyh0aGlzKTtcclxuICAgIHRoaXMuaFJhdGlvID0gaFJhdGlvO1xyXG4gICAgdGhpcy52UmF0aW8gPSB2UmF0aW87XHJcbiAgICB0aGlzLm5ld0hSYXRpbyA9IGhSYXRpbztcclxuICAgIHRoaXMubmV3VlJhdGlvID0gdlJhdGlvO1xyXG4gICAgdGhpcy5ncm91cF9tYW5hZ2VyID0gbmV3IEdyb3VwX01hbmFnZXIodGhpcy5nYW1lLCBzdGF0ZSk7XHJcblx0dGhpcy5ncm91cF9tYW5hZ2VyLmJhY2tncm91bmQgPSB0aGlzO1xyXG4gICBcdHRoaXMudHlwZSA9IHR5cGU7XHJcbiAgICB0aGlzLmluY29tZUxldmVsID0gaW5jb21lO1xyXG5cdHRoaXMuc3RhdGUgPSBzdGF0ZVxyXG59O1xyXG5cclxuQmFja2dyb3VuZC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBoYXNlci5TcHJpdGUucHJvdG90eXBlKTtcclxuQmFja2dyb3VuZC5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBCYWNrZ3JvdW5kO1xyXG5cclxuQmFja2dyb3VuZC5wcm90b3R5cGUuZ2V0VmFycyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgLy9yZXR1cm4geCAmIHkgYW5kIHdpZHRoICYgaGVpZ2h0IG9mIHZpc2libGVcclxuICAgIHJldHVybiBbdGhpcy54LCB0aGlzLnksIHRoaXMuaFJhdGlvICogdGhpcy5nYW1lLndpZHRoLCB0aGlzLnZSYXRpbyAqIHRoaXMuZ2FtZS5oZWlnaHRdO1xyXG59O1xyXG5cclxuQmFja2dyb3VuZC5wcm90b3R5cGUuZ2V0VmFyc0NlbnRlciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgLy8gLy9yZXR1cm4geCAmIHkgb2YgY2VudGVyIGFuZCB3aWR0aCAmIGhlaWdodCBvZiB2aXNpYmxlXHJcbiAgICB2YXIgdmlzV2lkdGggPSB0aGlzLmhSYXRpbyAqIHRoaXMuZ2FtZS53aWR0aDtcclxuICAgIHZhciB2aXNIZWlnaHQgPSB0aGlzLnZSYXRpbyAqIHRoaXMuZ2FtZS5oZWlnaHQ7XHJcbiAgICByZXR1cm4ge3dpZHRoIDogdmlzV2lkdGgsIGhlaWdodCA6IHZpc0hlaWdodCwgY2VudGVyIDoge3ggOiB0aGlzLnggKyB2aXNXaWR0aCAvIDIsIHkgOiB0aGlzLnkgKyB2aXNIZWlnaHQgLyAyfX07XHJcbn07XHJcblxyXG5CYWNrZ3JvdW5kLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHtcclxuICAgIGlmICh0aGlzLmhSYXRpbyAhPT0gdGhpcy5uZXdIUmF0aW8pIHtcclxuICAgICAgICBpZiAodGhpcy5oUmF0aW8gKyAuMSA8IHRoaXMubmV3SFJhdGlvKSB0aGlzLmhSYXRpbyArPSAuMTtcclxuICAgICAgICBlbHNlIGlmICh0aGlzLmhSYXRpbyAtIC4xID4gdGhpcy5uZXdIUmF0aW8pIHRoaXMuaFJhdGlvIC09IC4xO1xyXG4gICAgICAgIGVsc2UgdGhpcy5oUmF0aW8gPSB0aGlzLm5ld0hSYXRpbztcclxuICAgIH1cclxuICAgIGlmICh0aGlzLnZSYXRpbyAhPT0gdGhpcy5uZXdWUmF0aW8pIHtcclxuICAgICAgICBpZiAodGhpcy52UmF0aW8gKyAuMSA8IHRoaXMubmV3VlJhdGlvKSB0aGlzLnZSYXRpbyArPSAuMTtcclxuICAgICAgICBlbHNlIGlmICh0aGlzLnZSYXRpbyAtIC4xID4gdGhpcy5uZXdWUmF0aW8pIHRoaXMudlJhdGlvIC09IC4xO1xyXG4gICAgICAgIGVsc2UgdGhpcy52UmF0aW8gPSB0aGlzLm5ld1ZSYXRpbztcclxuICAgIH1cclxuXHR0aGlzLmdyb3VwX21hbmFnZXIudXBkYXRlKCk7XHJcbn07XHJcblxyXG5cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gQmFja2dyb3VuZDsiLCIvL0NvbnRyb2xzIGJhY2tncm91bmQgZWxlbWVudHNcclxuXHJcbnZhciBCYWNrZ3JvdW5kID0gcmVxdWlyZSgnLi9iYWNrZ3JvdW5kJyk7XHJcbnZhciBQZXJzb24gPSByZXF1aXJlKCcuL3BlcnNvbicpO1xyXG52YXIgdXRpbCA9IHJlcXVpcmUoJy4uL3V0aWxzJyk7XHJcblxyXG52YXIgR3JvdXAgPSByZXF1aXJlKCcuL2dyb3VwJyk7XHJcblxyXG52YXIgQmFja2dyb3VuZF9NYW5hZ2VyID0gZnVuY3Rpb24oZ2FtZSwgc3RhdGUpIHtcclxuXHR0aGlzLmdhbWUgPSBnYW1lO1xyXG5cdHRoaXMuc3RhdGUgPSBzdGF0ZTtcclxuXHJcblx0Ly9DcmVhdGUgYXJyYXkgb2YgYmFja2dyb3VuZHNcclxuXHR0aGlzLmJnQXJyYXkgPSBbXHJcblx0XHRuZXcgQmFja2dyb3VuZCh0aGlzLmdhbWUsIDAsIDAsIC4zMywgLjMzLCBQZXJzb24uRURVTEVWRUwubG93ICwgJ3dvcmsnICwgc3RhdGUpLFx0Ly8gdGhpcy5iZ0FycmF5WzBdID09IHdvcmtMb3dcclxuXHRcdG5ldyBCYWNrZ3JvdW5kKHRoaXMuZ2FtZSwgMSwgMCwgLjMzLCAuMzMsIFBlcnNvbi5FRFVMRVZFTC5taWQgLCAnd29yaycgLCBzdGF0ZSksXHQvLyB0aGlzLmJnQXJyYXlbMV0gPT0gd29ya01pZFxyXG5cdFx0bmV3IEJhY2tncm91bmQodGhpcy5nYW1lLCAyLCAwLCAuMzMsIC4zMywgUGVyc29uLkVEVUxFVkVMLmhpZ2gsICd3b3JrJyAsIHN0YXRlKSxcdC8vIHRoaXMuYmdBcnJheVsyXSA9PSB3b3JrTWlkXHJcblx0XHRuZXcgQmFja2dyb3VuZCh0aGlzLmdhbWUsIDAsIDEsIC4zMywgLjMzLCBQZXJzb24uRURVTEVWRUwubG93ICwgJ2hvdXNlJywgc3RhdGUpLFx0Ly8gdGhpcy5iZ0FycmF5WzNdID09IGhvdXNlTG93XHJcblx0XHRuZXcgQmFja2dyb3VuZCh0aGlzLmdhbWUsIDEsIDEsIC4zMywgLjMzLCBQZXJzb24uRURVTEVWRUwubWlkICwgJ2hvdXNlJywgc3RhdGUpLFx0Ly8gdGhpcy5iZ0FycmF5WzRdID09IGhvdXNlTWlkXHJcblx0XHRuZXcgQmFja2dyb3VuZCh0aGlzLmdhbWUsIDIsIDEsIC4zMywgLjMzLCBQZXJzb24uRURVTEVWRUwuaGlnaCwgJ2hvdXNlJywgc3RhdGUpLFx0Ly8gdGhpcy5iZ0FycmF5WzVdID09IGhvdXNlTWlkXHJcblx0XHRuZXcgQmFja2dyb3VuZCh0aGlzLmdhbWUsIDAsIDIsICAgMSwgLjMzLCAnJywgICAgICAgICAgICAgICd1bmVtcGxveWVkJywgc3RhdGUpLFx0Ly8gdGhpcy5iZ0FycmF5WzZdID09IHVuZW1wbG95ZWRcclxuXHRdO1xyXG5cdGZvciAoYmcgaW4gdGhpcy5iZ0FycmF5KSB7XHJcblx0XHR0aGlzLmJnQXJyYXlbYmddLm15TWFuYWdlciA9IHRoaXM7XHJcblx0fVxyXG5cdFxyXG5cdGZvciAodmFyIGkgaW4gdGhpcy5iZ0FycmF5KSB7XHJcblx0XHRpZiAodGhpcy5iZ0FycmF5W2ldLnR5cGUgPT0gJ3dvcmsnKSB7XHJcblx0XHRcdGlmICh0aGlzLmJnQXJyYXlbaV0uaW5jb21lTGV2ZWwgPT09IFBlcnNvbi5FRFVMRVZFTC5sb3cpIHtcclxuXHRcdFx0XHR0aGlzLmJnQXJyYXlbaV0udGludCA9IDB4ZTI0MDJiO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2UgaWYgKHRoaXMuYmdBcnJheVtpXS5pbmNvbWVMZXZlbCA9PT0gUGVyc29uLkVEVUxFVkVMLm1pZCkge1xyXG5cdFx0XHRcdHRoaXMuYmdBcnJheVtpXS50aW50ID0gMHg1NmUyMmI7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSBpZiAodGhpcy5iZ0FycmF5W2ldLmluY29tZUxldmVsID09PSBQZXJzb24uRURVTEVWRUwuaGlnaCkge1xyXG5cdFx0XHRcdHRoaXMuYmdBcnJheVtpXS50aW50ID0gMHgyYjU5ZTI7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGVsc2UgaWYgKHRoaXMuYmdBcnJheVtpXS50eXBlID09ICdob3VzZScpIHtcclxuXHRcdFx0aWYgKHRoaXMuYmdBcnJheVtpXS5pbmNvbWVMZXZlbCA9PT0gUGVyc29uLkVEVUxFVkVMLmxvdykge1xyXG5cdFx0XHRcdHRoaXMuYmdBcnJheVtpXS50aW50ID0gMHhlNTUzNDA7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSBpZiAodGhpcy5iZ0FycmF5W2ldLmluY29tZUxldmVsID09PSBQZXJzb24uRURVTEVWRUwubWlkKSB7XHJcblx0XHRcdFx0dGhpcy5iZ0FycmF5W2ldLnRpbnQgPSAweDZhZTI0NjtcclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIGlmICh0aGlzLmJnQXJyYXlbaV0uaW5jb21lTGV2ZWwgPT09IFBlcnNvbi5FRFVMRVZFTC5oaWdoKSB7XHJcblx0XHRcdFx0dGhpcy5iZ0FycmF5W2ldLnRpbnQgPSAweDU0NzZkZDtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7IC8vIFVuZW1wbG95ZWQgYmFja2dyb3VuZFxyXG5cdFx0XHR0aGlzLmJnQXJyYXlbaV0udGludCA9IDB4OTM5MzkzO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRcclxuXHR2YXIgdGVzdCA9IHRoaXMuYmdBcnJheVswXS5ncm91cF9tYW5hZ2VyO1xyXG5cdHZhciB0ZXN0RmxvY2sgPSBuZXcgR3JvdXAodGhpcy5nYW1lLCB0aGlzLmdhbWUud2lkdGggLyAyICsgMTAwLCB0aGlzLmdhbWUuaGVpZ2h0IC8gMiArIDEwMCwgc3RhdGUpO1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxMDsgaSsrKSB7XHJcbiAgICBcdHZhciB0ZXN0UGVyc29uID0gbmV3IFBlcnNvbih0aGlzLmdhbWUsIHRoaXMuZ2FtZS53aWR0aCAvIDIgKyBpICogMTUsIHRoaXMuZ2FtZS5oZWlnaHQgLyAyICsgaSAqIDE1LCBpKTtcclxuICAgIFx0dGhpcy5nYW1lLmFkZC5leGlzdGluZyh0ZXN0UGVyc29uKTtcclxuICAgIFx0dGVzdEZsb2NrLmFkZE1lbWJlcih0ZXN0UGVyc29uKTtcclxuICAgIH1cclxuICAgIHRlc3QuYWRkTWVtYmVyKHRlc3RGbG9jayk7XHJcblx0Ly8gdGVzdEZsb2NrID0gbmV3IEdyb3VwKHRoaXMuZ2FtZSwgdGhpcy5nYW1lLndpZHRoIC8gMiAtIDEwMCwgdGhpcy5nYW1lLmhlaWdodCAvIDIgKyAxMDAsIHN0YXRlKTtcclxuXHQvLyBmb3IgKHZhciBpID0gMDsgaSA8IDEwOyBpKyspIHtcclxuICAgIFx0Ly8gdmFyIHRlc3RQZXJzb24gPSBuZXcgUGVyc29uKHRoaXMuZ2FtZSwgdGhpcy5nYW1lLndpZHRoIC8gMiArIGkgKiAxNSAtIDEwMCwgdGhpcy5nYW1lLmhlaWdodCAvIDIgKyBpICogMTUgKyAxMDAsIGkpO1xyXG4gICAgXHQvLyB0aGlzLmdhbWUuYWRkLmV4aXN0aW5nKHRlc3RQZXJzb24pO1xyXG4gICAgXHQvLyB0ZXN0RmxvY2suYWRkTWVtYmVyKHRlc3RQZXJzb24pO1xyXG4gICAgLy8gfVxyXG4gICAgLy8gdGVzdC5hZGRNZW1iZXIodGVzdEZsb2NrKTtcclxuXHRcclxufTtcclxuXHJcbkJhY2tncm91bmRfTWFuYWdlci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBCYWNrZ3JvdW5kX01hbmFnZXI7XHJcblxyXG4vKkJhY2tncm91bmRfTWFuYWdlci5CR05BTUVTID0ge1xyXG5cdFx0d29ya0xvdyAgICA6IHRoaXMuYmdBcnJheVswXSxcclxuXHRcdHdvcmtNaWQgICAgOiB0aGlzLmJnQXJyYXlbMV0sXHJcblx0XHR3b3JrSGlnaCAgIDogdGhpcy5iZ0FycmF5WzJdLFxyXG5cdFx0aG91c2VMb3cgICA6IHRoaXMuYmdBcnJheVszXSxcclxuXHRcdGhvdXNlTWlkICAgOiB0aGlzLmJnQXJyYXlbNF0sXHJcblx0XHRob3VzZUhpZ2ggIDogdGhpcy5iZ0FycmF5WzVdLFxyXG5cdFx0dW5lbXBsb3llZCA6IHRoaXMuYmdBcnJheVs2XVxyXG59OyovXHJcblxyXG5CYWNrZ3JvdW5kX01hbmFnZXIucHJvdG90eXBlLnNlbmRUbyA9IGZ1bmN0aW9uKHNvdXJjZSwgZGVzdGluYXRpb24sIGdyb3VwKSB7XHJcblx0aWYgKHRoaXMuY2FuVHJhbnNmZXIoc291cmNlLCBkZXN0aW5hdGlvbiwgZ3JvdXApKSB7XHQvLyBDaGVjayBpZiB0aGV5IGNhbiB0cmFuc2ZlciB1cFxyXG5cdFx0c291cmNlLmdyb3VwX21hbmFnZXIudHJhbnNmZXIoZGVzdGluYXRpb24uZ3JvdXBfbWFuYWdlciwgZ3JvdXApO1xyXG5cdFx0dGhpcy51cGRhdGVSYXRpb3MoKTtcclxuXHR9XHJcbn07XHJcblxyXG5CYWNrZ3JvdW5kX01hbmFnZXIucHJvdG90eXBlLmNhblRyYW5zZmVyID0gZnVuY3Rpb24oc291cmNlLCBkZXN0aW5hdGlvbiwgZ3JvdXApIHtcclxuXHRpZiAoc291cmNlID09PSBudWxsIHx8IGRlc3RpbmF0aW9uID09PSBudWxsKSByZXR1cm4gZmFsc2U7XHJcblx0dmFyIHNvdXJjZUVkdSA9IGdyb3VwLm1lbWJlcnNbMF0uZWR1TGV2ZWw7XHJcblx0aWYgKGRlc3RpbmF0aW9uLnR5cGUgPT09ICd1bmVtcGxveWVkJykge1xyXG5cdFx0cmV0dXJuIHRydWU7XHJcblx0fVxyXG5cdGlmIChzb3VyY2VFZHUgPT09IFBlcnNvbi5FRFVMRVZFTC51bmVtcGxveWVkKSB7XHJcblx0XHRpZiAoZGVzdGluYXRpb24uaW5jb21lTGV2ZWwgPT09IFBlcnNvbi5FRFVMRVZFTC5sb3cgJiYgZGVzdGluYXRpb24udHlwZSA9PT0gJ2hvdXNlJykge1xyXG5cdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdH1cclxuXHR9IGVsc2UgaWYgKHNvdXJjZUVkdSA9PT0gUGVyc29uLkVEVUxFVkVMLmxvdykge1xyXG5cdFx0aWYgKGRlc3RpbmF0aW9uLmluY29tZUxldmVsID09PSBQZXJzb24uRURVTEVWRUwubG93KSB7XHJcblx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0fSBlbHNlIGlmIChkZXN0aW5hdGlvbi5pbmNvbWVMZXZlbCA9PT0gUGVyc29uLkVEVUxFVkVMLm1pZCkge1xyXG5cdFx0XHRpZiAoZGVzdGluYXRpb24udHlwZSA9PT0gJ2hvdXNlJykge1xyXG5cdFx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fSBlbHNlIGlmIChzb3VyY2VFZHUgPT09IFBlcnNvbi5FRFVMRVZFTC5taWQpIHtcclxuXHRcdGlmIChkZXN0aW5hdGlvbi5pbmNvbWVMZXZlbCA9PT0gUGVyc29uLkVEVUxFVkVMLmxvdykge1xyXG5cdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdH0gZWxzZSBpZiAoZGVzdGluYXRpb24uaW5jb21lTGV2ZWwgPT09IFBlcnNvbi5FRFVMRVZFTC5taWQpIHtcclxuXHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHR9IGVsc2UgaWYgKGRlc3RpbmF0aW9uLmluY29tZUxldmVsID09PSBQZXJzb24uRURVTEVWRUwuaGlnaCkge1xyXG5cdFx0XHRpZiAoZGVzdGluYXRpb24udHlwZSA9PT0gJ2hvdXNlJykge1xyXG5cdFx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fSBlbHNlIGlmIChzb3VyY2VFZHUgPT09IFBlcnNvbi5FRFVMRVZFTC5oaWdoKSB7XHJcblx0XHRyZXR1cm4gdHJ1ZTtcclxuXHR9XHJcblx0cmV0dXJuIGZhbHNlO1xyXG59O1xyXG5cclxuQmFja2dyb3VuZF9NYW5hZ2VyLnByb3RvdHlwZS53aGVyZUNsaWNrZWQgPSBmdW5jdGlvbigpIHtcclxuXHRmb3IgKHZhciBpIGluIHRoaXMuYmdBcnJheSkge1xyXG5cdFx0dmFyIGN1ckRpbWVuc2lvbnMgPSB0aGlzLmJnQXJyYXlbaV0uZ2V0VmFycygpO1xyXG5cdFx0dmFyIG1vdXNlWCA9IHRoaXMuZ2FtZS5pbnB1dC54O1xyXG5cdFx0dmFyIG1vdXNlWSA9IHRoaXMuZ2FtZS5pbnB1dC55O1xyXG5cdFx0aWYgKG1vdXNlWCA+IGN1ckRpbWVuc2lvbnNbMF0gJiYgbW91c2VYIDw9IGN1ckRpbWVuc2lvbnNbMF0gKyBjdXJEaW1lbnNpb25zWzJdKSB7XHJcblx0XHRcdGlmIChtb3VzZVkgPiBjdXJEaW1lbnNpb25zWzFdICYmIG1vdXNlWSA8PSBjdXJEaW1lbnNpb25zWzFdICsgY3VyRGltZW5zaW9uc1szXSkge1xyXG5cdFx0XHRcdHJldHVybiB0aGlzLmJnQXJyYXlbaV07XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblx0cmV0dXJuIG51bGw7XHJcbn07XHJcblxyXG5CYWNrZ3JvdW5kX01hbmFnZXIucHJvdG90eXBlLmZpbmRPdGhlciA9IGZ1bmN0aW9uKHNvdXJjZSwgZGVzdGluYXRpb24pIHtcclxuXHRpZiAoc291cmNlLnR5cGUgPT09ICd3b3JrJyAmJiBkZXN0aW5hdGlvbi50eXBlID09PSAnd29yaycpIHtcclxuXHRcdGlmIChzb3VyY2UuaW5jb21lTGV2ZWwgPT09IFBlcnNvbi5FRFVMRVZFTC5sb3cpIHtcclxuXHRcdFx0aWYgKGRlc3RpbmF0aW9uLmluY29tZUxldmVsID09PSBQZXJzb24uRURVTEVWRUwubWlkKSByZXR1cm4gdGhpcy5iZ0FycmF5WzJdO1xyXG5cdFx0XHRlbHNlIGlmIChkZXN0aW5hdGlvbi5pbmNvbWVMZXZlbCA9PT0gUGVyc29uLkVEVUxFVkVMLmhpZ2gpIHJldHVybiB0aGlzLmJnQXJyYXlbMV07XHJcblx0XHR9XHJcblx0XHRlbHNlIGlmIChzb3VyY2UuaW5jb21lTGV2ZWwgPT09IFBlcnNvbi5FRFVMRVZFTC5taWQpIHtcclxuXHRcdFx0aWYgKGRlc3RpbmF0aW9uLmluY29tZUxldmVsID09PSBQZXJzb24uRURVTEVWRUwubG93KSByZXR1cm4gdGhpcy5iZ0FycmF5WzJdO1xyXG5cdFx0XHRlbHNlIGlmIChkZXN0aW5hdGlvbi5pbmNvbWVMZXZlbCA9PT0gUGVyc29uLkVEVUxFVkVMLmhpZ2gpIHJldHVybiB0aGlzLmJnQXJyYXlbMF07XHJcblx0XHR9XHJcblx0XHRlbHNlIGlmIChzb3VyY2UuaW5jb21lTGV2ZWwgPT09IFBlcnNvbi5FRFVMRVZFTC5oaWdoKSB7XHJcblx0XHRcdGlmIChkZXN0aW5hdGlvbi5pbmNvbWVMZXZlbCA9PT0gUGVyc29uLkVEVUxFVkVMLmxvdykgcmV0dXJuIHRoaXMuYmdBcnJheVsxXTtcclxuXHRcdFx0ZWxzZSBpZiAoZGVzdGluYXRpb24uaW5jb21lTGV2ZWwgPT09IFBlcnNvbi5FRFVMRVZFTC5taWQpIHJldHVybiB0aGlzLmJnQXJyYXlbMF07XHJcblx0XHR9XHJcblx0fVxyXG5cdGVsc2UgaWYgKHNvdXJjZS50eXBlID09PSAnaG91c2UnICYmIGRlc3RpbmF0aW9uLnR5cGUgPT09ICdob3VzZScpIHtcclxuXHRcdGlmIChzb3VyY2UuaW5jb21lTGV2ZWwgPT09IFBlcnNvbi5FRFVMRVZFTC5sb3cpIHtcclxuXHRcdFx0aWYgKGRlc3RpbmF0aW9uLmluY29tZUxldmVsID09PSBQZXJzb24uRURVTEVWRUwubWlkKSByZXR1cm4gdGhpcy5iZ0FycmF5WzVdO1xyXG5cdFx0XHRlbHNlIGlmIChkZXN0aW5hdGlvbi5pbmNvbWVMZXZlbCA9PT0gUGVyc29uLkVEVUxFVkVMLmhpZ2gpIHJldHVybiB0aGlzLmJnQXJyYXlbNF07XHJcblx0XHR9XHJcblx0XHRlbHNlIGlmIChzb3VyY2UuaW5jb21lTGV2ZWwgPT09IFBlcnNvbi5FRFVMRVZFTC5taWQpIHtcclxuXHRcdFx0aWYgKGRlc3RpbmF0aW9uLmluY29tZUxldmVsID09PSBQZXJzb24uRURVTEVWRUwubG93KSByZXR1cm4gdGhpcy5iZ0FycmF5WzVdO1xyXG5cdFx0XHRlbHNlIGlmIChkZXN0aW5hdGlvbi5pbmNvbWVMZXZlbCA9PT0gUGVyc29uLkVEVUxFVkVMLmhpZ2gpIHJldHVybiB0aGlzLmJnQXJyYXlbM107XHJcblx0XHR9XHJcblx0XHRlbHNlIGlmIChzb3VyY2UuaW5jb21lTGV2ZWwgPT09IFBlcnNvbi5FRFVMRVZFTC5oaWdoKSB7XHJcblx0XHRcdGlmIChkZXN0aW5hdGlvbi5pbmNvbWVMZXZlbCA9PT0gUGVyc29uLkVEVUxFVkVMLmxvdykgcmV0dXJuIHRoaXMuYmdBcnJheVs0XTtcclxuXHRcdFx0ZWxzZSBpZiAoZGVzdGluYXRpb24uaW5jb21lTGV2ZWwgPT09IFBlcnNvbi5FRFVMRVZFTC5taWQpIHJldHVybiB0aGlzLmJnQXJyYXlbM107XHJcblx0XHR9XHJcblx0fVxyXG59O1xyXG5cclxuQmFja2dyb3VuZF9NYW5hZ2VyLnByb3RvdHlwZS51cGRhdGVSYXRpb3MgPSBmdW5jdGlvbigpIHtcclxuXHR2YXIgaFdvcmtSYXRpb3MgPSB1dGlsLnJhdGlvKHRoaXMuYmdBcnJheVswXS5ncm91cF9tYW5hZ2VyLm51bVBlb3BsZSgpLCB0aGlzLmJnQXJyYXlbMV0uZ3JvdXBfbWFuYWdlci5udW1QZW9wbGUoKSwgdGhpcy5iZ0FycmF5WzJdLmdyb3VwX21hbmFnZXIubnVtUGVvcGxlKCkpO1xyXG5cdHZhciBoSG91c2VSYXRpb3MgPSB1dGlsLnJhdGlvKHRoaXMuYmdBcnJheVszXS5ncm91cF9tYW5hZ2VyLm51bVBlb3BsZSgpLCB0aGlzLmJnQXJyYXlbNF0uZ3JvdXBfbWFuYWdlci5udW1QZW9wbGUoKSwgdGhpcy5iZ0FycmF5WzVdLmdyb3VwX21hbmFnZXIubnVtUGVvcGxlKCkpO1xyXG5cdHZhciBlbXBsb3llZCA9IDA7XHJcblx0Zm9yICh2YXIgaiA9IDA7IGogPCA2OyBqKyspXHJcblx0XHRlbXBsb3llZCArPSB0aGlzLmJnQXJyYXlbal0uZ3JvdXBfbWFuYWdlci5udW1QZW9wbGUoKTtcclxuXHR2YXIgdlJhdGlvcyA9IHV0aWwucmF0aW8odGhpcy5iZ0FycmF5WzZdLmdyb3VwX21hbmFnZXIubnVtUGVvcGxlKCksIGVtcGxveWVkKTtcclxuXHRjb25zb2xlLmxvZygndGhpcy5iZ0FycmF5WzBdLmdyb3VwX21hbmFnZXIubnVtUGVvcGxlKCk6ICcgKyB0aGlzLmJnQXJyYXlbMF0uZ3JvdXBfbWFuYWdlci5udW1QZW9wbGUoKSk7XHJcblx0Y29uc29sZS5sb2coJ2hXb3JrUmF0aW9zOiAnICsgaFdvcmtSYXRpb3MpO1xyXG5cclxuXHRmb3IgKHZhciBpID0gMCBpbiB0aGlzLmJnQXJyYXkpIHtcclxuXHRcdGlmIChpICE9PSA2KSB7XHRcdC8vIElmIG5vdCB1bmVtcGxveWVkIGJnXHJcblx0XHRcdGlmIChpIDwgMykge1x0Ly8gSWYgd29yayBiZ1xyXG5cdFx0XHRcdHRoaXMuYmdBcnJheVtpXS5uZXdIUmF0aW8gPSBoV29ya1JhdGlvc1tpXTtcclxuXHRcdFx0XHR0aGlzLmJnQXJyYXlbaV0ubmV3VlJhdGlvID0gdlJhdGlvc1sxXSAvIDI7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSB7XHRcdFx0Ly8gSWYgaG91c2UgYmdcclxuXHRcdFx0XHR0aGlzLmJnQXJyYXlbaV0ubmV3SFJhdGlvID0gaEhvdXNlUmF0aW9zW2kgLSAzXTtcclxuXHRcdFx0XHR0aGlzLmJnQXJyYXlbaV0ubmV3VlJhdGlvID0gdlJhdGlvc1sxXSAvIDI7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGVsc2UgYmdBcnJheVtpXS5uZXdWUmF0aW8gPSB2UmF0aW9zWzBdOyAvLyBVbmVtcGxveWVkIGJnXHJcblx0fVxyXG59O1xyXG5cclxuQmFja2dyb3VuZF9NYW5hZ2VyLnByb3RvdHlwZS5nZXREaW1lbnNpb25zID0gZnVuY3Rpb24oYmFja2dyb3VuZCkge1xyXG5cclxufTtcclxuXHJcbkJhY2tncm91bmRfTWFuYWdlci5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7XHJcblx0Zm9yICh2YXIgaSBpbiB0aGlzLmJnQXJyYXkpIHtcclxuXHRcdHRoaXMuYmdBcnJheVtpXS51cGRhdGUoKTtcclxuXHR9XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEJhY2tncm91bmRfTWFuYWdlcjsiLCIvL2NvbnRyb2xzIGZsb2NraW5nIGZvciBhIGdyb3VwIG9mIHBlcnNvbiBvYmplY3RzXHJcbnZhciB1dGlsID0gcmVxdWlyZSgnLi4vdXRpbHMnKTtcclxuXHJcbnZhciBHcm91cCA9IGZ1bmN0aW9uIChnYW1lLCBjZW50ZXJYLCBjZW50ZXJZLCBzdGF0ZSkge1xyXG5cdHRoaXMuZ2FtZSA9IGdhbWU7XHJcblx0dGhpcy5tZW1iZXJzID0gW107XHJcblx0dGhpcy5taW5EaXN0ID0gMjA7XHJcblx0Ly90aGlzLm5vaXNlID0gMTA7XHJcblx0dGhpcy5jZW50ZXIgPSB7eCA6IGNlbnRlclgsIHkgOiBjZW50ZXJZfTtcclxuXHR0aGlzLmNsaWNrRGlzdCA9IDUwO1xyXG5cdHRoaXMuc2VsZWN0ZWQgPSBmYWxzZTtcclxuXHR0aGlzLnNlbGVjdGlvbiA9IHRoaXMuZ2FtZS5hZGQuc3ByaXRlKHRoaXMuY2VudGVyLngsIHRoaXMuY2VudGVyLnksICdzZWxlY3Rpb24nKTtcclxuXHR0aGlzLnNlbGVjdGlvbi5hbmNob3Iuc2V0VG8oMC41LCAwLjUpO1xyXG5cdHRoaXMuc2VsZWN0aW9uLndpZHRoID0gMTAwO1xyXG5cdHRoaXMuc2VsZWN0aW9uLmhlaWdodCA9IDEwMDtcclxuXHR0aGlzLnNlbGVjdGlvbi52aXNpYmxlID0gZmFsc2U7XHJcblx0dGhpcy52ZWxvY2l0eSA9IHt4IDogMCwgeSA6IDB9O1xyXG5cdHRoaXMuc3BlZWQgPSAuMDU7XHJcblx0dGhpcy5zdGF0ZSA9IHN0YXRlO1xyXG5cdFxyXG5cdHRoaXMuc3RhdGUuaW5wdXQub25Eb3duLmFkZCh0aGlzLm9uSW5wdXREb3duLCB0aGlzKTtcclxufVxyXG5Hcm91cC5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBHcm91cDtcclxuR3JvdXAucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG5cdC8vdXBkYXRlIGNlbnRlclxyXG5cdHZhciBuZXdYID0gdGhpcy5jZW50ZXIueCArIHRoaXMudmVsb2NpdHkueCAqIHRoaXMuc3BlZWQ7XHJcblx0dmFyIG5ld1kgPSB0aGlzLmNlbnRlci55ICsgdGhpcy52ZWxvY2l0eS55ICogdGhpcy5zcGVlZDtcclxuXHR0aGlzLmNoYW5nZUNlbnRlcih7eCA6IG5ld1gsIHkgOiBuZXdZfSk7XHJcblx0Ly9jb25zb2xlLmxvZyh0aGlzLmNlbnRlcik7XHJcblx0Ly9haW0gdG93YXJkcyBjZW50ZXIgdGhlbiBwdXNoXHJcblx0Zm9yICh2YXIgbWVtYmVyIGluIHRoaXMubWVtYmVycykge1xyXG5cdFx0bWVtYmVyID0gdGhpcy5tZW1iZXJzW21lbWJlcl07XHJcblx0XHQvL2lmIChtZW1iZXIuaWQgPT0gJzEnKSB7IGNvbnNvbGUubG9nKCcxJywgbWVtYmVyLnZlbG9jaXR5KTsgfTtcclxuXHRcdHZhciB2ZWxvY2l0eSA9IHt4OjAsIHk6MH07XHJcblx0XHR2YXIgZGlmZiA9IHt4OjAsIHk6MH07XHJcblx0XHQvKlxyXG5cdFx0ZGlmZi54ID0gY2VudGVyUG9pbnQueCAtIG1lbWJlci54O1xyXG5cdFx0ZGlmZi55ID0gY2VudGVyUG9pbnQueSAtIG1lbWJlci55O1xyXG5cdFx0Ki9cclxuXHRcdGRpZmYueCA9IHRoaXMuY2VudGVyLnggLSBtZW1iZXIueDtcclxuXHRcdGRpZmYueSA9IHRoaXMuY2VudGVyLnkgLSBtZW1iZXIueTtcclxuXHRcdHZlbG9jaXR5LnggKz0gZGlmZi54O1xyXG5cdFx0dmVsb2NpdHkueSArPSBkaWZmLnk7XHJcblx0XHQvL2lmIChtZW1iZXIuaWQgPT0gJzEnKSB7IGNvbnNvbGUubG9nKCcyJywgbWVtYmVyLnZlbG9jaXR5KTsgfTtcclxuXHRcdGZvciAodmFyIG90aGVyIGluIHRoaXMubWVtYmVycykge1xyXG5cdFx0XHRvdGhlciA9IHRoaXMubWVtYmVyc1tvdGhlcl07XHJcblx0XHRcdC8vaWdub3JlIHNlbGZcclxuXHRcdFx0aWYgKG90aGVyID09PSBtZW1iZXIpIHtcclxuXHRcdFx0XHRjb250aW51ZTtcclxuXHRcdFx0fVxyXG5cdFx0XHR2YXIgb0RpZmYgPSB7eDowLCB5OjB9O1xyXG5cdFx0XHRvRGlmZi54ID0gb3RoZXIueCAtIG1lbWJlci54O1xyXG5cdFx0XHRvRGlmZi55ID0gb3RoZXIueSAtIG1lbWJlci55O1xyXG5cdFx0XHR2YXIgdG90YWxEaXN0ID0gdXRpbC5oeXBvdGVudXNlKG9EaWZmLngsIG9EaWZmLnkpO1xyXG5cdFx0XHRpZiAodG90YWxEaXN0IDw9IHRoaXMubWluRGlzdCkge1xyXG5cdFx0XHRcdC8vaWYgKG1lbWJlci5pZCA9PSAnMScpIHsgY29uc29sZS5sb2cob0RpZmYsIHRvdGFsRGlzdCk7IH07XHJcblx0XHRcdFx0dmVsb2NpdHkueCA9IC0xICogb0RpZmYueDtcclxuXHRcdFx0XHR2ZWxvY2l0eS55ID0gLTEgKiBvRGlmZi55O1xyXG5cdFx0XHRcdGNvbnRpbnVlO1xyXG5cdFx0XHRcdC8vaWYgKG1lbWJlci5pZCA9PSAnMScpIHsgY29uc29sZS5sb2coJzMnLCBtZW1iZXIudmVsb2NpdHkpOyB9O1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHQvL2FkZCBub2lzZVxyXG5cdFx0LypcclxuXHRcdHZlbG9jaXR5LnggKz0gTWF0aC5yYW5kb20oKSAqIHRoaXMubm9pc2UgLSB0aGlzLm5vaXNlIC8gMjtcclxuXHRcdHZlbG9jaXR5LnkgKz0gTWF0aC5yYW5kb20oKSAqIHRoaXMubm9pc2UgLSB0aGlzLm5vaXNlIC8gMjtcclxuXHRcdCovXHJcblx0XHQvL3NldCBuZXcgdmVsb2NpdHlcclxuXHRcdC8vaWYgKG1lbWJlci5pZCA9PSAnMScpIHsgY29uc29sZS5sb2cobWVtYmVyLnZlbG9jaXR5KTsgfTtcclxuXHRcdG1lbWJlci52ZWxvY2l0eSA9IHZlbG9jaXR5O1xyXG5cdFx0Ly9jb25zb2xlLmxvZyh2ZWxvY2l0eSk7XHJcblx0fVxyXG59O1xyXG5Hcm91cC5wcm90b3R5cGUuYWRkTWVtYmVyID0gZnVuY3Rpb24obWVtYmVyKSB7XHJcblx0dGhpcy5tZW1iZXJzLnB1c2gobWVtYmVyKTtcclxufTtcclxuR3JvdXAucHJvdG90eXBlLm9uSW5wdXREb3duID0gZnVuY3Rpb24oKSB7XHJcblx0Ly8gY29uc29sZS5sb2coJ2EnKTtcclxuXHRpZiAodGhpcy5zZWxlY3RlZCkge1xyXG5cdFx0Ly8gY29uc29sZS5sb2coJ2MnKTtcclxuXHRcdC8vIGNvbnNvbGUubG9nKHRoaXMubXlNYW5hZ2VyLCB0aGlzLm15TWFuYWdlci5iYWNrZ3JvdW5kKTtcclxuXHRcdHZhciBiZyA9IHRoaXMubXlNYW5hZ2VyLmJhY2tncm91bmQubXlNYW5hZ2VyLndoZXJlQ2xpY2tlZCgpO1xyXG5cdFx0Ly8gY29uc29sZS5sb2coYmcpO1xyXG5cdFx0dGhpcy5teU1hbmFnZXIuYmFja2dyb3VuZC5teU1hbmFnZXIuc2VuZFRvKHRoaXMubXlNYW5hZ2VyLmJhY2tncm91bmQsIGJnLCB0aGlzKTtcclxuXHRcdHRoaXMuc2V0U2VsZWN0ZWQoZmFsc2UpO1xyXG5cdH0gZWxzZSBpZiAodGhpcy5jbGlja2VkKCkpIHtcclxuXHRcdHRoaXMuY2xpY2soKTtcclxuXHR9XHJcbn07XHJcbkdyb3VwLnByb3RvdHlwZS5jbGlja2VkID0gZnVuY3Rpb24oKSB7XHJcblx0dmFyIG1vdXNlWCA9IHRoaXMuZ2FtZS5pbnB1dC54O1xyXG5cdHZhciBtb3VzZVkgPSB0aGlzLmdhbWUuaW5wdXQueTtcclxuXHR2YXIgZGlmZlggPSBtb3VzZVggLSB0aGlzLmNlbnRlci54O1xyXG5cdHZhciBkaWZmWSA9IG1vdXNlWSAtIHRoaXMuY2VudGVyLnk7XHJcblx0dmFyIHRvdGFsRGlmZiA9IHV0aWwuaHlwb3RlbnVzZShkaWZmWCwgZGlmZlkpO1xyXG5cdGlmICh0b3RhbERpZmYgPD0gdGhpcy5jbGlja0Rpc3QpIHtcclxuXHRcdHJldHVybiB0cnVlO1xyXG5cdH1cclxuXHRyZXR1cm4gZmFsc2U7XHJcbn07XHJcbkdyb3VwLnByb3RvdHlwZS5jbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdGlmICh0aGlzLnNlbGVjdGVkKSB7XHJcblx0XHR0aGlzLnNldFNlbGVjdGVkKGZhbHNlKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0dGhpcy5zZXRTZWxlY3RlZCh0cnVlKTtcclxuXHR9XHJcbn07XHJcbkdyb3VwLnByb3RvdHlwZS5tb3ZlID0gZnVuY3Rpb24oKSB7XHJcblx0dmFyIG1vdXNlWCA9IHRoaXMuZ2FtZS5pbnB1dC54O1xyXG5cdHZhciBtb3VzZVkgPSB0aGlzLmdhbWUuaW5wdXQueTtcclxuXHR0aGlzLmNoYW5nZUNlbnRlcih7eCA6IG1vdXNlWCwgeSA6IG1vdXNlWX0pO1xyXG5cdHRoaXMuc2V0U2VsZWN0ZWQoZmFsc2UpO1xyXG5cdC8vIGNvbnNvbGUubG9nKHt4IDogbW91c2VYLCB5IDogbW91c2VZfSk7c1xyXG59O1xyXG5Hcm91cC5wcm90b3R5cGUuc2V0U2VsZWN0ZWQgPSBmdW5jdGlvbihuZXdTZWxlY3RlZCkge1xyXG5cdHRoaXMuc2VsZWN0ZWQgPSBuZXdTZWxlY3RlZDtcclxuXHR0aGlzLnNlbGVjdGlvbi52aXNpYmxlID0gbmV3U2VsZWN0ZWQ7XHJcbn07XHJcbkdyb3VwLnByb3RvdHlwZS5jaGFuZ2VDZW50ZXIgPSBmdW5jdGlvbihuZXdDZW50ZXIpIHtcclxuXHR0aGlzLnNlbGVjdGlvbi54ID0gbmV3Q2VudGVyLng7XHJcblx0dGhpcy5zZWxlY3Rpb24ueSA9IG5ld0NlbnRlci55O1xyXG5cdHRoaXMuY2VudGVyID0gbmV3Q2VudGVyO1xyXG59O1xyXG5Hcm91cC5wcm90b3R5cGUubnVtUGVvcGxlID0gZnVuY3Rpb24oKSB7XHJcblx0cmV0dXJuIHRoaXMubWVtYmVycy5sZW5ndGg7XHJcbn07XHJcbkdyb3VwLnByb3RvdHlwZS5tb3VzZURvd24gPSBmdW5jdGlvbigpIHtcclxuXHRcclxufTtcclxuLypcclxuR3JvdXAucHJvdG90eXBlLnRyeU1vdmUgPSBmdW5jdGlvbigpIHtcclxuXHRpZiAoIXRoaXMuc2VsZWN0ZWQpIHtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblx0dmFyIG5ld0NlbnRlciA9IHt4IDogdGhpcy5nYW1lLmlucHV0LngsIHkgOiB0aGlzLmdhbWUuaW5wdXQueX07XHJcblx0dGhpcy5jaGFuZ2VDZW50ZXIobmV3Q2VudGVyKTtcclxufTtcclxuKi9cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gR3JvdXA7XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbiIsInZhciBVdGlsID0gcmVxdWlyZSgnLi4vdXRpbHMnKTtcclxuXHJcbnZhciBHcm91cE1hbmFnZXIgPSBmdW5jdGlvbiAoZ2FtZSkge1xyXG5cdHRoaXMuZ2FtZSA9IGdhbWU7XHJcblx0dGhpcy5tZW1iZXJzID0gW107XHJcblx0LypcclxuXHR0aGlzLmJvdW5kID0ge1xyXG5cdFx0dXBwZXIgOiBjZW50ZXIueSAtIGhlaWdodCAvIDIsXHJcblx0XHRsb3dlciA6IGNlbnRlci55ICsgaGVpZ2h0IC8gMixcclxuXHRcdGxlZnQgOiBjZW50ZXIueCAtIHdpZHRoIC8gMixcclxuXHRcdHJpZ2h0IDogY2VudGVyLnggKyB3aWR0aCAvIDJcclxuXHR9O1xyXG5cdHRoaXMud2lkdGggPSB3aWR0aDtcclxuXHR0aGlzLmhlaWdodCA9IGhlaWdodDtcclxuXHR0aGlzLmNlbnRlciA9IGNlbnRlcjtcclxuXHR0aGlzLm1pbkRpc3QgPSB3aWR0aCAvIDI7XHJcblx0Ki9cclxuXHQvKlxyXG5cdFBoYXNlci5TcHJpdGUuY2FsbCh0aGlzLCBnYW1lLCB4LCB5LCAncGVyc29uJyk7XHJcblx0dGhpcy52ZWxvY2l0eSA9IHt4OjAsIHk6MH07XHJcblx0dGhpcy53aWR0aCA9IDEwO1xyXG5cdHRoaXMuaGVpZ2h0ID0gMTA7XHJcblx0dGhpcy5zcGVlZCA9IC4wNTtcclxuXHR0aGlzLmlkID0gaWQ7XHJcblx0Ki9cclxufTtcclxuR3JvdXBNYW5hZ2VyLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IEdyb3VwTWFuYWdlcjtcclxuR3JvdXBNYW5hZ2VyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHtcclxuXHQvL3VwZGF0ZSBib3VuZHNcclxuXHRpZiAodGhpcy5iYWNrZ3JvdW5kKSB7XHJcblx0XHR2YXIgdmFycyA9IHRoaXMuYmFja2dyb3VuZC5nZXRWYXJzQ2VudGVyKCk7XHJcblx0XHR0aGlzLndpZHRoID0gdmFycy53aWR0aDtcclxuXHRcdHRoaXMuaGVpZ2h0ID0gdmFycy5oZWlnaHQ7XHJcblx0XHR0aGlzLmNlbnRlciA9IHZhcnMuY2VudGVyO1xyXG5cdFx0Ly8gY29uc29sZS5sb2codmFycyk7XHJcblx0fSBlbHNlIHtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblx0Ly91cGRhdGUgbWVtYmVyIHZlbG9jaXR5XHJcblx0Zm9yICh2YXIgbWVtYmVyIGluIHRoaXMubWVtYmVycykge1xyXG5cdFx0bWVtYmVyID0gdGhpcy5tZW1iZXJzW21lbWJlcl07XHJcblx0XHR2YXIgdmVsb2NpdHkgPSB7eCA6IDAsIHkgOiAwfTtcclxuXHRcdC8vIGNvbnNvbGUubG9nKHRoaXMuY2VudGVyLCBtZW1iZXIuY2VudGVyKTtcclxuXHRcdHZhciBkaWZmWCA9IHRoaXMuY2VudGVyLnggLSBtZW1iZXIuY2VudGVyLng7XHJcblx0XHR2YXIgZGlmZlkgPSB0aGlzLmNlbnRlci55IC0gbWVtYmVyLmNlbnRlci55O1xyXG5cdFx0dmVsb2NpdHkueCA9IGRpZmZYO1xyXG5cdFx0dmVsb2NpdHkueSA9IGRpZmZZO1xyXG5cdFx0Zm9yICh2YXIgb3RoZXIgaW4gdGhpcy5tZW1iZXJzKSB7XHJcblx0XHRcdG90aGVyID0gdGhpcy5tZW1iZXJzW290aGVyXTtcclxuXHRcdFx0aWYgKG90aGVyID09PSBtZW1iZXIpIHtcclxuXHRcdFx0XHRjb250aW51ZTtcclxuXHRcdFx0fVxyXG5cdFx0XHR2YXIgb0RpZmZ4ID0gb3RoZXIuY2VudGVyLnggLSBtZW1iZXIuY2VudGVyLng7XHJcblx0XHRcdHZhciBvRGlmZnkgPSBvdGhlci5jZW50ZXIueSAtIG1lbWJlci5jZW50ZXIueTtcclxuXHRcdFx0dmFyIGh5cCA9IFV0aWwuaHlwb3RlbnVzZShvRGlmZngsIG9EaWZmeSk7XHJcblx0XHRcdC8vY29uc29sZS5sb2coaHlwKTtcclxuXHRcdFx0aWYgKGh5cCA8PSB0aGlzLm1pbkRpc3QpIHtcclxuXHRcdFx0XHQvLyBjb25zb2xlLmxvZygnYicsIGh5cCk7XHJcblx0XHRcdFx0dmVsb2NpdHkueCA9IC0xICogb0RpZmZ4O1xyXG5cdFx0XHRcdHZlbG9jaXR5LnkgPSAtMSAqIG9EaWZmeTtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQvLyBjb25zb2xlLmxvZygnYScpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRtZW1iZXIudmVsb2NpdHkgPSB2ZWxvY2l0eTtcclxuXHR9XHJcblx0Ly91cGRhdGUgbWVtYmVyc1xyXG5cdGZvciAobWVtYmVyIGluIHRoaXMubWVtYmVycykge1xyXG5cdFx0dGhpcy5tZW1iZXJzW21lbWJlcl0udXBkYXRlKCk7XHJcblx0fVxyXG59O1xyXG5Hcm91cE1hbmFnZXIucHJvdG90eXBlLnRyYW5zZmVyID0gZnVuY3Rpb24ob3RoZXJHTSwgbXlNZW1iZXIpIHtcclxuXHR2YXIgdGVzdFZhbHMgPSBvdGhlckdNLmJhY2tncm91bmQuZ2V0VmFyc0NlbnRlcigpO1xyXG5cdC8vIGNvbnNvbGUubG9nKCd0cmFuc2ZlciB0bycsIG90aGVyR00uYmFja2dyb3VuZC50eXBlLCBvdGhlckdNLmJhY2tncm91bmQuaW5jb21lTGV2ZWwsIHRlc3RWYWxzLmNlbnRlci55LCB0ZXN0VmFscy55LCB0ZXN0VmFscy52aXNIZWlnaHQsIHRlc3RWYWxzLnZSYXRpbyk7XHJcblx0LypcclxuXHRpZiAoIShteU1lbWJlciBpbiB0aGlzLm1lbWJlcnMpKSB7XHJcblx0XHRjb25zb2xlLmxvZygnRVJST1InLCBteU1lbWJlciwgJ25vdCBpbicsIHRoaXMpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHQqL1xyXG5cdHZhciBpbmRleCA9IHRoaXMubWVtYmVycy5pbmRleE9mKG15TWVtYmVyKTtcclxuXHR0aGlzLm1lbWJlcnMuc3BsaWNlKGluZGV4LCAxKTtcclxuXHRvdGhlckdNLmFkZE1lbWJlcihteU1lbWJlcik7XHJcbn07XHJcbkdyb3VwTWFuYWdlci5wcm90b3R5cGUuYWRkTWVtYmVyID0gZnVuY3Rpb24obWVtYmVyKSB7XHJcblx0dGhpcy5tZW1iZXJzLnB1c2gobWVtYmVyKTtcclxuXHRtZW1iZXIubXlNYW5hZ2VyID0gdGhpcztcclxuXHR2YXIgc21hbGxlciA9ICh0aGlzLndpZHRoIDwgdGhpcy5oZWlnaHQpID8gdGhpcy53aWR0aCA6IHRoaXMuaGVpZ2h0O1xyXG5cdHRoaXMubWluRGlzdCA9IHNtYWxsZXIgLyB0aGlzLm1lbWJlcnMubGVuZ3RoO1xyXG5cdC8vIGNvbnNvbGUubG9nKHRoaXMubWluRGlzdCk7XHJcbn07XHJcbkdyb3VwTWFuYWdlci5wcm90b3R5cGUubnVtUGVvcGxlID0gZnVuY3Rpb24oKSB7XHJcblx0dmFyIGNvdW50ID0gMDtcclxuXHRmb3IgKHZhciBtZW1iZXIgaW4gdGhpcy5tZW1iZXJzKSB7XHJcblx0XHRtZW1iZXIgPSB0aGlzLm1lbWJlcnNbbWVtYmVyXTtcclxuXHRcdGNvdW50ICs9IG1lbWJlci5udW1QZW9wbGUoKTtcclxuXHR9XHJcblx0cmV0dXJuIGNvdW50O1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBHcm91cE1hbmFnZXI7XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuIiwidmFyIFBlcnNvbiA9IGZ1bmN0aW9uIChnYW1lLCB4LCB5LCBpZCkge1xyXG5cdFBoYXNlci5TcHJpdGUuY2FsbCh0aGlzLCBnYW1lLCB4LCB5LCAncGVyc29uJyk7XHJcblx0dGhpcy52ZWxvY2l0eSA9IHt4OjAsIHk6MH07XHJcblx0dGhpcy53aWR0aCA9IDEwO1xyXG5cdHRoaXMuaGVpZ2h0ID0gMTA7XHJcblx0dGhpcy5zcGVlZCA9IC4wNTtcclxuXHR0aGlzLmlkID0gaWQ7XHJcblx0dGhpcy5lZHVMZXZlbCA9IFBlcnNvbi5FRFVMRVZFTC51bmVtcGxveWVkO1xyXG59O1xyXG5QZXJzb24ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShQaGFzZXIuU3ByaXRlLnByb3RvdHlwZSk7XHJcblBlcnNvbi5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBQZXJzb247XHJcblxyXG5QZXJzb24uRURVTEVWRUwgPSB7XHJcblx0dW5lbXBsb3llZCA6IC0xLFxyXG5cdGxvdyAgOiAwLFxyXG5cdG1pZCAgOiAxLFxyXG5cdGhpZ2ggOiAyXHJcbn07XHJcblxyXG5QZXJzb24ucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG5cdHRoaXMueCArPSB0aGlzLnZlbG9jaXR5LnggKiB0aGlzLnNwZWVkO1xyXG5cdHRoaXMueSArPSB0aGlzLnZlbG9jaXR5LnkgKiB0aGlzLnNwZWVkO1xyXG5cdC8vY29uc29sZS5sb2codGhpcy52ZWxvY2l0eSk7XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFBlcnNvbjsiLCJ2YXIgUGxheWVyID0gZnVuY3Rpb24gKGdhbWUsIHgsIHkpIHtcclxuICAgIFBoYXNlci5TcHJpdGUuY2FsbCh0aGlzLCBnYW1lLCB4LCB5LCAndGVzdHNwcml0ZScpO1xyXG4gICAgZ2FtZS5hZGQuZXhpc3RpbmcodGhpcyk7XHJcblx0dGhpcy5zcGVlZCA9IDAuMTtcclxufVxyXG5cclxuUGxheWVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUGhhc2VyLlNwcml0ZS5wcm90b3R5cGUpO1xyXG5QbGF5ZXIucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gUGxheWVyO1xyXG5cclxuLyoqXHJcbiAqIEF1dG9tYXRpY2FsbHkgY2FsbGVkIGJ5IFdvcmxkLnVwZGF0ZVxyXG4gKi9cclxuUGxheWVyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHtcclxuXHQvL3RoaXMueCArPSB0aGlzLnZlbG9jaXR5O1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBQbGF5ZXI7XHJcbiIsInZhciBQcm9ncmVzc0JhciA9IHJlcXVpcmUoJy4vUHJvZ3Jlc3NCYXInKTtcclxuXHJcbnZhciBVSUJ1aWxkZXIgPSBmdW5jdGlvbihzZXRHYW1lU3RhdGUpIHtcclxuXHQvL0Vuc3VyZSB0aGF0IGNhbm5vdCBjcmVhdGUgbXVsdGlwbGUgaW5zdGFuY2VzIG9mIHRoaXMgY2xhc3NcclxuXHRpZihVSUJ1aWxkZXIucHJvdG90eXBlLmV4aXN0cykge1xyXG5cdFx0cmV0dXJuIFVJQnVpbGRlci5wcm90b3R5cGUuZXhpc3RpbmdSZWZlcmVuY2U7XHJcblx0fVxyXG5cdFxyXG5cdHRoaXMuZ2FtZVN0YXRlID0gc2V0R2FtZVN0YXRlO1xyXG5cdHRoaXMucmVuZGVyYWJsZXMgPSBbXTtcclxuXHQvL0NyZWF0ZSBhbmQgc3RvcmUgYSBncmFwaGljcyBvYmplY3QgKHVzZWQgZm9yIHN0dWZmIGxpa2UgZHJhd2luZyByZWN0YW5nbGVzKVxyXG5cdFVJQnVpbGRlci5wcm90b3R5cGUuZXhpc3RzID0gdHJ1ZTtcclxuXHRVSUJ1aWxkZXIucHJvdG90eXBlLmV4aXN0aW5nUmVmZXJlbmNlID0gdGhpcztcclxufTtcclxuXHJcblVJQnVpbGRlci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBVSUJ1aWxkZXI7XHJcbi8vVGhlc2UgdmFyJ3MgaGVscCBjcmVhdGUgdGhlIHNpbmdsZXRvbiBmdW5jdGlvbmFsaXR5XHJcblVJQnVpbGRlci5wcm90b3R5cGUuZXhpc3RzID0gZmFsc2U7XHJcblVJQnVpbGRlci5wcm90b3R5cGUuZXhpc3RpbmdSZWZlcmVuY2UgPSBudWxsO1xyXG5cclxuLy9Vc2UgdGhpcyBmdW5jdGlvbiB0byBjcmVhdGUgYSBwcm9ncmVzcyBiYXJcclxuLy9Vc2FnZTogdHlwZTogY2FuIGJlIFwiZ3Jvd2luZ1wiIG9yIFwic2hyaW5raW5nXCIsIHRoaXMgd2lsbCBlZmZlY3QgaWYgYmFyIHN0YXJ0cyBhdCAwIGFuZCBnb2VzIHVwIG9yIHZpcyB2ZXJzYVxyXG4vL1x0XHQgbWF4VmFsdWU6IHNldHMgdGhlIG1heCB2YWx1ZSBvZiB0aGUgcHJvZ3Jlc3MgYmFyLCBpLmUuIHVzaW5nIDEwMCBjcmVhdGVzIGEgYmFyIGZyb20gMCB0byAxMDBcclxuLy9cdFx0IHgseTogc2V0cyBsb2NhdGlvblxyXG4vL1x0XHQgRE9OJ1QgRk9SR0VUIHRvIG92ZXJ3cml0ZSB0aGUgb25FdmVudCgpIGZ1bmN0aW9uIGZvciB0aGUgcHJvZ3Jlc3MgYmFyIGFmdGVyIGNyZWF0aW5nIGl0XHJcbi8vXHRcdFx0LW9uRXZlbnQoKSBpcyBhdXRvbWF0aWNhbGx5IGNhbGxlZCB3aGVuIGJhciBmaWxscy9zaHJpbmtzIHBhc3QgbGltaXQgKGRlcGVuZGluZyBvbiBiYXIgdHlwZSlcclxuVUlCdWlsZGVyLnByb3RvdHlwZS5idWlsZFByb2dyZXNzQmFyID0gZnVuY3Rpb24odHlwZSwgeCwgeSwgd2lkdGgsIGhlaWdodCwgbWF4VmFsdWUpIHtcclxuXHQvL2NyZWF0ZSBhbmQgZm9ybWF0IG5ldyBwcm9nIGJhclxyXG5cdHZhciBncmFwaGljcyA9IHRoaXMuZ2FtZVN0YXRlLmdhbWUuYWRkLmdyYXBoaWNzKDAsMCk7XHJcblx0dmFyIG5ld1Byb2dCYXIgPSBuZXcgUHJvZ3Jlc3NCYXIodHlwZSwgbWF4VmFsdWUsIGdyYXBoaWNzLCB0aGlzLnJlbmRlcmFibGVzKTtcclxuXHRuZXdQcm9nQmFyLnNldExvY2F0aW9uKHgseSk7XHJcblx0bmV3UHJvZ0Jhci5zZXRTaXplKHdpZHRoLCBoZWlnaHQpO1xyXG5cdC8vc3Vic2NyaWJlIHRvICdyZW5kZXJhYmxlcycgc28gdGhhdCByZW5kZXIoKSBpcyBjYWxsZWQgYXV0b21hdGljYWxseVxyXG5cdC8vIHRoaXMucmVuZGVyYWJsZXMuc3Vic2NyaWJlKG5ld1Byb2dCYXIpO1xyXG5cdHRoaXMucmVuZGVyYWJsZXMucHVzaChuZXdQcm9nQmFyKTtcclxuXHRyZXR1cm4gbmV3UHJvZ0JhcjtcclxufTtcclxuVUlCdWlsZGVyLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbigpIHtcclxuXHRmb3IgKHJlbmRlcmFibGUgaW4gdGhpcy5yZW5kZXJhYmxlcykge1xyXG5cdFx0dGhpcy5yZW5kZXJhYmxlc1tyZW5kZXJhYmxlXS5yZW5kZXIoKTtcclxuXHR9XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFVJQnVpbGRlcjsiLCIndXNlIHN0cmljdCc7XHJcblxyXG52YXIgZ2FtZSA9IG5ldyBQaGFzZXIuR2FtZSg4MDAsIDYwMCwgUGhhc2VyLkFVVE8sICctZ2FtZScpO1xyXG5cclxud2luZG93LlV0aWxzID0gcmVxdWlyZSgnLi91dGlscycpO1xyXG53aW5kb3cucGxheWVyU3RhdGUgPSB7XHJcbiAgICBjdXJyZW50TGV2ZWw6ICdHYW1lJ1xyXG59XHJcblxyXG5nYW1lLnN0YXRlLmFkZCgnQm9vdCcsIHJlcXVpcmUoJy4vc3RhdGVzL2Jvb3QnKSk7XHJcbmdhbWUuc3RhdGUuYWRkKCdTcGxhc2gnLCByZXF1aXJlKCcuL3N0YXRlcy9zcGxhc2gnKSk7XHJcbmdhbWUuc3RhdGUuYWRkKCdQcmVsb2FkZXInLCByZXF1aXJlKCcuL3N0YXRlcy9wcmVsb2FkZXInKSk7XHJcbmdhbWUuc3RhdGUuYWRkKCdNZW51JywgcmVxdWlyZSgnLi9zdGF0ZXMvbWVudScpKTtcclxuZ2FtZS5zdGF0ZS5hZGQoJ0dhbWUnLCByZXF1aXJlKCcuL3N0YXRlcy9nYW1lJykpO1xyXG5cclxuZ2FtZS5zdGF0ZS5zdGFydCgnQm9vdCcpO1xyXG5cclxuLy9nYW1lLnN0YWdlLmJhY2tncm91bmRDb2xvciA9IFwiI2ZmZmZmZlwiO1xyXG4iLCJ2YXIgQm9vdCA9IGZ1bmN0aW9uICgpIHt9O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBCb290O1xyXG5cclxuQm9vdC5wcm90b3R5cGUgPSB7XHJcblxyXG4gIHByZWxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMubG9hZC5pbWFnZSgncHJlbG9hZGVyJywgJ2Fzc2V0cy9wcmVsb2FkZXIuZ2lmJyk7XHJcbiAgfSxcclxuXHJcbiAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLmdhbWUuaW5wdXQubWF4UG9pbnRlcnMgPSAxO1xyXG5cclxuICAgIGlmICh0aGlzLmdhbWUuZGV2aWNlLmRlc2t0b3ApIHtcclxuICAgICAgdGhpcy5nYW1lLnN0YWdlLnNjYWxlLnBhZ2VBbGlnbkhvcml6b250YWxseSA9IHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmdhbWUuc2NhbGUuc2NhbGVNb2RlID0gUGhhc2VyLlNjYWxlTWFuYWdlci5TSE9XX0FMTDtcclxuICAgICAgdGhpcy5nYW1lLnNjYWxlLm1pbldpZHRoID0gIDQ4MDtcclxuICAgICAgdGhpcy5nYW1lLnNjYWxlLm1pbkhlaWdodCA9IDI2MDtcclxuICAgICAgdGhpcy5nYW1lLnNjYWxlLm1heFdpZHRoID0gNjQwO1xyXG4gICAgICB0aGlzLmdhbWUuc2NhbGUubWF4SGVpZ2h0ID0gNDgwO1xyXG4gICAgICB0aGlzLmdhbWUuc2NhbGUuZm9yY2VMYW5kc2NhcGUgPSB0cnVlO1xyXG4gICAgICB0aGlzLmdhbWUuc2NhbGUucGFnZUFsaWduSG9yaXpvbnRhbGx5ID0gdHJ1ZTtcclxuICAgICAgdGhpcy5nYW1lLnNjYWxlLnNldFNjcmVlblNpemUodHJ1ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdQcmVsb2FkZXInKTtcclxuICB9XHJcbn07XHJcbiIsInZhciBQbGF5ZXIgPSByZXF1aXJlKCcuLi9lbnRpdGllcy9wbGF5ZXInKTtcclxudmFyIEJhY2tncm91bmRfTWFuYWdlciA9IHJlcXVpcmUoJy4uL2VudGl0aWVzL2JhY2tncm91bmRfbWFuYWdlcicpO1xyXG52YXIgUGVyc29uID0gcmVxdWlyZSgnLi4vZW50aXRpZXMvcGVyc29uJyk7XHJcbnZhciBHcm91cCA9IHJlcXVpcmUoJy4uL2VudGl0aWVzL2dyb3VwJyk7XHJcbnZhciBHcm91cE1hbmFnZXIgPSByZXF1aXJlKCcuLi9lbnRpdGllcy9ncm91cE1hbmFnZXInKTtcclxudmFyIFVJQnVpbGRlciA9IHJlcXVpcmUoJy4uL2VudGl0aWVzL3VpQnVpbGRlcicpO1xyXG5cclxudmFyIEdhbWUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdGhpcy50ZXN0ZW50aXR5ID0gbnVsbDtcclxuICAvL3RoaXMuZmxvY2tzID0gW107XHJcbiAgdGhpcy5iZ19tZyA9IG51bGw7XHJcbiAgLy8gdGhpcy5zZWxlY3RlZEdyb3VwID0gbnVsbDtcclxuICB0aGlzLm1vbmV5ID0gbnVsbDtcclxuICB0aGlzLm1vbmV5VmFsID0gMDtcclxuICB0aGlzLmN1ck1vbmV5ID0gMDtcclxuICB0aGlzLm1vbmV5VXBkYXRlRGVsYXkgPSAwLjAwMTtcclxuICB0aGlzLm1vbmV5SW5jcmVtZW50aW5nID0gZmFsc2U7XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEdhbWU7XHJcblxyXG5HYW1lLnByb3RvdHlwZSA9IHtcclxuXHJcbiAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XHJcblx0ICAvLyBjb25zb2xlLmxvZyh0aGlzKTtcclxuXHR0aGlzLmdhbWUuc3RhZ2UuYmFja2dyb3VuZENvbG9yID0gXCIjZmZmZmZmXCI7XHJcblx0ICBcclxuICAgIHZhciB4ID0gKHRoaXMuZ2FtZS53aWR0aCAvIDIpIC0gMTAwO1xyXG4gICAgdmFyIHkgPSAodGhpcy5nYW1lLmhlaWdodCAvIDIpIC0gNTA7XHJcblxyXG4gICAgdGhpcy5iZ19tZyA9IG5ldyBCYWNrZ3JvdW5kX01hbmFnZXIodGhpcy5nYW1lLCB0aGlzKTtcclxuICAgIC8qXHJcbiAgICB0aGlzLnRlc3RlbnRpdHkgPSBuZXcgUGxheWVyKHRoaXMuZ2FtZSwgeCwgeSk7XHJcbiAgICB0aGlzLnRlc3RlbnRpdHkuYW5jaG9yLnNldFRvKDAuNSwgMC41KTtcclxuICAgICovXHJcblx0XHJcbiAgICB0aGlzLmlucHV0Lm9uRG93bi5hZGQodGhpcy5vbklucHV0RG93biwgdGhpcyk7XHJcblx0XHJcblx0LypcclxuICAgIHRoaXMuZ20gPSBncm91cE1hbmFnZXIgPSBuZXcgR3JvdXBNYW5hZ2VyKHRoaXMuZ2FtZSwgNjAwLCA2MDAsIHt4IDogdGhpcy5nYW1lLndpZHRoIC8gMiwgeSA6IHRoaXMuZ2FtZS5oZWlnaHQgLyAyfSk7XHJcbiAgICB2YXIgdGVzdEZsb2NrID0gbmV3IEdyb3VwKHRoaXMuZ2FtZSwgdGhpcy5nYW1lLndpZHRoIC8gMiArIDEwMCwgdGhpcy5nYW1lLmhlaWdodCAvIDIgKyAxMDApO1xyXG4gICAgdGhpcy5mbG9ja3MucHVzaCh0ZXN0RmxvY2spO1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxMDsgaSsrKSB7XHJcbiAgICBcdHZhciB0ZXN0UGVyc29uID0gbmV3IFBlcnNvbih0aGlzLmdhbWUsIHRoaXMuZ2FtZS53aWR0aCAvIDIgKyBpICogMTUsIHRoaXMuZ2FtZS5oZWlnaHQgLyAyICsgaSAqIDE1LCBpKTtcclxuICAgIFx0dGhpcy5nYW1lLmFkZC5leGlzdGluZyh0ZXN0UGVyc29uKTtcclxuICAgIFx0dGVzdEZsb2NrLmFkZE1lbWJlcih0ZXN0UGVyc29uKTtcclxuICAgIH1cclxuICAgIGdyb3VwTWFuYWdlci5hZGRNZW1iZXIodGVzdEZsb2NrKTtcclxuXHR0ZXN0RmxvY2sgPSBuZXcgR3JvdXAodGhpcy5nYW1lLCB0aGlzLmdhbWUud2lkdGggLyAyIC0gMTAwLCB0aGlzLmdhbWUuaGVpZ2h0IC8gMiArIDEwMCk7XHJcblx0Zm9yICh2YXIgaSA9IDA7IGkgPCAxMDsgaSsrKSB7XHJcbiAgICBcdHZhciB0ZXN0UGVyc29uID0gbmV3IFBlcnNvbih0aGlzLmdhbWUsIHRoaXMuZ2FtZS53aWR0aCAvIDIgKyBpICogMTUgLSAxMDAsIHRoaXMuZ2FtZS5oZWlnaHQgLyAyICsgaSAqIDE1ICsgMTAwLCBpKTtcclxuICAgIFx0dGhpcy5nYW1lLmFkZC5leGlzdGluZyh0ZXN0UGVyc29uKTtcclxuICAgIFx0dGVzdEZsb2NrLmFkZE1lbWJlcih0ZXN0UGVyc29uKTtcclxuICAgIH1cclxuXHR0aGlzLmZsb2Nrcy5wdXNoKHRlc3RGbG9jayk7XHJcbiAgICBncm91cE1hbmFnZXIuYWRkTWVtYmVyKHRlc3RGbG9jayk7XHJcblx0Ki9cclxuXHQvLyBjb25zb2xlLmxvZyhQZXJzb24uRWR1TGV2ZWwuZm9vKTtcclxuXHQvLyBpZiAobXlQZXJzb24uZWR1TGV2ZWwgPT09IFBlcnNvbi5FZHVMZXZlbC5sb3cpIHtcclxuXHQgIFxyXG5cdC8vIH1cclxuXHR0aGlzLm1vbmV5ID0gdGhpcy5nYW1lLmFkZC50ZXh0KDEwLCAxMCwgJyQwJyk7XHJcblx0dGhpcy5tb25leS5mb250ID0gJ1ZUMzIzJztcclxuXHR0aGlzLm1vbmV5LmZvbnRTaXplID0gMjQ7XHJcblx0dGhpcy5tb25leS5maWxsID0gJyNmZmZmZmYnO1xyXG4gICAgdGhpcy5tb25leS5zZXRTaGFkb3coMywgMywgJ3JnYmEoMCwwLDAsMC41KScsIDUpO1xyXG5cdFxyXG5cdHRoaXMudWliID0gbmV3IFVJQnVpbGRlcih0aGlzKTtcclxuXHR0aGlzLnVpYi5idWlsZFByb2dyZXNzQmFyKFwiZ3Jvd2luZ1wiLCB0aGlzLmdhbWUud2lkdGggLyAyLCAyNSwgMzAwLCAyNSwgMTAwKTtcclxuICB9LFxyXG5cclxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcclxuXHR0aGlzLmJnX21nLnVwZGF0ZSgpO1xyXG5cdC8vdGhpcy5nbS51cGRhdGUoKTtcclxuXHR0aGlzLnVpYi5yZW5kZXIoKTtcclxuICB9LFxyXG5cclxuICBvbklucHV0RG93bjogZnVuY3Rpb24gKCkge1xyXG5cdCAgLy8gY29uc29sZS5sb2codGhpcy5nYW1lLmlucHV0LngsIHRoaXMuZ2FtZS5pbnB1dC55KTtcclxuICAgIC8vdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdNZW51Jyk7XHJcblx0Ly9jb25zb2xlLmxvZyh0aGlzLmdhbWUuaW5wdXQueCwgdGhpcy5nYW1lLmlucHV0LnkpO1xyXG5cdC8vIGlmICh0aGlzLmdhbWUuaW5wdXQuYWN0aXZlUG9pbnRlci5sZWZ0QnV0dG9uLmlzRG93bikge1xyXG5cdFx0Ly90aGlzLmFkZE1vbmV5KDEwMCk7XHJcblx0XHQvLyBpZiAodGhpcy5zZWxlY3RlZEdyb3VwKSB7XHJcblx0XHRcdC8vIHZhciBiZyA9IHRoaXMuYmdfbWcud2hlcmVDbGlja2VkKCk7XHJcblx0XHRcdC8vIHRoaXMuYmdfbWcuc2VuZFRvKHRoaXMuc2VsZWN0ZWRHcm91cC5teU1hbmFnZXIuYmFja2dyb3VuZCwgYmcsIHRoaXMuc2VsZWN0ZWRHcm91cCk7XHJcblx0XHRcdC8vIHRoaXMuc2VsZWN0ZWRHcm91cCA9IG51bGw7XHJcblx0XHQvLyB9IGVsc2Uge1xyXG5cdFx0XHQvLyBmb3IgKGZsb2NrIGluIHRoaXMuZmxvY2tzKSB7XHJcblx0XHRcdFx0Ly8gZmxvY2sgPSB0aGlzLmZsb2Nrc1tmbG9ja107XHJcblx0XHRcdFx0Ly8gaWYgKGZsb2NrLmNsaWNrZWQoKSkge1xyXG5cdFx0XHRcdFx0Ly8gZmxvY2suY2xpY2soKTtcclxuXHRcdFx0XHRcdC8vIHRoaXMuc2VsZWN0ZWRHcm91cCA9IGZsb2NrO1xyXG5cdFx0XHRcdFx0Ly8gYnJlYWs7XHJcblx0XHRcdFx0Ly8gfVxyXG5cdFx0XHQvLyB9XHJcblx0XHQvLyB9XHJcblx0Ly8gfVxyXG4gIH0sXHJcbiAgYWRkTW9uZXk6IGZ1bmN0aW9uIChhbXQpIHtcclxuXHQgIHRoaXMuY3VyTW9uZXkgKz0gYW10O1xyXG5cdCAgLy90aGlzLm1vbmV5LnRleHQgPSAnJCcgKyBuZXdNb25leTtcclxuXHQgIGlmICghdGhpcy5tb25leUluY3JlbWVudGluZykge1xyXG5cdFx0dGhpcy5nYW1lLnRpbWUuZXZlbnRzLmFkZChQaGFzZXIuVGltZXIuU0VDT05EICogdGhpcy5tb25leVVwZGF0ZURlbGF5LCB0aGlzLmluY3JlbWVudE1vbmV5LCB0aGlzKTtcclxuXHRcdHRoaXMubW9uZXlJbmNyZW1lbnRpbmcgPSB0cnVlO1xyXG5cdCAgfVxyXG4gIH0sXHJcbiAgaW5jcmVtZW50TW9uZXk6IGZ1bmN0aW9uICgpIHtcclxuXHRpZiAodGhpcy5tb25leVZhbCA9PT0gdGhpcy5jdXJNb25leSkge1xyXG5cdFx0dGhpcy5tb25leUluY3JlbWVudGluZyA9IGZhbHNlO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHRpZiAodGhpcy5jdXJNb25leSA+IHRoaXMubW9uZXlWYWwpIHtcclxuXHRcdHRoaXMubW9uZXlWYWwgKz0gMTtcclxuXHR9IGVsc2UgaWYgKHRoaXMuY3VyTW9uZXkgPCB0aGlzLm1vbmV5VmFsKSB7XHJcblx0XHR0aGlzLm1vbmV5VmFsIC09IDE7XHJcblx0fVxyXG5cdHRoaXMubW9uZXkudGV4dCA9ICckJyArIHRoaXMubW9uZXlWYWw7XHJcblx0dGhpcy5nYW1lLnRpbWUuZXZlbnRzLmFkZChQaGFzZXIuVGltZXIuU0VDT05EICogdGhpcy5tb25leVVwZGF0ZURlbGF5LCB0aGlzLmluY3JlbWVudE1vbmV5LCB0aGlzKTtcclxuICB9XHJcbn07XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4iLCJ2YXIgTWVudSA9IGZ1bmN0aW9uICgpIHtcclxuICB0aGlzLnRleHQgPSBudWxsO1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBNZW51O1xyXG5cclxuTWVudS5wcm90b3R5cGUgPSB7XHJcblxyXG4gIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHggPSB0aGlzLmdhbWUud2lkdGggLyAyO1xyXG4gICAgdmFyIHkgPSB0aGlzLmdhbWUuaGVpZ2h0IC8gMjtcclxuXHJcbiAgICB2YXIgc3R5bGUgPSB7IGZvbnQ6IFwiNjVweCBBcmlhbFwiLCBmaWxsOiBcIiNmZmZmZmZcIiwgYWxpZ246IFwiY2VudGVyXCIgfTtcclxuXHJcbiAgICB0aGlzLnRleHQgPSB0aGlzLmFkZC50ZXh0KHggLSAzMDAsIHkgLSAyMDAsIFwiUHJlc3MgdG8gU3RhcnRcIiwgc3R5bGUpO1xyXG5cclxuICAgIHRoaXMuaW5wdXQub25Eb3duLmFkZCh0aGlzLm9uRG93biwgdGhpcyk7XHJcbiAgfSxcclxuXHJcbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgfSxcclxuXHJcbiAgb25Eb3duOiBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQocGxheWVyU3RhdGUuY3VycmVudExldmVsKTtcclxuICB9XHJcbn07XHJcbiIsInZhciBQcmVsb2FkZXIgPSBmdW5jdGlvbiAoZ2FtZSkge1xyXG4gIHRoaXMuYXNzZXQgPSBudWxsO1xyXG4gIHRoaXMucmVhZHkgPSBmYWxzZTtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gUHJlbG9hZGVyO1xyXG5cclxuUHJlbG9hZGVyLnByb3RvdHlwZSA9IHtcclxuXHJcbiAgcHJlbG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5hc3NldCA9IHRoaXMuYWRkLnNwcml0ZSgzMjAsIDI0MCwgJ3ByZWxvYWRlcicpO1xyXG4gICAgdGhpcy5hc3NldC5hbmNob3Iuc2V0VG8oMC41LCAwLjUpO1xyXG5cclxuICAgIHRoaXMubG9hZC5vbkxvYWRDb21wbGV0ZS5hZGRPbmNlKHRoaXMub25Mb2FkQ29tcGxldGUsIHRoaXMpO1xyXG4gICAgdGhpcy5sb2FkLnNldFByZWxvYWRTcHJpdGUodGhpcy5hc3NldCk7XHJcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ3Rlc3RzcHJpdGUnLCAnYXNzZXRzL3Rlc3QucG5nJyk7XHJcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ2JhY2tncm91bmQnLCAnYXNzZXRzL3NlY3RvckJHLnBuZycpXHJcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ3BlcnNvbicsICdhc3NldHMvcGVyc29uLnBuZycpO1xyXG4gICAgdGhpcy5sb2FkLmltYWdlKCdzZWxlY3Rpb24nLCAnYXNzZXRzL3NlbGVjdGlvbi5wbmcnKTtcclxuXHR0aGlzLmxvYWQuc2NyaXB0KCd3ZWJmb250JywgJy8vYWpheC5nb29nbGVhcGlzLmNvbS9hamF4L2xpYnMvd2ViZm9udC8xLjQuNy93ZWJmb250LmpzJyk7XHJcbiAgfSxcclxuXHJcbiAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLmFzc2V0LmNyb3BFbmFibGVkID0gZmFsc2U7XHJcbiAgfSxcclxuXHJcbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICBpZiAoISF0aGlzLnJlYWR5KSB7XHJcbiAgICAgIHRoaXMuZ2FtZS5zdGF0ZS5zdGFydCgnR2FtZScpO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIG9uTG9hZENvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLnJlYWR5ID0gdHJ1ZTtcclxuICB9XHJcbn07XHJcbiIsInZhciBTcGxhc2ggPSBmdW5jdGlvbiAoKSB7XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFNwbGFzaDtcclxuXHJcblNwbGFzaC5wcm90b3R5cGUgPSB7XHJcbiAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgfVxyXG59OyIsInZhciBVdGlscyA9IHtcclxuICAgIGNvbnRhaW5zT2JqZWN0OiBmdW5jdGlvbihvYmosIGxpc3QpIHtcclxuICAgICAgICB2YXIgaTtcclxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAobGlzdFtpXSA9PT0gb2JqKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfSxcclxuXHRoeXBvdGVudXNlOiBmdW5jdGlvbihhLCBiKSB7XHJcblx0XHRyZXR1cm4gTWF0aC5zcXJ0KE1hdGgucG93KGEsIDIpICsgTWF0aC5wb3coYiwgMikpO1xyXG5cdH0sXHJcblx0cmF0aW86IGZ1bmN0aW9uKGEsIGIsIGMpIHtcclxuXHRcdGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxKSB7XHJcblx0XHRcdHJldHVybiBbYSAvIGFdO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMikge1xyXG5cdFx0XHRyZXR1cm4gW2EgLyAoYSArIGIpLCBiIC8gKGEgKyBiKV07XHJcblx0XHR9XHJcblx0XHRlbHNlIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAzKSB7XHJcblx0XHRcdHJldHVybiBbYSAvIChhICsgYiArIGMpLCBiIC8gKGEgKyBiICsgYyksIGMgLyAoYSArIGIgKyBjKV07XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0cmV0dXJuIFtdO1xyXG5cdFx0fVxyXG5cdH1cclxufTtcclxuXHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFV0aWxzOyJdfQ==
